/*
*######################################
* eWebEditor V15.3 - Advanced online web based WYSIWYG HTML editor.
* Copyright (c) 2003-2023 eWebSoft.com
*
* For further information go to http://www.ewebeditor.net/
* This copyright notice MUST stay intact for use.
*######################################
*/

String.prototype.fw=function(s){return(this.indexOf(s)> -1);};String.prototype.eg=function(s,ignoreCase){var L1=this.length;var L2=s.length;if(L2>L1){return false;}if(ignoreCase){var sV=new RegExp(s+'$','i');return sV.test(this);}else{return(L2==0||this.substr(L1-L2,L2)==s);}};var Ir=(function(){var Fy=2147483647;var Gm=36;var Gz=1;var Gx=26;var Hc=38;var ET=700;var Gt=72;var Fn=128;var Ij=/^xn--/;var Hk=/[^\x20-\x7E]/;var HH=/[\x2E\u3002\uFF0E\uFF61]/g;var ES=Gm-Gz;var Gd=Math.floor;var FI=String.fromCharCode;var GE=function(a,fn){var l=a.length;var gG=[];while(l--){gG[l]=fn(a[l]);}return gG;};var Fr=function(s,fn){var Fu=s.split('@');var aI='';if(Fu.length>1){aI=Fu[0]+'@';s=Fu[1];}var FG=s.split(HH);var EV=GE(FG,fn).join('.');return aI+EV;};var Fc=function(s){var Gg=[],GI=0,l=s.length,v,FU;while(GI<l){v=s.charCodeAt(GI++);if(v>=0xD800&&v<=0xDBFF&&GI<l){FU=s.charCodeAt(GI++);if((FU&0xFC00)==0xDC00){Gg.push(((v&0x3FF)<<10)+(FU&0x3FF)+0x10000);}else{Gg.push(v);counter--;}}else{Gg.push(v);}}return Gg;};var FN=function(a){return GE(a,function(v){var Gr='';if(v>0xFFFF){v-=0x10000;Gr+=FI(v>>>10&0x3FF|0xD800);v=0xDC00|v&0x3FF;}Gr+=FI(v);return Gr;}).join('');};var FP=function(FB){if(FB-48<10){return FB-22;}if(FB-65<26){return FB-65;}if(FB-97<26){return FB-97;}return Gm;};var Gj=function(Ft,flag){return Ft+22+75*(Ft<26)-((flag!=0)<<5);};var Fe=function(FF,Gw,HX){var k=0;FF=HX?Gd(FF/ET):FF>>1;FF+=Gd(FF/Gw);for(;FF>ES*Gx>>1;k+=Gm){FF=Gd(FF/ES);}return Gd(k+(ES+1)*FF/(FF+Hc));};var FZ=function(Fh){var Gg=[],Gn=Fh.length,out,i=0,n=Fn,EP=Gt,FA,j,GJ,Gp,w,k,Ft,t,EQ;FA=Fh.lastIndexOf('-');if(FA<0){FA=0;}for(j=0;j<FA;++j){if(Fh.charCodeAt(j)>=0x80){return Fh;}Gg.push(Fh.charCodeAt(j));}for(GJ=FA>0?FA+1:0;GJ<Gn;){for(Gp=i,w=1,k=Gm;;k+=Gm){if(GJ>=Gn){return Fh;}Ft=FP(Fh.charCodeAt(GJ++));if(Ft>=Gm||Ft>Gd((Fy-i)/w)){return Fh;}i+=Ft*w;t=k<=EP?Gz:(k>=EP+Gx?Gx:k-EP);if(Ft<t){break;}EQ=Gm-t;if(w>Gd(Fy/EQ)){return Fh;}w*=EQ;}out=Gg.length+1;EP=Fe(i-Gp,out,Gp==0);if(Gd(i/out)>Fy-n){return Fh;}n+=Gd(i/out);i%=out;Gg.splice(i++,0,n);}return FN(Gg);};var Hx=function(Fh){var n,FF,GH,FK,EP,j,m,q,k,t,Fz,Gg=[],Gn,FJ,EQ,Fj;Fh=Fc(Fh);Gn=Fh.length;n=Fn;FF=0;EP=Gt;for(j=0;j<Gn;++j){Fz=Fh[j];if(Fz<0x80){Gg.push(FI(Fz));}}GH=FK=Gg.length;if(FK){Gg.push('-');}while(GH<Gn){for(m=Fy,j=0;j<Gn;++j){Fz=Fh[j];if(Fz>=n&&Fz<m){m=Fz;}}FJ=GH+1;if(m-n>Gd((Fy-FF)/FJ)){return Fh;}FF+=(m-n)*FJ;n=m;for(j=0;j<Gn;++j){Fz=Fh[j];if(Fz<n&& ++FF>Fy){return Fh;}if(Fz==n){for(q=FF,k=Gm;;k+=Gm){t=k<=EP?Gz:(k>=EP+Gx?Gx:k-EP);if(q<t){break;}Fj=q-t;EQ=Gm-t;Gg.push(FI(Gj(t+Fj%EQ,0)));q=Gd(Fj/EQ);}Gg.push(FI(Gj(q,0)));EP=Fe(FF,FJ,GH==FK);FF=0;++GH;}}++FF;++n;}return Gg.join('');};var Fb=function(Fh){return Fr(Fh,function(s){return Ij.test(s)?FZ(s.slice(4).toLowerCase()):s;});};var Fa=function(Fh){return Fr(Fh,function(s){return Hk.test(s)?'xn--'+Hx(s):s;});};var Fv=function(aG,Fx){var n=aG.indexOf("://");var FQ="";if(n>0){FQ=aG.substr(0,n+3);aG=aG.substr(n+3);}else{return aG;}var Fd="";n=aG.indexOf("/");if(n>0){Fd=aG.substr(n);aG=aG.substr(0,n);}n=aG.indexOf(":");if(n>0){Fd=aG.substr(n)+Fd;aG=aG.substr(0,n);}return FQ+(Fx?Fa(aG):Fb(aG))+Fd;};return{Hq:function(Fh){return Fb(Fh);},HV:function(Fh){return Fa(Fh);},Ii:function(Fh){return Fv(Fh,false);},Hm:function(Fh){return Fv(Fh,true);}};})();var aA=(function(){var iW=new Object();var gr=document.location.search;if(gr){gr=gr.substr(1);gr=gr.replace(/&amp;/gi,"&");}else{gr="";}var qR=gr.split("&");for(i=0;i<qR.length;i++){var qD=qR[i].split("=");iW[qD[0]]=qD[1];}var al=function(bA,sz){var Lb=new RegExp('[\<\>\"\'\|\&\t]+','gi');var v=iW[bA];if(v&&Lb.test(v)){v="";}if(!v){v=sz;}return v;};var Ot=function(s){return s.replace(/\[/gi,";91;").replace(/\]/gi,";93;");};var om=al("id","");var pA=al("originalfilename","");var qT=al("savefilename","");var rc=al("savepathfilename","");var sx=al("extcss","");var rY=al("fullscreen","");var rr=al("style","coolblue");var ki=al("cusdir","");var rH=al("skin","");var rM=al("fixwidth","");var ca=al("lang","");var tk=al("areacssmode","");var sc=al("readonly","");var tf=al("skey","");var sM=al("instanceid",om);var rA=al("autogrow","");var Ct=al("titleimage","");var Ix=al("attachev","");var Hs=al("eqtype","");var AW=al("backendurl","");if(AW){AW=decodeURIComponent(AW);if(AW.substring(AW.length-1)!="/"){AW+="/";}}var hw=window.location.hostname;var Gs=window.location.port;var n;if(hw.indexOf(":")>0&&hw.indexOf("]")<0){hw="["+hw+"]";}hw=Ir.HV(hw);var Nb=Ot(hw);var JO=document.location.protocol.toLowerCase();n=JO.indexOf(":");if(n>0){JO=JO.substr(0,n);}var RN=false;if((hw=="127.0.0.1")||(hw=="localhost")){RN=true;}var Od=JO+"://"+hw+(Gs?":"+Gs:"");var PJ=Ot(Od);var PD=AW;var Ow="jsp";PD+=Ow+"/i."+Ow+"?action=config&style="+rr+"&skey="+tf+"&h="+Nb+"&o="+PJ;return{bs:om,vs:sM,wg:pA,vZ:qT,vj:rc,ExtCSS:sx,FullScreen:rY,StyleName:rr,CusDir:ki,Skin:rH,FixWidth:rM,Lang:ca,AreaCssMode:tk,ReadOnly:sc,SKey:tf,rD:rA,TitleImage:Ct,Ik:Ix,EQType:Hs,H:hw,SH:Nb,TJ:RN,Hw:Gs,Proto:JO,TE:PD,Nm:AW,hW:Od,SO:PJ};})();var F=(function(){var s=navigator.userAgent.toLowerCase();var os=( /*@cc_on!@*/false);var hs=0;if(os){try{hs=parseInt(s.match(/msie (\d+)/)[1],10);}catch(e){hs=0;}}var Du=(document.documentMode>=11);var Il=(os||Du);var Hn=s.fw('safari');var HQ=s.fw('chrome/');var Iy=s.fw('firefox');var Ki=s.fw('win64');var HI=s.fw('edge/');var Ho=window.navigator.platform;var p="";var Qs=false;var Kj=false;var Ra=false;if(Ho.indexOf("Linux")==0){p="l";Ra=true;}else if(Ho.indexOf("Win")==0){p="w";Kj=true;}else if(Ho.indexOf("Mac")==0){p="m";Qs=true;}return{as:os,xZ:(hs==6),zW:(hs>=6),gB:(hs>=7),BX:(document.documentMode>=10),eo:Du,EY:Il,Cf:(os&&(s.indexOf("trident/5")> -1)),GD:(os&&(s.indexOf("trident/6")> -1)),Hi:(os&&(s.indexOf("trident/7")> -1)),An: ! !document.documentMode,Ar:document.documentMode==8,nb:document.documentMode==9,IA:document.documentMode==10,jo:s.fw('gecko/'),ik:Hn,jr:s.fw(' opr/'),Aq:Qs,AM:HQ,KT:Iy,Iq:HI,xb:s.fw(' applewebkit/'),Cq:Ki,Bx:Kj,Tu:Ra,p:p,Ei:((!os)||(os&&(document.documentMode>=9))),iF:((!os)||(os&&(document.documentMode>=10)))};})();var lang=new Object();lang.ag=function(J){var gT=J.getElementsByTagName("INPUT");for(i=0;i<gT.length;i++){if(gT[i].getAttribute("lang")){gT[i].value=lang[gT[i].getAttribute("lang")];}}var gZ=J.getElementsByTagName("SPAN");for(i=0;i<gZ.length;i++){if(gZ[i].getAttribute("lang")){gZ[i].innerHTML=lang[gZ[i].getAttribute("lang")];}}var ht=J.getElementsByTagName("OPTION");for(i=0;i<ht.length;i++){if(ht[i].getAttribute("lang")){ht[i].innerHTML=lang[ht[i].getAttribute("lang")];}}};var am=(function(){var ut=99997890;var ac,cv,aP;var kP,bf,kp,kg;var bH={x:0,y:0,ew:0,rel:null};var un;var eA;var gg=false;var cN;var mv=function(){if(ac){return;}kp="<table border=0 cellpadding=0 cellspacing=0 class='Menu_Box' id=Menu_Box><tr><td class='Menu_Box'><table border=0 cellpadding=0 cellspacing=0 class='Menu_Table'>";bf="<tr><td class='Menu_Sep'><table border=0 cellpadding=0 cellspacing=0 class='Menu_Sep'><tr><td></td></tr></table></td></tr>";kg="</table></td></tr></table>";kP="<html><head>"+"<link href='"+EWEB.cd+"/skin/"+config.Skin+"/menuarea.css?v="+EWEB.V+"' type='text/css' rel='stylesheet'>"+"</head>"+"<body scroll='no'>";if(F.as){cv=window.createPopup();ac=cv.document;ac.open();ac.write(kP);ac.close();}else{cN=R.lJ();var mK=cN.document;aP=mK.createElement('iframe');R.hh(aP);aP.src='javascript:void(0)';aP.allowTransparency=true;aP.frameBorder='0';aP.scrolling='no';aP.style.width=aP.style.height='0px';R.cP(aP,{position:'absolute',zIndex:ut});aP.kw=window;mK.body.appendChild(aP);var ln=aP.contentWindow;ac=ln.document;ac.open();ac.write(kP);ac.close();un=R.fR(ac);R.ko(ac.body);R.az(ln,'focus',sF);R.az(ln,'blur',rK);}eA=ac.body.appendChild(ac.createElement('DIV'));eA.style.cssFloat='left';R.az(ac,'contextmenu',R.aw);R.az(ac,'dragstart',R.aw);R.az(ac,'selectstart',R.aw);R.az(ac,'select',R.aw);};var dY=function(aW,pP,jn,NY){var dX="";var js;if(F.as){js="var w=parent;w."+pP+";w.am.Hide();";}else{js="var w=frameElement.kw;w.am.Hide();w."+pP+";"}if(aW==""){dX+="<tr><td class='Menu_Item'><table border=0 cellpadding=0 cellspacing=0 width='100%'><tr><td valign=middle class=MouseOut onMouseOver=\"this.className='MouseOver'\" onMouseOut=\"this.className='MouseOut'\" onclick=\""+js+"\">";}else{dX+="<tr><td class='Menu_Item'><table border=0 cellpadding=0 cellspacing=0 width='100%'><tr><td valign=middle class=MouseDisabled>";}aW=(aW)?"_Disabled":"";dX+="<table border=0 cellpadding=0 cellspacing=0><tr><td class=Menu_Image_TD>";if(typeof(jn)=="number"){var cA="skin/"+config.Skin+"/buttons.gif?v="+EWEB.V;var dM=16-jn*16;dX+="<div class='Menu_Image"+aW+"'><img src='"+cA+"' style='top:"+dM+"px'></div>";}else if(jn!=""){var cA="skin/"+config.Skin+"/"+jn;dX+="<img class='Menu_Image"+aW+"' src='"+cA+"'>";}dX+="</td><td class='Menu_Label"+aW+"'>"+NY+"</td></tr></table>";dX+="</td></tr></table></td><\/tr>";return dX;};var O=function(aW,aM,ca){var di=Buttons[aM];if(!ca){ca=lang[aM];}else{ca=lang[ca];}var hL=di[1]?di[1]:"exec('"+aM+"')";return dY(aW,hL,di[0],ca);};var bb=function(aM,aV){var aW="";if(!aV){aV=aM;}try{if(!EWEB.T.queryCommandEnabled(aV)){aW="disabled";}}catch(e){}if(aW){if(aV=="Copy"||aV=="Cut"){if(config.AutoDetectPaste=="1"){aW="";}}}return O(aW,aM);};var eN=function(bA){var G="";var aW="disabled";switch(bA){case "TableInsert":if(!bI.gl()){aW="";}G+=O(aW,"TableInsert");break;case "TableProp":if(bI.gl()||bI.bp()){aW="";}G+=O(aW,"TableProp");break;case "TableCell":if(bI.bp()){aW="";}G+=O(aW,"TableCellProp");G+=O(aW,"TableCellSplit");G+=bf;G+=O(aW,"TableRowProp");G+=O(aW,"TableRowInsertAbove");G+=O(aW,"TableRowInsertBelow");G+=O(aW,"TableRowMerge");G+=O(aW,"TableRowSplit");G+=O(aW,"TableRowDelete");G+=bf;G+=O(aW,"TableColInsertLeft");G+=O(aW,"TableColInsertRight");G+=O(aW,"TableColMerge");G+=O(aW,"TableColSplit");G+=O(aW,"TableColDelete");break;}return G;};var mV=function(aH,dg,iG){if(C.ai()=="Control"){if(aH){var el=C.ax();if(el.tagName.toUpperCase()==aH){if((dg)&&(iG)){if(el.getAttribute(dg,2).toLowerCase()==iG.toLowerCase()){return true;}}else{return true;}}}else{return true;}}return false;};tA=function(){if(ac.readyState!="complete"&&ac.readyState!="interactive"){return false;}if(ac.images){for(var i=0;i<ac.images.length;i++){var img=ac.images[i];if(!img.complete){return false;}}}return true;};return{Show:function(){if(F.as){if(!tA()){window.setTimeout("am.Show()",50);return;}var w=ac.body.scrollWidth;var h=ac.body.scrollHeight;if(bH.x+w>document.body.clientWidth){bH.x=bH.x-w+bH.ew;}cv.show(bH.x,bH.y,w,h,bH.rel);}else{var w=eA.offsetWidth;var h=eA.offsetHeight;var x=bH.x;var y=bH.y;if(h>1000||w<50){window.setTimeout("am.Show()",50);return;}R.cP(aP,{width:w+'px',height:h+'px',left:x+'px',top:y+'px'});gg=true;}},fJ:function(e,an){if(EWEB.ae!="EDIT"){return R.aw(e);}mv();if(gg){this.Hide();}EWEB.Focus();C.Save(true);var G="";switch(an){case "font":G+=bb("Bold");G+=bb("Italic");G+=bb("UnderLine");G+=bb("StrikeThrough");G+=bf;G+=bb("SuperScript");G+=bb("SubScript");G+=bf;G+=O("","UpperCase");G+=O("","LowerCase");G+=bf;G+=O("","ForeColor");G+=O("","BackColor");G+=bf;G+=O("","Big");G+=O("","Small");break;case "paragraph":G+=bb("JustifyLeft");G+=bb("JustifyCenter");G+=bb("JustifyRight");G+=bb("JustifyFull");G+=bf;G+=bb("OrderedList","insertorderedlist");G+=bb("UnOrderedList","insertunorderedlist");G+=bb("Indent");G+=bb("Outdent");G+=bf;G+=bb("Paragraph","insertparagraph");G+=O("","BR");G+=bf;G+=O((iY())?"":"disabled","ParagraphAttr","CMenuParagraph");break;case "edit":var aW="";if(!ap.HO()){aW="disabled";}G+=O(aW,"UnDo");if(!ap.rC()){aW="disabled";}G+=O(aW,"ReDo");G+=bf;G+=bb("Cut");G+=bb("Copy");G+=O("","Paste");G+=O("","PasteText");G+=O("","PasteWord");G+=bf;G+=bb("Delete");G+=bb("RemoveFormat");G+=bf;G+=bb("SelectAll");G+=bb("UnSelect");G+=bf;G+=O("","FindReplace");G+=O("","QuickFormat");break;case "object":G+=O("","BgColor");G+=O("","BackImage");G+=bf;G+=O("","absolutePosition");G+=O("","zIndexForward");G+=O("","zIndexBackward");G+=bf;G+=O("","ShowBorders");G+=bf;G+=O("","Quote");G+=O("","Code");break;case "component":G+=O("","Image");G+=O("","Flash");G+=O("","Media");G+=O("","File");G+=bf;G+=O("","RemoteUpload");G+=O("","LocalUpload");G+=bf;G+=O("","Fieldset");G+=O("","Iframe");G+=bb("HorizontalRule","InsertHorizontalRule");G+=O("","Marquee");G+=bf;G+=O("","CreateLink");G+=O("","Anchor");G+=O("","Map");G+=bb("Unlink");break;case "tool":G+=O("","Template");G+=O("","Symbol");G+=O("","Emot");G+=bf;G+=O("","NowDate");G+=O("","NowTime");G+=bf;G+=O("","ImportWord");G+=O("","ImportExcel");G+=O("","ImportPPT");G+=O("","ImportPDF");G+=O("","Capture");G+=bf;G+=O("","Pagination");G+=O("","PaginationInsert");break;case "file":G+=O("","Refresh");G+=bf;G+=O("","ModeCode");G+=O("","ModeEdit");G+=O("","ModeText");G+=O("","ModeView");G+=bf;G+=O("","SizePlus");G+=O("","SizeMinus");G+=bf;G+=O("","Print");G+=bf;G+=O("","About");height=208;break;case "table":G+=eN("TableInsert");G+=eN("TableProp");G+=bf;G+=eN("TableCell");break;case "form":G+=O("","FormText");G+=O("","FormTextArea");G+=O("","FormRadio");G+=O("","FormCheckbox");G+=O("","FormDropdown");G+=O("","FormButton");break;case "gallery":G+=O("","GalleryImage");G+=O("","GalleryFlash");G+=O("","GalleryMedia");G+=O("","GalleryFile");break;case "zoom":for(var i=0;i<cY.Options.length;i++){if(cY.Options[i]==cY.qr){G+=dY("","cY.Execute("+cY.Options[i]+")",120,cY.Options[i]+"%");}else{G+=dY("","cY.Execute("+cY.Options[i]+")",119,cY.Options[i]+"%");}}break;case "fontsize":var v=C.BA();for(var i=0;i<lang["FontSizeItem"].length;i++){if(lang["FontSizeItem"][i][0]==v){G+=dY("","fq('size','"+lang["FontSizeItem"][i][0]+"')",120,lang["FontSizeItem"][i][1]);}else{G+=dY("","fq('size','"+lang["FontSizeItem"][i][0]+"')",119,lang["FontSizeItem"][i][1]);}}break;case "fontname":var v=EWEB.T.queryCommandValue("FontName");for(var i=0;i<lang["FontNameItem"].length;i++){var DM=lang["FontNameItem"][i];var DV=DM.toLowerCase().split(",");var EE=DM.split(",")[0];if(v&&DV.indexOf(v.toLowerCase())>=0){G+=dY("","fq('face','"+DM+"')",120,EE);}else{G+=dY("","fq('face','"+DM+"')",119,EE);}}break;case "formatblock":var v=EWEB.T.queryCommandValue("FormatBlock");if(v){v=v.toLowerCase();}else{v="";}for(var i=0;i<lang["FormatBlockItem"].length;i++){if(lang["FormatBlockItem"][i][0].toLowerCase()==v){G+=dY("","format('FormatBlock','"+lang["FormatBlockItem"][i][0]+"')",120,lang["FormatBlockItem"][i][1]);}else{G+=dY("","format('FormatBlock','"+lang["FormatBlockItem"][i][0]+"')",119,lang["FormatBlockItem"][i][1]);}}break;case "lineheight":case "margintop":case "marginbottom":var v=Jz.Kk(an);var Ja=Jz.KD(an);for(var i=0;i<Ja.length;i++){var Ll=Ja[i]?Ja[i]:lang["DlgComDefault"];if(v==Ja[i]){G+=dY("","Jz.Ky('"+an+"','"+Ja[i]+"')",120,Ll);}else{G+=dY("","Jz.Ky('"+an+"','"+Ja[i]+"')",119,Ll);}}break;}eA.innerHTML=kp+G+kg;R.ko(eA);if(cv){cv.show(0,0,0,0,document.body);e=window.event;e.returnValue=false;var el=e.srcElement;var x=e.clientX-e.offsetX;var y=e.clientY-e.offsetY;if(el.style.top){y=y-parseInt(el.style.top);}if(el.tagName.toLowerCase()=="img"){el=el.parentNode;x=x-el.offsetLeft-el.clientLeft;y=y-el.offsetTop-el.clientTop;}if(el.className=="TB_Btn_Image"){el=el.parentNode;x=x-el.offsetLeft-el.clientLeft;y=y-el.offsetTop-el.clientTop;}y=y+el.offsetHeight;var ew=parseInt(el.offsetWidth);bH.x=x;bH.y=y;bH.ew=ew;bH.rel=R.fR(document)?document.documentElement:document.body;am.Show();}else{var el=e.target;if(el.tagName.toLowerCase()=="img"||el.className=="TB_Btn_Image"){el=el.parentNode;}var x=0;var y=0;var ew=el.offsetWidth;if(F.ik){x=e.clientX;y=e.clientY;}else{x=e.pageX;y=e.pageY;}var fs=R.hg(cN,el);x=fs.x;y=fs.y+el.offsetHeight;bH.x=x;bH.y=y;bH.ew=ew;aP.contentWindow.focus();window.setTimeout("am.Show()",1);}},rw:function(e){if(EWEB.ae!="EDIT"){return R.aw(e);}mv();if(gg){am.Hide();}C.Save(true);var G="";G+=bb("Cut");G+=bb("Copy");G+=O("","Paste");G+=bb("Delete");G+=bb("SelectAll");G+=bf;if(bI.bp()){G+=eN("TableProp");G+=eN("TableCell");G+=bf;}if(mV("TABLE")){G+=eN("TableProp");G+=bf;}if(mV("IMG")){var da=aE.wv();if(!da){G+=O("","Image","CMenuImg");if(config.TitleImage){G+=O("","TitleImage");}G+=bf;G+=O("","zIndexForward");G+=O("","zIndexBackward");G+=bf;}if(da=="flash"){G+=O("","Flash","CMenuFlash");G+=bf;}if(da=="mediaplayer6"||da=="mediaplayer7"||da=="realplayer"||da=="quicktime"||da=="flv"||da=="vlc"||da=="video"||da=="audio"){G+=O("","Media","CMenuMedia");G+=bf;}}if(mV("HR")){G+=O("","HorizontalRule","CMenuHr");G+=bf;}if(iY()){G+=O("","ParagraphAttr","CMenuParagraph");G+=bf;}G+=O("","FindReplace");eA.innerHTML=kp+G+kg;R.ko(eA);if(cv){cv.show(0,0,0,0,document.body);e=eWebEditor.event;bH.x=e.clientX;bH.y=e.clientY;bH.ew=0;bH.rel=EWEB.T.documentElement;am.Show();}else{R.aw(e);bH.x=e.pageX;bH.y=e.pageY;var el=EWEB.T;var fs=R.hg(cN,(R.fR(el)?el.documentElement:el.body));bH.x+=fs.x;bH.y+=fs.y;bH.ew=0;aP.contentWindow.focus();window.setTimeout("am.Show()",1);}return false;},Hide:function(){if(cv){cv.hide();}else{if(!gg){return;}aP.style.width=aP.style.height='0px';gg=false;}C.Restore(true);C.Release();}};})();function sF(e){};function rK(e){am.Hide();};var ec=(function(){var eP;var us=99997890;var cB;var fK;var cN;var cg;var ks=function(){return++us;};var oH=function(){if(!cB){return;}var Bk=R.fR(cg)?cg.documentElement:cg.body;R.cP(cB,{'width':Math.max(Bk.scrollWidth,Bk.clientWidth,cg.scrollWidth||0)-1+'px','height':Math.max(Bk.scrollHeight,Bk.clientHeight,cg.scrollHeight||0)-1+'px'});};var pj=function(el){R.cP(el,{'zIndex':ks()});};var tu=function(){if(!cN){cN=R.lJ();cg=cN.document;}cB=cg.createElement("div");R.hh(cB);R.cP(cB,{"position":"absolute","zIndex":ks(),"top":"0px","left":"0px","backgroundColor":"#ffffff"});R.rN(cB,0.50);if(F.as&& !F.gB){fK=cg.createElement("iframe");R.hh(fK);fK.hideFocus=true;fK.frameBorder=0;fK.src=R.iO();R.cP(fK,{"width":"100%","height":"100%","position":"absolute","left":"0px","top":"0px","filter":"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"});cB.appendChild(fK);}R.az(cN,"resize",oH);oH();cg.body.appendChild(cB);};var uW=function(){R.cE(cB);};return{OpenDialog:function(rz,fP,NZ){C.Save(true);if(rz.indexOf("?")>=0){rz+="&v="+EWEB.V;}else{rz+="?v="+EWEB.V;}if(!eP){tu();}else{pj(cB);}var tI={vz:cN,aR:window,Page:rz,Hide:fP,CV:NZ};var ei=160;var cq=100;var dialog=cg.createElement('iframe');R.hh(dialog);dialog.frameBorder=0;dialog.allowTransparency=true;var sJ=F.as&&(!F.gB|| !R.fR(cN.document));R.cP(dialog,{'position':(sJ)?'absolute':'fixed','width':ei+'px','height':cq+'px','zIndex':ks()});if(fP){R.cP(dialog,{'top':'-10000px','left':'-10000px'});}else{this.oP(dialog,ei,cq);}dialog.src=aA.hW+EWEB.cd+"/dialog/dialog.htm?v="+EWEB.V;dialog.kw=tI;cg.body.appendChild(dialog);dialog.la=eP;eP=dialog;},wH:function(wd,Eh,BL){var dialog=wd.frameElement;R.cE(dialog);if(dialog.la){eP=dialog.la;pj(eP);}else{uW();setTimeout(function(){eP=null;},0);C.Release();if(EWEB.ae!="EDIT"){EWEB.Focus();}if(Eh){ap.jO();ap.Save();}if(BL){if(BL.flag){R.oQ(sk,200,null,[BL]);}}R.oQ(sk,200,null,[{flag:"DialogClose",ok:Eh}]);if(dialog.kw){if(dialog.kw.CV&&dialog.kw.CV["callback"]&&typeof(dialog.kw.CV["callback"])=="function"){R.oQ(dialog.kw.CV["callback"],200,null,[Eh]);}}if(Eh){Et();}}},oP:function(dialog,ei,cq){if(!ei){ei=parseInt(dialog.style.width,10);}if(!cq){cq=parseInt(dialog.style.height,10);}var oh=R.eF(cN);var kc={'X':0,'Y':0};var uS=F.as&&(!F.gB|| !R.fR(cN.document));if(uS){kc=R.gL(cN);}var dM=Math.max(kc.Y+(oh.Height-cq-20)/2,0);var jq=Math.max(kc.X+(oh.Width-ei-20)/2,0);R.cP(dialog,{'top':dM+'px','left':jq+'px'});},yH:function(){return cB;},Ab:function(){return eP;}};})();var ci=(function(){var BO=1;var rR=true;var tW=function(dW){dW.onmouseover=tY;dW.onmouseout=vg;dW.onmousedown=uJ;dW.onmouseup=tZ;dW.ondragstart=R.aw;dW.onselectstart=R.aw;dW.onselect=R.aw;dW.qn=true;return true;};var jv=function(e){if(!e){e=window.event;}var el=e.srcElement||e.target;if(el.tagName=="IMG"){el=el.parentNode;}if(el.className=="TB_Btn_Image"){el=el.parentNode;}return el;};var tY=function(e){var el=jv(e);el.className="TB_Btn_Over";};var vg=function(e){var el=jv(e);if(el.dj){el.className="TB_Btn_Down";}else{el.className="TB_Btn";}};var uJ=function(e){var el=jv(e);el.className="TB_Btn_Down";};var tZ=function(e){var el=jv(e);if(el.className="TB_Btn_Down"){el.className="TB_Btn_Over";}else{if(el.dj){el.className="TB_Btn_Down";}else{el.className="TB_Btn";}}};var eV;var kT=function(){if(eV){return;}var oa={normal:["Bold","Italic","UnderLine","StrikeThrough","SuperScript","SubScript","JustifyLeft","JustifyCenter","JustifyRight","JustifyFull","TextIndent"],mode:["ModeCode","ModeEdit","ModeView","ModeText"],other:["ShowBlocks","ShowBorders","Maximize","FormatBrush","ExpandToolbar"]};var K=$("eWebEditor_Toolbar").getElementsByTagName("DIV");eV=new Object;for(gM in oa){var oD=oa[gM];var iH=new Object;for(var i=0;i<oD.length;i++){var aV=oD[i];iH[aV]=new Array();for(var j=0;j<K.length;j++){var el=K[j];if(el.getAttribute("name")=="TB_Name_"+aV){iH[aV][iH[aV].length]=el;}}}eV[gM]=iH;}};var tJ=function(gV){kT();var fl="";if(F.as&&C.ai()!="Control"){var p=C.lF(["P","DIV","TD","TH"]);if(p){fl=p.style.textAlign;if(!fl){fl=p.getAttribute("align");}}}var hi=eV["normal"];for(aV in hi){var v;if(aV=="TextIndent"){v=Jz.Kk("textindent");}else if(fl&&aV.substring(0,7)=="Justify"){var ab=aV.substr(7).toLowerCase();if(ab=="full"){ab="justify";}if(fl.toLowerCase()==ab){v=fl;}else{v="";}}else{v=EWEB.T.queryCommandState(aV);}var K=hi[aV];for(var j=0;j<K.length;j++){var el=K[j];el.dj=v;if(gV){el.className="TB_Btn";}else{if(v){el.className="TB_Btn_Down";}else{el.className="TB_Btn";}}}}};var sj=function(){kT();var hi=eV["mode"];for(aV in hi){var K=hi[aV];for(var j=0;j<K.length;j++){var el=K[j];var ay=el.getAttribute("name");ay=ay.substr(ay.length-4).toUpperCase();if(ay==EWEB.ae){el.dj="on";el.className="TB_Btn_Down";}else{el.dj="";el.className="TB_Btn";}}}};var tN=function(gV){var aV,v;aV="FontName";v=C.Os();nQ(aV,v);aV="FontSize";v=C.BA();nQ(aV,v);};var nQ=function(aV,v){var Oo;if(v){v=v.replace(/[\'\"]/gi,'');v=v.replace(/\s*,\s*/gi,',');Oo=v.toLowerCase();}var K=document.getElementsByName("TB_Name_"+aV);for(var i=0;i<K.length;i++){var el=K[i];if(v){var b=false;for(var j=0;j<el.options.length;j++){var pn=el.options[j].value.toLowerCase();pn=pn.replace(/\s*,\s*/gi,',');if(pn==Oo||(aV=="FontSize"&&uV(pn,v))){el.selectedIndex=j;b=true;break;}}if(!b&&v!="eWebEditor_Temp_FontName"){el.options[el.options.length]=new Option(v,v);el.selectedIndex=el.options.length-1;}}else{el.selectedIndex=0;}}};var uV=function(ab,aF){ab=ab.toLowerCase();aF=aF.toLowerCase();if(ab==aF){return true;}if(ab.eg("pt")&&aF.eg("px")){var gj=0;ab=parseFloat(ab)+"";var n=ab.indexOf(".");if(n>=0){var s=ab.substr(n+1);gj=s.length;}if(gj>0){if(ab==Math.round(parseFloat(aF)*3/4*Math.pow(10,gj)+0.01)/Math.pow(10,gj)){return true;}}else{if(ab==parseInt(parseFloat(aF)*3/4+0.01)){return true;}}}return false;};return{vF:function(){var i,K,el,p;p=$("eWebEditor_Toolbar");K=p.getElementsByTagName("div");for(i=0;i<K.length;i++){el=K[i];if(el.className=="TB_Btn"){if(el.qn==null){if(!tW(el)){alert("Problem initializing:"+el.id);return false;}}}}return true;},eW:function(){if(EWEB.ae!="EDIT"){return;}var b=(C.ai()=="Control")?true:false;tJ(b);tN(b);},rk:function(){sj();},hV:function(gM,rI){kT();return eV[gM][rI];},CO:function(dO){BO=dO;rR=false;},CY:function(){if(EWEB.ae!="EDIT"){return;}if(config.Toolbars.length<=1){return;}rR=(!rR);var Bg=((rR)?"":"none");for(var i=BO;i<config.Toolbars.length;i++){$("eWebEditor_Toolbar_Edit_TR"+i).style.display=Bg;}if(Bg=="none"&&F.eo){$("eWebEditor_ToolarTREdit").style.display=Bg;window.setTimeout(function(){$("eWebEditor_ToolarTREdit").style.display="";},100);}Dj();this.nT("other","ExpandToolbar",rR);},nT:function(gM,rI,Bj,CK,Cl){var HY=this.hV(gM,rI);for(var j=0;j<HY.length;j++){var el=HY[j];var sa;if(Bj){el.dj="on";el.className="TB_Btn_Down";sa=Cl;}else{el.dj=null;el.className="TB_Btn";sa=CK;}if(sa){var vC=el.getElementsByTagName("IMG");if(vC){var dM=16-sa*16;if(F.as){vC[0].style.top=dM+"px";}else{vC[0].style.backgroundPosition="0px "+dM+"px";}}}}}};})();var bI=(function(){var aS;var au;var nS;var dk;var Kp=function(EK){var Kh=EK.rows.length;var hb=new Array();var cz=new Array();for(var i=0;i<Kh;i++){cz[i]=new Array();hb[i]=new Array();}var Jd=0;for(var i=0;i<Kh;i++){var nK=EK.rows[i];var Jg=nK.cells.length;var sC=0;for(var j=0;j<Jg;j++){var be=nK.cells[j];var ba=new Object();ba.KB=be;ba.La=false;ba.Kb=false;ba.JP=false;ba.Ge=i;ba.AF=i+(be.rowSpan-1);if(i==0){ba.La=true;if(j==0){ba.Kb=true;}if(j==(Jg-1)){ba.JP=true;}Jd+=be.colSpan;ba.sS=sC;ba.ru=sC+(be.colSpan-1);sC=sC+be.colSpan;}else{sC=0;for(var k=0;k<Jd;k++){if(!cz[i][k]){sC=k;break;}}ba.sS=sC;ba.ru=sC+(be.colSpan-1);if(ba.sS==0){ba.Kb=true;}if(ba.ru==(Jd-1)){ba.JP=true;}}for(var k=ba.sS;k<=ba.ru;k++){for(var m=ba.Ge;m<=ba.AF;m++){cz[m][k]={oW:i,rq:j};}}ba.KV=false;ba.LW=false;ba.KJ=false;if(ba.AF==(Kh-1)){ba.KV=true;}var m=i%2;if(m==0){ba.LW=true;}if(m==1){ba.KJ=true;}hb[i][j]=ba;}}return{Ko:cz,Kc:hb};};return{bp:function(){var el=C.lF(["TD","TH"]);if(el){aS=el;au=aS.parentNode;nS=au.parentNode;dk=nS.parentNode;return true;}else{return false;}},gl:function(){if(C.ai()=="Control"){var el=C.ax();if(el.tagName.toUpperCase()=="TABLE"){dk=el;return true;}}return false;},TableInsert:function(){if(!bI.gl()){aK('table.htm',true);}},TableProp:function(){if(bI.gl()||bI.bp()){aK('table.htm?action=modify',true);}},TableTemplate:function(){var Kx=EWEB.T.getElementsByTagName("TABLE");if(Kx.length<=0){alert(lang["MsgNoTable"]);return;}aK('tabletemplate.htm',true);},tK:function(){if(bI.bp()){aK('tablecell.htm',true);}},uC:function(){if(bI.bp()){aK('tablecellsplit.htm',true);}},sT:function(){if(bI.bp()){aK('tablecell.htm?action=row',true);}},qt:function(){if(!bI.bp()){return;}var gp=Kp(dk);var cz=gp.Ko;var hb=gp.Kc;var cQ=au.rowIndex;var CU=dk.insertRow(cQ);for(var i=0;i<cz[cQ].length;i++){var fH=cz[cQ][i].oW;var fL=cz[cQ][i].rq;var be=hb[fH][fL].KB;var lb=hb[fH][fL].Ge;var kl=hb[fH][fL].AF;var kq=hb[fH][fL].sS;var oc=hb[fH][fL].ru;if(lb==cQ){var Dy=CU.insertCell(-1);Dy.innerHTML="&nbsp;";var gJ=oc-kq+1;if(gJ>1){Dy.colSpan=gJ;i=i+(gJ-1);}Dy.style.cssText=be.style.cssText;}else if(lb<cQ){be.rowSpan=(kl-lb+1)+1;var gJ=oc-kq+1;if(gJ>1){i=i+(gJ-1);}}else{return;}}Et();},sR:function(){if(!bI.bp()){return;}var gp=Kp(dk);var cz=gp.Ko;var hb=gp.Kc;var cQ=au.rowIndex;cQ=cQ+aS.rowSpan-1;var CU=dk.insertRow(cQ+1);for(var i=0;i<cz[cQ].length;i++){var fH=cz[cQ][i].oW;var fL=cz[cQ][i].rq;var be=hb[fH][fL].KB;var lb=hb[fH][fL].Ge;var kl=hb[fH][fL].AF;var kq=hb[fH][fL].sS;var oc=hb[fH][fL].ru;if(kl==cQ){var Dy=CU.insertCell(-1);Dy.innerHTML="&nbsp;";var gJ=oc-kq+1;if(gJ>1){Dy.colSpan=gJ;i=i+(gJ-1);}Dy.style.cssText=be.style.cssText;}else if(kl>cQ){be.rowSpan=(kl-lb+1)+1;var gJ=oc-kq+1;if(gJ>1){i=i+(gJ-1);}}else{return;}}Et();},rv:function(){if(!bI.bp()){return;}var cQ=au.rowIndex;var sH=aS.cellIndex;var gp=Kp(dk);var cz=gp.Ko;var hb=gp.Kc;var JS=hb[cQ][sH];if(JS.KV){return;}var hy=0;for(var i=0;i<cz[cQ].length;i++){var fH=cz[cQ][i].oW;var fL=cz[cQ][i].rq;if(fH==cQ&&fL==sH){hy=i;break;}}var KP=(JS.AF-JS.Ge)+1;var Jj=cz[cQ+KP][hy].oW;var Ku=cz[cQ+KP][hy].rq;var IV=hb[Jj][Ku];if(JS.sS==IV.sS&&JS.ru==IV.ru){var IS=IV.KB;aS.innerHTML=aS.innerHTML+IS.innerHTML;aS.rowSpan=aS.rowSpan+IS.rowSpan;dk.rows[Jj].deleteCell(Ku);}Et();},pI:function(mu){if(!bI.bp()){return;}if(mu<2){return;}var cQ=au.rowIndex;var sH=aS.cellIndex;var jQ=aS.rowSpan;var gJ=aS.colSpan;var gp=Kp(dk);var cz=gp.Ko;var hb=gp.Kc;var hy=0;for(var i=0;i<cz[cQ].length;i++){var fH=cz[cQ][i].oW;var fL=cz[cQ][i].rq;if(fH==cQ&&fL==sH){hy=i;break;}}var Kr=0;var JN=0;if(jQ>1){if(mu>jQ){Kr=jQ;JN=mu-jQ;}else{Kr=mu;}}else{JN=mu-1;}if(Kr>0){Kr--;var ni=jQ-1;var eQ=ni-Kr;for(var i=ni;i>eQ;i--){var LJ=0;var IP=cQ+i;for(k=0;k<hy;k++){var Mw=cz[IP][k].oW;var LD=cz[IP][k].rq;var KS=hb[Mw][LD];var Ld=KS.ru-KS.sS+1;if(cz[IP][k].oW==IP){LJ++;k=k+Ld-1;}}var Dy=dk.rows[IP].insertCell(LJ);Dy.innerHTML="&nbsp;";if(gJ>1){Dy.colSpan=gJ;}Dy.style.cssText=aS.style.cssText;aS.rowSpan=aS.rowSpan-1;}}if(JN>0){for(var j=0;j<cz[cQ].length;j++){if(j>=hy&&j<(hy+gJ)){continue;}var fH=cz[cQ][j].oW;var fL=cz[cQ][j].rq;var Jl=hb[fH][fL];var KU=Jl.ru-Jl.sS+1;var Lp=Jl.KB;Lp.rowSpan=Lp.rowSpan+JN;j=j+KU-1;}for(var i=1;i<=JN;i++){var CU=dk.insertRow(cQ+1);var Dy=CU.insertCell(-1);Dy.innerHTML="&nbsp;";if(gJ>1){Dy.colSpan=gJ;}Dy.style.cssText=aS.style.cssText;}}Et();},qa:function(){if(!bI.bp()){return;}var gp=Kp(dk);var cz=gp.Ko;var hb=gp.Kc;var cQ=au.rowIndex;var sH=aS.cellIndex;var jQ=aS.rowSpan;var Jm=cQ+(jQ-1);var Lf=0;for(var i=Jm;i>=cQ;i--){for(var j=0;j<cz[i].length;j++){if(i!=cQ&&i!=Jm){continue;}var fH=cz[i][j].oW;var fL=cz[i][j].rq;var hT=hb[fH][fL];var be=hT.KB;var lb=hT.Ge;var kl=hT.AF;var kq=hT.sS;var oc=hT.ru;if(i==cQ){if(lb<i){be.rowSpan=(kl-lb+1)-(kl-i+1);j=j+(oc-kq);}}if(i==Jm){if(kl>i){var Ju=0;var IK=Jm+1;for(var k=0;k<j;k++){var Jp=cz[IK][k].oW;var KR=cz[IK][k].rq;var Kt=hb[Jp][KR];var IS=Kt.KB;var Mx=Kt.Ge;var LM=Kt.AF;var Ma=Kt.sS;var Lj=Kt.ru;if(Jp==IK){Ju++;}k=k+(Lj-Ma);}Ju=Ju+Lf;Lf++;var Dy=dk.rows[IK].insertCell(Ju);Dy.innerHTML="&nbsp;";var Jr=(kl-lb+1)-(Jm-lb+1);if(Jr>1){Dy.rowSpan=Jr;}var II=(oc-kq+1);if(II>1){Dy.colSpan=II;}Dy.style.cssText=be.style.cssText;j=j+(oc-kq);}}}dk.deleteRow(i);}if(dk.rows.length==0){R.cE(dk);}Et();},sf:function(){if(!bI.bp()){return;}var gp=Kp(dk);var cz=gp.Ko;var hb=gp.Kc;var cQ=au.rowIndex;var sH=aS.cellIndex;var hy=0;for(var i=0;i<cz[cQ].length;i++){var fH=cz[cQ][i].oW;var fL=cz[cQ][i].rq;if(fH==cQ&&fL==sH){hy=i;break;}}for(var i=0;i<cz.length;i++){var fH=cz[i][hy].oW;var fL=cz[i][hy].rq;var hT=hb[fH][fL];var be=hT.KB;var lb=hT.Ge;var kl=hT.AF;var kq=hT.sS;var oc=hT.ru;if(kq==hy){var Dy=dk.rows[i].insertCell(fL);Dy.innerHTML="&nbsp;";var jQ=kl-lb+1;if(jQ>1){Dy.rowSpan=jQ;i=i+(jQ-1);}Dy.style.cssText=be.style.cssText;}else if(kq<hy){be.colSpan=(oc-kq+1)+1;var jQ=kl-lb+1;if(jQ>1){i=i+(jQ-1);}}else{alert("error");return;}}Et();},sK:function(){if(!bI.bp()){return;}var gp=Kp(dk);var cz=gp.Ko;var hb=gp.Kc;var cQ=au.rowIndex;var sH=aS.cellIndex;var hy=0;for(var i=0;i<cz[cQ].length;i++){var fH=cz[cQ][i].oW;var fL=cz[cQ][i].rq;if(fH==cQ&&fL==sH){hy=i;break;}}hy=hy+aS.colSpan-1;for(var i=0;i<cz.length;i++){var fH=cz[i][hy].oW;var fL=cz[i][hy].rq;var hT=hb[fH][fL];var be=hT.KB;var lb=hT.Ge;var kl=hT.AF;var kq=hT.sS;var oc=hT.ru;if(oc==hy){var Dy=dk.rows[i].insertCell(fL+1);Dy.innerHTML="&nbsp;";var jQ=kl-lb+1;if(jQ>1){Dy.rowSpan=jQ;i=i+(jQ-1);}Dy.style.cssText=be.style.cssText;}else if(oc>hy){be.colSpan=(oc-kq+1)+1;var jQ=kl-lb+1;if(jQ>1){i=i+(jQ-1);}}else{alert("error");return;}}Et();},sq:function(){if(!bI.bp()){return;}var cQ=au.rowIndex;var sH=aS.cellIndex;var gp=Kp(dk);var cz=gp.Ko;var hb=gp.Kc;var JS=hb[cQ][sH];if(JS.JP){return;}var hy=0;for(var i=0;i<cz[cQ].length;i++){var fH=cz[cQ][i].oW;var fL=cz[cQ][i].rq;if(fH==cQ&&fL==sH){hy=i;break;}}var KY=(JS.ru-JS.sS)+1;var Jj=cz[cQ][hy+KY].oW;var Ku=cz[cQ][hy+KY].rq;var IV=hb[Jj][Ku];if(JS.Ge==IV.Ge&&JS.AF==IV.AF){var IS=IV.KB;aS.innerHTML=aS.innerHTML+IS.innerHTML;aS.colSpan=aS.colSpan+IS.colSpan;dk.rows[Jj].deleteCell(Ku);}Et();},rX:function(){if(!bI.bp()){return;}var gp=Kp(dk);var cz=gp.Ko;var hb=gp.Kc;if(cz[0].length==1){R.cE(dk);return;}var cQ=au.rowIndex;var sH=aS.cellIndex;var gJ=aS.colSpan;var Jq=0;for(var j=0;j<cz[cQ].length;j++){if(cz[cQ][j].oW==cQ&&cz[cQ][j].rq==sH){Jq=j;break;}}var LQ=Jq+(gJ-1);var JR=new Array();for(var i=0;i<cz.length;i++){JR[i]=new Array();}for(var i=0;i<cz.length;i++){for(var j=LQ;j>=Jq;j--){if(JR[i][j]){continue;}var fH=cz[i][j].oW;var fL=cz[i][j].rq;var hT=hb[fH][fL];var be=hT.KB;var lb=hT.Ge;var kl=hT.AF;var kq=hT.sS;var oc=hT.ru;if(oc>j){var Dy=dk.rows[i].insertCell(fL+1);Dy.innerHTML="&nbsp;";var Jr=(kl-lb+1);if(Jr>1){Dy.rowSpan=Jr;}var II=oc-LQ;if(II>1){Dy.colSpan=II;}Dy.style.cssText=be.style.cssText;}if(kq<Jq){be.colSpan=Jq-kq;}else{dk.rows[i].deleteCell(fL);}for(var m=lb;m<=kl;m++){for(var k=kq;k<=oc;k++){JR[m][k]=true;}}}}Et();},qY:function(mJ){if(!bI.bp()){return;}if(mJ<2){return;}var cQ=au.rowIndex;var sH=aS.cellIndex;var jQ=aS.rowSpan;var gJ=aS.colSpan;var Jh=0;var JC=0;if(gJ>1){if(mJ>gJ){Jh=gJ;JC=mJ-gJ;}else{Jh=mJ;}}else{JC=mJ-1;}if(Jh>0){var JB=1;var n=gJ/Jh;if((gJ%Jh)==0&&n>1){JB=n;}Jh--;for(var i=1;i<=Jh;i++){var Dy=dk.rows[cQ].insertCell(sH+1);Dy.innerHTML="&nbsp;";if(jQ>1){Dy.rowSpan=jQ;}if(JB>1){Dy.colSpan=JB;}Dy.style.cssText=aS.style.cssText;aS.colSpan=aS.colSpan-JB;}}if(JC>0){var gp=Kp(dk);var cz=gp.Ko;var hb=gp.Kc;var hy=0;for(var i=0;i<cz[cQ].length;i++){var fH=cz[cQ][i].oW;var fL=cz[cQ][i].rq;if(fH==cQ&&fL==sH){hy=i;break;}}for(var i=0;i<cz.length;i++){if(i>=cQ&&i<(cQ+jQ)){continue;}var fH=cz[i][hy].oW;var fL=cz[i][hy].rq;var hT=hb[fH][fL];var be=hT.KB;var lb=hT.Ge;var kl=hT.AF;var kq=hT.sS;var oc=hT.ru;be.colSpan=be.colSpan+JC;i=i+(kl-lb);}for(var i=0;i<JC;i++){var Dy=dk.rows[cQ].insertCell(sH+1);Dy.innerHTML="&nbsp;";if(jQ>1){Dy.rowSpan=jQ;}Dy.style.cssText=aS.style.cssText;}}Et();}};})();var cW=(function(){var oy=4;var or=5;var df=false;var dQ=false;var fj=false;var dz=null;var kj=0;var nF=0;var cU=null;var nC=0;var lB=0;var ot;var po;var nN;var op;var kA;var lk;var cJ=null;var av=null;var jd=null;var ma;var mt;var nx;var mT;var hc=new Array();var sA=new Array();var gf=new Array();var iL=new Array();var nX=false;var ur=function(){dz=$("div_TableResizeSepV");dz.className="TableResizeSepV";cU=$("div_TableResizeSepH");cU.className="TableResizeSepH";R.az(document,'mousemove',cW.PMM);nX=true;};var ee=function(){df=false;dQ=false;fj=false;cJ=null;av=null;jd=null;hc.length=0;sA.length=0;gf.length=0;iL.length=0;dz.style.display="none";cU.style.display="none";};var tL=function(be){var n=be.offsetWidth;n=n-jF(R.ce(be,"padding-left"));n=n-jF(R.ce(be,"padding-right"));return n;};var uZ=function(be){var n=be.offsetHeight;n=n-jF(R.ce(be,"padding-top"));n=n-jF(R.ce(be,"padding-bottom"));return n;};var lP=function(be){if(isNaN(parseInt(be.rowSpan))){return 1;}else{return parseInt(be.rowSpan);}};var jF=function(bv){if(!bv){return 0;}if(isNaN(parseInt(bv))){return 0;}bv=bv.toLowerCase();if(parseFloat(bv)==0){return 0;}else if(bv.eg("px")){return parseInt(bv);}else if(bv.eg("pt")){return parseInt(parseFloat(bv)*4/3);}else if(bv.eg("cm")){return parseInt(parseFloat(bv)*28.35*4/3);}else if(bv.eg("mm")){return parseInt(parseFloat(bv)*0.001*28.35*4/3);}else{return 0;}};var pp=function(){dz.style.display="none";cU.style.display="none";if(df){dz.style.cursor="e-resize";dz.style.display="";}if(dQ){cU.style.cursor="s-resize";cU.style.display="";}if(df&&dQ){dz.style.cursor="se-resize";cU.style.cursor="se-resize";}};return{xf:function(){return fj;},MM:function(e){if(fj){this.MM2(e);return;}if(!nX){ur();}ee();var el=e.srcElement||e.target;if(R.dV(el)!=EWEB.T){ee();return;}while(el.tagName.toUpperCase()!="TD"&&el.tagName.toUpperCase()!="TH"){if(el.tagName.toUpperCase()=="BODY"||el.tagName.toUpperCase()=="HTML"){ee();return;}el=el.parentNode;if(!el){ee();return;}}cJ=el;var jq=0;var dM=0;while(el){jq+=el.offsetLeft;dM+=el.offsetTop;el=el.offsetParent;}var JV=R.gL(EWEB.aR);var mf=jq+cJ.offsetWidth-JV.X;nN=e.screenX-e.clientX;kA=mf-oy;if(e.clientX>kA){df=true;}var mo=dM+cJ.offsetHeight-JV.Y;op=e.screenY-e.clientY;lk=mo-oy;if(e.clientY>lk){dQ=true;}if(df||dQ){kj=mf+$("eWebEditor").offsetLeft+$("eWebEditor_Layout").offsetLeft;nF=$("eWebEditor").offsetTop+$("eWebEditor_Layout").offsetTop+$("eWebEditor_ToolarPTR").offsetHeight;dz.style.left=kj+"px";dz.style.top=nF+"px";dz.style.width=or+"px";dz.style.height=$("eWebEditor").offsetHeight+"px";nC=$("eWebEditor").offsetLeft+$("eWebEditor_Layout").offsetLeft;lB=mo+$("eWebEditor").offsetTop+$("eWebEditor_Layout").offsetTop+$("eWebEditor_ToolarPTR").offsetHeight;cU.style.left=nC+"px";cU.style.top=lB+"px";cU.style.width=$("eWebEditor").offsetWidth+"px";cU.style.height=or+"px";}pp();},MD2:function(e){if(!e){e=eWebEditor.event;}fj=true;ot=e.screenX;po=e.screenY;av=R.tz(cJ,"TABLE");if(df){mt=av.offsetWidth;av.style.width=av.offsetWidth;ma=cJ.offsetWidth;for(var i=0;i<av.rows.length;i++){for(var j=0;j<av.rows[i].cells.length;j++){var be=av.rows[i].cells[j];be.style.width=tL(be)+"px";be.removeAttribute("width");}}hc.length=0;sA.length=0;var n=0;for(var i=0;i<av.rows.length;i++){for(var j=0;j<av.rows[i].cells.length;j++){var be=av.rows[i].cells[j];if((be.offsetLeft+be.offsetWidth)>=(cJ.offsetLeft+cJ.offsetWidth)&&(be.offsetLeft<(cJ.offsetLeft+cJ.offsetWidth))){hc[n]=be;sA[n]=parseInt(be.style.width);n++;break;}}}}if(dQ){jd=cJ.parentNode;nx=av.offsetHeight;av.style.height=av.offsetHeight;mT=cJ.offsetHeight;for(var i=0;i<av.rows.length;i++){for(var j=0;j<av.rows[i].cells.length;j++){var be=av.rows[i].cells[j];be.style.height=uZ(be)+"px";be.removeAttribute("height");}}gf.length=0;iL.length=0;var n=0;var lf=jd.rowIndex+lP(jd);for(var i=0;i<lf;i++){for(var j=0;j<av.rows[i].cells.length;j++){var be=av.rows[i].cells[j];if((lP(be)+i)>=lf&&i<lf){gf[n]=be;iL[n]=parseInt(be.style.height);n++;}}}}},MM2:function(e){if(!e){e=eWebEditor.event;}if(!fj){var fU=false;if(e.screenX-nN>kA){if(!df){fU=true;df=true;}}else{if(df){fU=true;df=false;}}if(e.screenY-op>lk){if(!dQ){fU=true;dQ=true;}}else{if(dQ){fU=true;dQ=false;}}if(fU){pp();}return;}if(df){var eK=e.screenX-ot;var gD=eK;if(av.align.toLowerCase()=="center"){gD=2*gD;}var uQ=gD+ma;var tP=gD+mt;if(uQ>=2){av.style.width=tP+"px";dz.style.left=(kj+eK)+"px";for(var i=0;i<hc.length;i++){try{hc[i].style.width=(gD+sA[i])+"px";}catch(er){}}}}if(dQ){var eK=e.screenY-po;var vu=eK+mT;var uw=eK+nx;if(vu>=2){av.style.height=uw+"px";cU.style.top=(lB+eK)+"px";for(var i=0;i<gf.length;i++){try{gf[i].style.height=(eK+iL[i])+"px";}catch(er){}}}}},MU2:function(e){if(!fj){return;}ee();Et();},PMM:function(e){if(!e){e=window.event;}if(F.as&&e.button!=1&&fj){ee();}}};})();var dN=(function(){var fj=false;var Jw=false;var ot;var po;var gu;var JJ;var JQ;var Ka;var Jb,Jf,IJ,Jx,IZ,Kq,Jv,IU;var ze,CW,Kd,Cn;var nX=false;var ur=function(){ze=$("ImgResize_Line_L");CW=$("ImgResize_Line_R");Kd=$("ImgResize_Line_T");Cn=$("ImgResize_Line_B");Jb=$("ImgResize_C_LT");Jf=$("ImgResize_C_LM");IJ=$("ImgResize_C_LB");Jx=$("ImgResize_C_CT");IZ=$("ImgResize_C_CB");Kq=$("ImgResize_C_RT");Jv=$("ImgResize_C_RM");IU=$("ImgResize_C_RB");R.az(document,'mousedown',dN.PMD);nX=true;};var Kz=function(){Jw=false;fj=false;gu=null;IL("none");};var IL=function(v){var JH=[ze,CW,Kd,Cn,Jb,Jf,IJ,Jx,IZ,Kq,Jv,IU];for(var i=0;i<JH.length;i++){JH[i].style.display=v;}};var JL=function(el,IR,Kw){var w=IR-2;var h=Kw-2;var jq=el.clientLeft;var dM=el.clientTop;while(el){jq+=el.offsetLeft;dM+=el.offsetTop;el=el.offsetParent;}var JV=R.gL(EWEB.aR);jq=jq-JV.X;dM=dM-JV.Y;jq=jq+$("eWebEditor").offsetLeft+$("eWebEditor_Layout").offsetLeft+jF(R.ce($("eWebEditor_EditareaTD"),"border-left-width"))+jF(R.ce($("eWebEditor"),"border-left-width"));dM=dM+$("eWebEditor").offsetTop+$("eWebEditor_Layout").offsetTop+$("eWebEditor_ToolarPTR").offsetHeight+jF(R.ce($("eWebEditor_EditareaTD"),"border-top-width"))+jF(R.ce($("eWebEditor"),"border-top-width"));Jb.style.left=jq+"px";Jb.style.top=dM+"px";Jx.style.left=(jq+parseInt(w/2))+"px";Jx.style.top=dM+"px";Kq.style.left=(jq+w)+"px";Kq.style.top=dM+"px";Jf.style.left=jq+"px";Jf.style.top=(dM+parseInt(h/2))+"px";Jv.style.left=(jq+w)+"px";Jv.style.top=(dM+parseInt(h/2))+"px";IJ.style.left=jq+"px";IJ.style.top=(dM+h)+"px";IZ.style.left=(jq+parseInt(w/2))+"px";IZ.style.top=(dM+h)+"px";IU.style.left=(jq+w)+"px";IU.style.top=(dM+h)+"px";ze.style.left=jq+"px";ze.style.top=dM+"px";ze.style.height=h+"px";CW.style.left=(jq+w+1)+"px";CW.style.top=dM+"px";CW.style.height=h+"px";Kd.style.left=jq+"px";Kd.style.top=dM+"px";Kd.style.width=w+"px";Cn.style.left=jq+"px";Cn.style.top=(dM+h+1)+"px";Cn.style.width=w+"px";};var jF=function(bv){if(!bv){return 0;}if(isNaN(parseInt(bv))){return 0;}bv=bv.toLowerCase();if(parseFloat(bv)==0){return 0;}else if(bv.eg("px")){return parseInt(bv);}else if(bv.eg("pt")){return parseInt(parseFloat(bv)*4/3);}else if(bv.eg("cm")){return parseInt(parseFloat(bv)*28.35*4/3);}else if(bv.eg("mm")){return parseInt(parseFloat(bv)*0.001*28.35*4/3);}else{return 0;}};var Jn=function(){return(!F.EY&& !F.KT);};return{IX:function(){if(Jn()){R.az(EWEB.T,'keydown',dN.Jy);R.az(EWEB.T,'mousedown',dN.Jy);R.az(EWEB.T,'dblclick',dN.Jy);R.az(EWEB.T,'click',dN.LC);R.az(EWEB.T,'scroll',dN.Jy);R.az(EWEB.T,'mouseup',dN.MU2);R.az(EWEB.T,'mousemove',dN.MM2);}},Jy:function(e){if(Jw){Kz();}},LC:function(e){if(e.button==2|| !Jn()){return;}var el=e.srcElement||e.target;if(!el){return;}if(el.tagName!="IMG"){return;}gu=el;if(!nX){ur();}JQ=jF(R.ce(el,"width"));Ka=jF(R.ce(el,"height"));JL(el,JQ,Ka);IL("block");Jw=true;},MD2:function(e){if(fj){return;}fj=true;ot=e.screenX;po=e.screenY;var el=e.srcElement||e.target;JQ=jF(R.ce(gu,"width"));Ka=jF(R.ce(gu,"height"));JJ=el.id.substr(12).toLowerCase();},MM2:function(e){if(!fj){return;}var x=e.screenX-ot;var y=e.screenY-po;var w=JQ;var h=Ka;switch(JJ){case "lt":w=w-x;h=h-y;break;case "lm":w=w-x;break;case "lb":w=w-x;h=h+y;break;case "ct":h=h-y;break;case "cb":h=h+y;break;case "rt":w=w+x;h=h-y;break;case "rm":w=w+x;break;case "rb":w=w+x;h=h+y;break;}if(w<5){w=5;}if(h<5){h=5;}gu.style.width=w+"px";gu.style.height=h+"px";JL(gu,w,h);},MU2:function(e){if(!fj){return;}fj=false;Et();},PMD:function(e){if(!Jw){return;}var el=e.srcElement||e.target;if(el!=ze&&el!=CW&&el!=Kd&&el!=Cn&&el!=Jb&&el!=Jf&&el!=IJ&&el!=Jx&&el!=IZ&&el!=Kq&&el!=Jv&&el!=IU){Kz();}}};})();var ap=(function(){var dm=[];var dv=0;var dR=[];var ha=false;var Ej=10000000;var DY=0;var ox=function(){var lw=dR[dv];if(lw){if(F.as){eWebEditor_Layout.focus();if(lw.substring(0,8)!="[object]"){var r=EWEB.T.body.createTextRange();if(r.moveToBookmark(dR[dv])){r.select();}}else{if(EWEB.ae=="EDIT"){var r=EWEB.T.body.createControlRange();var a=lw.split("|");var K=EWEB.T.body.getElementsByTagName(a[1]);var el=K[a[2]];r.addElement(el);r.select();}}}else{}}};var tq=function(el){var K=EWEB.T.body.getElementsByTagName(el.tagName);for(var i=0;i<K.length;i++){if(K[i]==el){return i;}}return null;};return{HO:function(){if(dm.length<=1||dv<=0){return false;}return true;},rC:function(){if(dv>=dm.length-1||dm.length==0){return false;}return true;},jO:function(){if(EWEB.ae!="EDIT"){return;}ha=false;},Save:function(){if(EWEB.ae!="EDIT"){return;}if(ha){return;}ha=true;var NY=getHTML();if(dm[dv]==NY){return;}var ws=dm.length-dv;for(var i=1;i<ws;i++){DY=DY-dm[dm.length-1].length;dm.pop();dR.pop();}dm[dm.length]=NY;DY=DY+NY.length;while(DY>Ej&&dm.length>1){DY=DY-dm[0].length;dm.shift();dR.shift();}if(F.as){if(C.ai()!="Control"){try{dR[dR.length]=EWEB.T.selection.createRange().getBookmark();}catch(e){dR[dR.length]="";}}else{var el=C.ax();dR[dR.length]="[object]|"+el.tagName+"|"+tq(el);}}else{try{dR[dR.length]=EWEB.aR.getSelection().getRangeAt(0).endContainer;}catch(e){dR[dR.length]="";}}dv=dm.length-1;},Go:function(v){if(EWEB.ae!="EDIT"){return;}if(!ha){this.Save();}var EJ=dv+v;if(EJ>=0&&EJ<dm.length){dv=EJ;setHTML(dm[dv],true);ox();}EWEB.Focus();ci.eW();}};})();function exec(iA,iQ){EWEB.Focus();ap.Save();iA=iA.toLowerCase();var kf=true;switch(iA){case 'undo':ap.Go(-1);kf=false;break;case 'redo':ap.Go(1);kf=false;break;case 'cut':kC.Execute('Cut');break;case 'copy':kC.Execute('Copy');kf=false;break;case 'paste':oX();break;case 'pastetext':ix();break;case 'pasteword':kF();break;case 'delete':format('delete');break;case 'removeformat':format('RemoveFormat');break;case 'selectall':format('selectall');kf=false;break;case 'unselect':format('unselect');kf=false;break;case 'findreplace':qu();kf=false;break;case 'quickformat':MY(iQ);kf=false;break;case 'formatbrush':vp.Execute();kf=false;break;case 'bold':format('bold');break;case 'italic':format('italic');break;case 'underline':format('underline');break;case 'strikethrough':format('StrikeThrough');break;case 'superscript':format('superscript');break;case 'subscript':format('subscript');break;case 'uppercase':pl('uppercase');break;case 'lowercase':pl('lowercase');break;case 'forecolor':aK('selcolor.htm?action=forecolor',true);kf=false;break;case 'backcolor':aK('selcolor.htm?action=backcolor',true);kf=false;break;case 'big':dB('big');break;case 'small':dB('small');break;case 'justifyleft':hZ.Execute('justifyleft');break;case 'justifycenter':hZ.Execute('justifycenter');break;case 'justifyright':hZ.Execute('justifyright');break;case 'justifyfull':hZ.Execute('justifyfull');break;case 'orderedlist':format('insertorderedlist');break;case 'unorderedlist':format('insertunorderedlist');break;case 'indent':format('indent');break;case 'outdent':format('outdent');break;case 'br':dB('br');break;case 'paragraph':format('InsertParagraph');break;case 'paragraphattr':tM();kf=false;break;case 'textindent':case 'lineheight':case 'margintop':case 'marginbottom':Jz.Ky(iA,iQ);break;case 'imagemargin':aK('imagemargin.htm',true);kf=false;break;case 'image':aK('img.htm',true);kf=false;break;case 'flash':aK('flash.htm',true);kf=false;break;case 'media':aK('media.htm',true);kf=false;break;case 'file':aK('file.htm',true);kf=false;break;case 'remoteupload':remoteUpload();kf=false;break;case 'localupload':localUpload();kf=false;break;case 'fieldset':aK('fieldset.htm',true);kf=false;break;case 'iframe':aK('iframe.htm',true);kf=false;break;case 'horizontalrule':aK('hr.htm',true);kf=false;break;case 'marquee':aK('marquee.htm',true);kf=false;break;case 'createlink':uB();kf=false;break;case 'unlink':format('UnLink');break;case 'map':tQ();kf=false;break;case 'anchor':aK('anchor.htm',true);kf=false;break;case 'galleryimage':aK('browse.htm?type=image',true);kf=false;break;case 'galleryflash':aK('browse.htm?type=flash',true);kf=false;break;case 'gallerymedia':aK('browse.htm?type=media',true);kf=false;break;case 'galleryfile':aK('browse.htm?type=file',true);kf=false;break;case 'bgcolor':aK('selcolor.htm?action=bgcolor',true);kf=false;break;case 'backimage':aK('backimage.htm',true);kf=false;break;case 'absoluteposition':uD();break;case 'zindexbackward':pe('backward');break;case 'zindexforward':pe('forward');break;case 'showborders':kh.Execute();kf=false;break;case 'showblocks':jK.Execute();kf=false;break;case 'quote':dB('quote');break;case 'code':dB('code');break;case 'symbol':aK('symbol.htm',true);kf=false;break;case 'printbreak':dB('printbreak');break;case 'emot':aK('emot.htm',true);kf=false;break;case 'nowdate':dB('nowdate');break;case 'nowtime':dB('nowtime');break;case 'importword':ow('word');kf=false;break;case 'importexcel':ow('excel');kf=false;break;case 'importppt':ow('ppt');kf=false;break;case 'importpdf':ow('pdf');kf=false;break;case 'template':aK('template.htm',true);kf=false;break;case 'capture':ue();kf=false;break;case 'pagination':aK('pagination.htm',true);kf=false;break;case 'paginationinsert':dp.fv();break;case 'titleimage':CF();kf=false;break;case 'imagedoc':Bw();kf=false;break;case 'formtext':eO.fv('inputtext');break;case 'formtextarea':eO.fv('textarea');break;case 'formradio':eO.fv('radio');break;case 'formcheckbox':eO.fv('checkbox');break;case 'formdropdown':eO.fv('select');break;case 'formbutton':eO.fv('button');break;case 'tableinsert':bI.TableInsert();kf=false;break;case 'tableprop':bI.TableProp();kf=false;break;case 'tablecellprop':bI.tK();kf=false;break;case 'tablecellsplit':bI.uC();kf=false;break;case 'tablerowprop':bI.sT();kf=false;break;case 'tablerowinsertabove':bI.qt();break;case 'tablerowinsertbelow':bI.sR();break;case 'tablerowmerge':bI.rv();break;case 'tablerowsplit':bI.pI(2);break;case 'tablerowdelete':bI.qa();break;case 'tablecolinsertleft':bI.sf();break;case 'tablecolinsertright':bI.sK();break;case 'tablecolmerge':bI.sq();break;case 'tablecolsplit':bI.qY(2);break;case 'tablecoldelete':bI.rX();break;case 'tabletemplate':bI.TableTemplate();kf=false;break;case 'refresh':setHTML('');kf=false;break;case 'modecode':setMode('CODE');kf=false;break;case 'modeedit':setMode('EDIT');kf=false;break;case 'modetext':setMode('TEXT');kf=false;break;case 'modeview':setMode('VIEW');kf=false;break;case 'sizeplus':ej(300);kf=false;break;case 'sizeminus':ej(-300);kf=false;break;case 'print':tp();kf=false;break;case 'maximize':kQ.Execute();kf=false;break;case 'minimize':parent.Minimize();kf=false;break;case 'expandtoolbar':ci.CY();kf=false;break;case 'about':aK('about.htm');kf=false;break;case 'fontface':fq('face',iQ);break;case 'fontsize':fq('size',iQ);break;case 'formatblock':format('FormatBlock',iQ);break;case 'zoom':cY.Execute(iQ);kf=false;break;case "wordeq":Ry.KE();kf=false;break;}if(kf){ap.jO();ap.Save();}};function MY(NZ){var MQ=(! !config.AutoDoneQuickFormat);if(NZ&&typeof(NZ)=="object"){var b=NZ["hide"];if(typeof(b)!="undefined"){MQ=(! !b);}}else{NZ=null;}if(MQ){aK("quickformat.htm?autodone=1",true,false,true,NZ);}else{aK("quickformat.htm",true,false,false,NZ);}};var EWEB={V:"15.3",T:null,aR:null,ae:null,bs:null,BaseHref:"",cd:"",ReadyState:"",Focus:function(){if(EWEB.ae=="CODE"||EWEB.ae=="TEXT"){EWEB.db.focus();return;}C.Restore();if(F.as){eWebEditor.focus();}else{var s=this.aR.getSelection();var Ml=s.rangeCount;if(Ml>0){if(s.anchorNode.nodeType==9||s.focusNode.nodeType==9){s.removeAllRanges();Ml=0;}}if(Ml<1){var dK=R.Lq();var My=dK;var KL=dK.firstChild;if(KL){if(KL.nodeType==1&&(KL.tagName=="P"||KL.tagName=="DIV")){My=KL;}}var r=this.T.createRange();r.selectNodeContents(My);r.collapse(true);s.addRange(r);}if(F.eo){$("eWebEditor").focus();}else{this.T.body.focus();}}},Init:function(){if(!config.L){return;}if(!F.iF){return;}var s=document.location.pathname;this.cd=s.substr(0,s.length-15);this.BaseHref="";if(config.BaseHref!=""){this.BaseHref="<base href='"+aA.hW+config.BaseHref+"'></base>";}if(aA.ExtCSS){this.ExtCSS="<link href='"+uN(aA.ExtCSS)+"' type='text/css' rel='stylesheet'>";}else{this.ExtCSS="";}if(aA.Skin){config.Skin=aA.Skin;}if(aA.FixWidth){config.FixWidth=aA.FixWidth;}if(config.FixWidth){if(/^[0-9\.]+$/gi.test(config.FixWidth)){config.FixWidth+="px";}}if(aA.AreaCssMode){config.AreaCssMode=aA.AreaCssMode;}if(aA.TitleImage){config.TitleImage=aA.TitleImage;}if(aA.ReadOnly){config.InitMode="VIEW";}var Ot=function(s){return s.replace(/\[/gi,";91;").replace(/\]/gi,";93;");};var Qb="?style="+aA.StyleName+"&cusdir="+aA.CusDir+"&skey="+aA.SKey+"&h="+aA.SH+"&o="+aA.SO;var Ic=aA.hW+this.cd+"/";if(aA.Nm){Ic=aA.Nm;config.FSPath=aA.Nm;}this.Po=Ic+config.ServerExt+"/i."+config.ServerExt+Qb;this.OS=Ic+config.ServerExt+"/upload."+config.ServerExt+Qb;this.PL=Ic+config.ServerExt+"/browse."+config.ServerExt+Qb;R.az(document,'contextmenu',jt);R.az(document,'dragstart',jt);R.az(document,'selectstart',jt);R.az(document,'select',jt);if(F.Ei){window.onresize=function(e){Dj();};}}};function focus(){EWEB.Focus();};function setReadOnly(dF){if(dF!="1"&&dF!="2"){dF="";}EWEB.ReadOnly=EWEB.ReadOnly||"";if(EWEB.ReadOnly==dF){return;}var hI=$("eWebEditor_SB");var mF=$("eWebEditor_SB_Mode");if(hI){switch(dF){case "1":hI.style.display="";mF.style.display="none";break;case "2":hI.style.display="none";break;default:hI.style.display="";mF.style.display="";}}EWEB.ReadOnly=dF;if(EWEB.ReadyState=="complete"){var dA="EDIT";if(dF!=""){dA="VIEW";}if(dA==EWEB.ae){Dj();}else{setMode(dA);}}};EWEB.lo=function(){var J=this.T;if(F.as||F.eo){J.body.contentEditable=true;J.execCommand("2D-Position",true,true);}else{try{var dK=J.body;if('contentEditable'in dK){dK.contentEditable=true;}if('spellcheck'in dK){dK.spellcheck=false;}J.execCommand("styleWithCSS",false,"true");J.execCommand("enableInlineTableEditing",false,"false");if(config.EnterMode=="2"){J.execCommand("insertBrOnReturn",false,"true");}}catch(e){}}};function jt(e){if(EWEB.ae=="EDIT"||EWEB.ae=="VIEW"){return R.aw(e);}};function Dj(){if(!F.Ei|| !EWEB.ae){return;}var xv=document.getElementById('eWebEditor');if(xv){var It=$("eWebEditor_Layout");if(EWEB.QJ){var be=xv.parentNode;var He=R.eF(window);var GM=He.Width-BW(R.ce(document.body,"padding-left"))-BW(R.ce(document.body,"padding-right"))-BW(R.ce(document.body,"border-left-width"))-BW(R.ce(document.body,"border-right-width"));var Ip=He.Height-BW(R.ce(document.body,"padding-top"))-BW(R.ce(document.body,"padding-bottom"))-BW(R.ce(document.body,"border-top-width"))-BW(R.ce(document.body,"border-bottom-width"));It.style.width=GM+"px";It.style.height=Ip+"px";var GO=$("eWebEditor_Toolbar").offsetHeight;var IC=0;if(config.StateFlag){IC=$("eWebEditor_SB").offsetHeight;}var HC=Ip-GO-IC;var Ks=GM-BW(R.ce(be,"padding-left"))-BW(R.ce(be,"padding-right"))-BW(R.ce(be,"border-left-width"))-BW(R.ce(be,"border-right-width"));var Hf=HC-BW(R.ce(be,"padding-top"))-BW(R.ce(be,"padding-bottom"))-BW(R.ce(be,"border-top-width"))-BW(R.ce(be,"border-bottom-width"));be.style.height=Hf+"px";if(EWEB.ae=="EDIT"||EWEB.ae=="VIEW"){var Ee=BW(R.ce(xv,"border-top-width"));var EF=BW(R.ce(xv,"border-bottom-width"));var Dv=BW(R.ce(xv,"border-left-width"));var EG=BW(R.ce(xv,"border-right-width"));xv.style.width=(Ks-Dv-EG)+'px';xv.style.height=(Hf-Ee-EF)+'px';DN();}else{var Hb=(Ip)-(GO+IC+be.offsetHeight);if(Hb!=0){be.style.height=(Hf+Hb)+"px";}}window.scrollTo(0,0);return;}}window.setTimeout(Dj,10);};function DN(){var xv=$('eWebEditor');if(F.Ei&&F.as){var dK=xv.contentWindow.document.body;var DI=BW(R.ce(dK,"padding-top"));var DE=BW(R.ce(dK,"padding-bottom"));dK.style.minHeight=(xv.clientHeight-DI-DE)+"px";}};var config=new Object();window.onload=ts;function ts(){if(!F.iF){Er("\u6b64\u7248\u4e0d\u518d\u652f\u6301\u65e7\u7684\u0049\u0045\u5185\u6838\u6d4f\u89c8\u5668\u3002\u5982\u60a8\u9700\u8981\u4f7f\u7528\u0049\u0045\u6216\u5176\u5b83\u6d4f\u89c8\u5668\u7684\u517c\u5bb9\u6a21\u5f0f\uff0c\u8bf7\u5b89\u88c5\u0049\u0045\u0031\u0030\u6216\u0049\u0045\u0031\u0031\u3002");return;}if(parent==window){return;}if(EWEB.ReadyState){return;}EWEB.ReadyState="loading";IG.CT("get",aA.TE,true,null,function(eL){if(eL["state"]=="ok"){if(eL["isjson"]){config=eL["data"];QX();}else{Er("Backend config file format error.");return;}}else{Er("XHR status: "+eL["xhrstatus"]);return;}});};function QX(){RS("js/zh-cn.js?v=15.3",function(Iu){if(Iu){RA();}else{Er("load language file error.");return;}});};function RA(){if(config.err){Er(lang["ErrStyle"]);return;}if(!config.v){Er(lang["ErrLoadCfgJs"]);return;}if(!config.L){Er(lang["ErrLicense"]);return;}EWEB.Init();PS(EWEB.cd+"/skin/"+config.Skin+"/editor.css?v="+config.v,function(SC){if(SC){EWEB.QJ=true;}});document.body.innerHTML=QU();if(!F.Bx){if(config.AutoDetectPaste=="1"){config.AutoDetectPaste="0";}config.MFUEnable="0";}R.lE(window);if(!F.iF){return;}EWEB.bs=parent.document.getElementsByName(aA.bs)[0];if(!EWEB.bs){EWEB.bs=parent.document.getElementById(aA.bs);}if(!EWEB.bs){alert('[EWEBEDITOR] The element with id or name "'+aA.bs+'" was not found.');return;}if(EWEB.bs.tagName=="TEXTAREA"||EWEB.bs.tagName.substring(0,5)=="INPUT"){EWEB.hq="INPUT";}else{EWEB.hq="OTHER";}if(F.Ei){Dj();}ci.vF();R.ko(document.body);if(F.as){}else{$("eWebEditorTextarea").style.MozUserSelect="text";}EWEB.aR=$("eWebEditor").contentWindow;EWEB.T=EWEB.aR.document;EWEB.TM=EWEB.aR.document.body;EWEB.db=$("eWebEditorTextarea");if(!F.iF){config.InitMode="TEXT";}if($("D_ContentFlag").value=="0"){var qW=(EWEB.hq=="INPUT")?EWEB.bs.value:EWEB.bs.innerHTML;$("D_ContentEdit").value=qW;$("D_ContentLoad").value=qW;$("D_CurrMode").value=config.InitMode;$("D_ContentFlag").value="1";}setReadOnly(aA.ReadOnly);setMode($("D_CurrMode").value,true);tU();if(aA.rD){window.setInterval(qG,1000);}R.az(EWEB.db,'keyup',Na);R.az(EWEB.db,'paste',MG);R.az(EWEB.db,'cut',Ny);R.az(window,'scroll',Oe);R.az(document,'keydown',mP);if(F.as){lT();}else{window.setTimeout(lT,200);}};function lT(){EWEB.ReadyState="complete";sk({flag:"LoadComplete"});};function Et(){R.oQ(sk,400,null,[{flag:"Change"}]);};function sk(fC){fC.id=aA.vs;fC.linkid=aA.bs;fC.win=window;fC.doc=EWEB.T;try{parent.EWEBEDITOR.EVENT(fC);}catch(e){}var jE;try{jE=parent.EWEBEDITOR_EVENT(fC);}catch(e){}if((fC.flag=="AfterImportWord")&&(fC.action=="paste")){sk({flag:"Paste",type:"word"});}if((fC.flag=="AfterImportExcel")&&(fC.action=="paste")){sk({flag:"Paste",type:"excel"});}return(jE&&typeof(jE)=="object")?jE:{};};function tU(){if(aA.Ik=="0"){return;}if(!EWEB.bs){return;}if(EWEB.hq!="INPUT"){return;}var aO=EWEB.bs.form;if(!aO){return;}R.az(aO,'submit',ie);if(!aO.submitEditor){aO.submitEditor=new Array();}aO.submitEditor[aO.submitEditor.length]=ie;if(!aO.originalSubmit){aO.originalSubmit=aO.submit;aO.submit=function(){if(this.submitEditor){for(var i=0;i<this.submitEditor.length;i++){try{this.submitEditor[i]();}catch(e){}}}this.originalSubmit();};}R.az(aO,'reset',iT);if(!aO.resetEditor)aO.resetEditor=new Array();aO.resetEditor[aO.resetEditor.length]=iT;if(!aO.originalReset){aO.originalReset=aO.reset;aO.reset=function(){if(this.resetEditor){for(var i=0;i<this.resetEditor.length;i++){try{this.resetEditor[i]();}catch(e){}}}this.originalReset();};}};function ie(){var aO=EWEB.bs.form;if(!aO){return;}var NY=getHTML();if(config.PaginationMode!="0"&&config.PaginationAutoFlag!="0"){if(EWEB.ae!="EDIT"){setMode("EDIT");}var b=true;if(config.PaginationAutoFlag=="1"){var K=EWEB.T.getElementsByTagName("IMG");for(var i=0;i<K.length;i++){var cb=K[i].getAttribute("_ewebeditor_fake_tag",2);if(cb){if(cb.toLowerCase()=="pagination"){b=false;break;}}}}if(b){dp.Auto(config.PaginationAutoNum);NY=getHTML();}}$("D_ContentEdit").value=NY;pb(EWEB.bs,NY);};function iT(){setHTML($("D_ContentLoad").value);};function uO(){if(EWEB.hq!="INPUT"){return;}var aO=EWEB.bs.form;if(!aO){return;}if(aO.onsubmit){if(aO.onsubmit()){aO.submit();}}else{aO.submit();}};function Oe(){try{var n=document.body.scrollTop;if(n&&n>0){document.body.scrollTop=0;}}catch(er){}return true;};function mP(e){if(!e){e=eWebEditor.event;}var bK=e.keyCode||e.which;if(bK==9){R.aw(e);return false;}return true;};function Na(e){if(!e){e=eWebEditor.event;}var bK=e.keyCode||e.which;if(!(e.ctrlKey||e.altKey)){if(R.KO([33,34,35,36,37,38,39,40,17,18],bK)<0){Et();}}return true;};function MG(){Et();return true;};function Ny(){Et();return true;};function nM(e){aK('about.htm');return R.aw(e);};function vd(e){if(!e){e=eWebEditor.event;}if(F.EY){return R.aw(e);}else{if(config.AutoDetectPaste=="0"){return true;}else{return R.aw(e);}}};function NH(e){if(!F.AM){return true;}try{var NY=getSelectedHTML();var bE=getSelectedText();bE=bE.replace(/\n/gi,"\r\n");e.clipboardData.setData("text/html",NY);e.clipboardData.setData("text/plain",bE);e.preventDefault();}catch(er){}};function sU(e){if(!e){e=eWebEditor.event;}var bK=e.keyCode||e.which;var bA=String.fromCharCode(bK).toUpperCase();if(bK==8){var dK=R.Lq();if(dK.innerHTML==""){dK.innerHTML=MC();}}if(e.ctrlKey||((bK>=33)&&(bK<=40))||(bK==13)||(bK==8)||(bK==46)){ci.eW();}if(NC){Et();}return true;};var NC;function sZ(e){if(!e){e=eWebEditor.event;}var bK=e.keyCode||e.which;var bA=String.fromCharCode(bK).toUpperCase();var bo=false;var kf=false;if(bK==112&& !F.as){exec("about");bo=true;}else if(bK==113){exec("showborders");bo=true;}else if(bK==114){exec("showblocks");bo=true;}if(!bo&&e.ctrlKey){if(bK==13){uO();bo=true;}else if(bK==187||bK==107){exec("sizeplus");bo=true;}else if(bK==189||bK==109){exec("sizeminus");bo=true;}else if(bA=="1"){exec("modecode");bo=true;}else if(bA=="2"){exec("modeedit");bo=true;}else if(bA=="3"){exec("modetext");bo=true;}else if(bA=="4"){exec("modeview");bo=true;}else if(bA=="A"){exec("selectall");bo=true;}else if(bA=="R"){exec("findreplace");bo=true;}else if(bA=="Z"){exec("undo");bo=true;}else if(bA=="Y"){exec("redo");bo=true;}}if(!bo&&F.as&&(bK==8)&&(C.ai()=="Control")){C.Delete();bo=true;kf=true;}if(!bo&&C.ai()=="Text"){if(!(e.ctrlKey&&bA!="D"&&bA!="V")&& !e.metaKey&& !e.shiftKey&& !e.altKey){var Ep=C.cI();if(Ep&&Ep.className=="ewebeditor_template"){Ep.className="";}}}if(!bo&&e.ctrlKey){if(bA=="D"){exec("pasteword");bo=true;}else if(bA=="V"){if(config.AutoDetectPaste!="0"||F.EY){window.setTimeout("exec('paste')",10);bo=true;}}}if((!bo)&&(bK==8||bK==9)){var LF=C.Mk();if(LF){var LL=LF.style.textIndent;if(bK==8){if(LL){LF.style.textIndent="";bo=true;kf=true;}}if(bK==9){if(!LL){LF.style.textIndent="2em";bo=true;kf=true;}}}}if(!bo){if((bK==13)||(bK==8)||(bK==46)){ap.Save();ap.jO();}else if((bK>=33)&&(bK<=40)){ap.Save();}else if(!((e.ctrlKey&&bA=="A")||(e.ctrlKey&&bA=="F"))){ap.jO();}}if((config.EnterMode=="2")&&(bK==13)&&F.as){var aD=EWEB.T.selection.createRange();if(e.shiftKey){var p=aD.parentElement();if(p.tagName!="P"||p.innerHTML==""){aD.pasteHTML("&nbsp;");aD.select();aD.collapse(false);}try{aD.pasteHTML("</P><P id=eWebEditor_Temp_P>");}catch(err){return false;}e.cancelBubble=true;e.returnValue=false;var el=EWEB.T.getElementById("eWebEditor_Temp_P");if(el.innerHTML==""){el.innerHTML="&nbsp;";}aD.moveToElementText(el);aD.select();aD.collapse(false);aD.select();el.removeAttribute("id");}else{try{aD.pasteHTML("<br>");}catch(err){return false;}e.cancelBubble=true;e.returnValue=false;aD.select();aD.moveEnd("character",1);aD.moveStart("character",1);aD.collapse(false);}bo=true;kf=true;}if(bK==32){bo=true;kf=true;insertHTML("&ensp;");}NC=(!bo||kf);if(bo){return R.aw(e);}else{return true;}};function rU(e){if(!e){e=window.event;}if(!F.EY){var el=e.srcElement||e.target;if(el.tagName=="IMG"){if(F.Iq){R.oQ(C.vR,200,C,[el]);}else{C.vR(el);}}}};function rV(e){if(!e){e=eWebEditor.event;}cW.MU2(e);if(e.button!=2){vp.Di();}ap.Save();ci.eW();};function sr(e){if(!e){e=eWebEditor.event;}cW.MM(e);};function DF(e){if(!e){e=eWebEditor.event;}var el=e.srcElement||e.target;if(F.eo){var Ha=EWEB.T.getElementsByTagName("HTML")[0];if(Ha==el){EWEB.T.body.focus();return;}}if(el.className=="ewebeditor_template"){if(F.as){var oRange=EWEB.T.body.createTextRange();oRange.moveToElementText(el);oRange.select();}else{var oRange=EWEB.T.createRange();oRange.selectNodeContents(el);var af=C.bG();af.removeAllRanges();af.addRange(oRange);}}};function HJ(e){if(!e){e=eWebEditor.event;}var el=e.srcElement||e.target;if(el.tagName=="IMG"){var KH=el.getAttribute("_tag",2);if(KH=="wordeq"){exec("wordeq");}else{var da=el.getAttribute("_ewebeditor_fake_tag",2);if(!da){exec("image");}else if(da=="flash"){exec("flash");}else if(da=="mediaplayer6"||da=="mediaplayer7"||da=="realplayer"||da=="quicktime"||da=="flv"||da=="vlc"||da=="video"||da=="audio"){exec("media");}}}};function CE(e){if(vp.Es()){vp.Stop();}else{am.rw(e);}R.aw(e);return false;};function va(){ap.Save();return true;};function uN(aG){if(aG.indexOf("://")>=0){return aG;}if(aG.substr(0,1)=="/"){return aG;}var gx=EWEB.cd;while(aG.substr(0,3)=="../"){aG=aG.substr(3);gx=gx.substring(0,gx.lastIndexOf("/"));}return gx+"/"+aG;};function insertHTML(NY){if(ps()){return;}switch(EWEB.ae){case "EDIT":C.Restore();EWEB.Focus();NY=aE.jY(NY);if(!window.getSelection){if(EWEB.T.selection.type.toLowerCase()=="control"){EWEB.T.selection.clear();}NY='<span id="__ewebeditor_temp_remove__" style="display:none;">eWebEditor</span>'+NY;EWEB.T.selection.createRange().pasteHTML(NY);EWEB.T.getElementById('__ewebeditor_temp_remove__').removeNode(true);}else{var mW=EWEB.T.createDocumentFragment();var lc=EWEB.T.createElement('div');lc.innerHTML=NY;var mz,Ew;while((mz=lc.firstChild)){Ew=mW.appendChild(lc.removeChild(mz));}var Bd=EWEB.aR.getSelection();var fA=Bd.getRangeAt(0);fA.deleteContents();var NN=false;if(/<(p|div|table|td|th|tr|h[1-9]|ul|ol)(?=[\s>])/gi.test(NY)){var Mj=C.cI();if(Mj&&Mj!=R.Lq()){var Nu;var NK=R.Mv(Mj,["P","DIV","TD","TH","TABLE","UL","OL","H1","H2","H3","H4","H5","H6","H7","H8","H9"]);if(NK){if(R.KO(["P","DIV","UL","OL","H1","H2","H3","H4","H5","H6","H7","H8","H9"],NK.tagName)>=0){Nu=NK;}else{Nu=R.Mc(Mj,NK);}}else{Nu=R.Mc(Mj,R.Lq());}var MP=Nu.innerHTML;if(R.KO(["TD","TH"],Nu.tagName)>=0||Nu==R.Lq()){}else if(/^(&nbsp;|\s|\u2002|\u2003|\u2009|&ensp;)*?$/gi.test(MP)||/^\s*?<br\/?>\s*?$/gi.test(MP)){fA.selectNode(Nu);fA.deleteContents();}else{var Or=EWEB.T.createElement("span");fA.insertNode(Or);var Nz;var NI=true;Nz=Or;while(NI&&Nz&&Nz.tagName!="BODY"&&Nz!=Nu){var Nj=Nz.previousSibling;while(Nj){if((Nj.nodeType!=3)||(Nj.nodeValue!="")){NI=false;break;}Nj=Nj.previousSibling;}Nz=Nz.parentNode;}if(NI){Nu.parentNode.insertBefore(mW,Nu);R.cE(Or);}var MO=true;if(!NI){Nz=Or;while(MO&&Nz&&Nz.tagName!="BODY"&&Nz!=Nu){var NX=Nz.nextSibling;while(NX){if((NX.nodeType!=3)||(NX.nodeValue!="")){MO=false;break;}NX=NX.nextSibling;}Nz=Nz.parentNode;}if(MO){Nu.parentNode.insertBefore(mW,Nu.nextSibling);R.cE(Or);}}if(!NI&& !MO){var NA=Nu.cloneNode(true);var MW=0;var Om=[];Nz=Or;while(Nz&&Nz.tagName!="BODY"&&Nz!=Nu){Om[MW]=0;var Nj=Nz.previousSibling;while(Nj){Om[MW]=Om[MW]+1;Nj=Nj.previousSibling;}Nz=Nz.parentNode;MW++;}var MA=Nu;var mj=NA;for(var i=MW-1;i>=0;i--){MA=MA.childNodes[Om[i]];while(MA.nextSibling){R.cE(MA.nextSibling);}if(i==0){R.cE(MA);}mj=mj.childNodes[Om[i]];while(mj.previousSibling){R.cE(mj.previousSibling);}if(i==0){R.cE(mj);}}Nu.parentNode.insertBefore(NA,Nu.nextSibling);Nu.parentNode.insertBefore(mW,Nu.nextSibling);if(Nu.innerHTML==""){R.cE(Nu);}}NN=true;}}}if(!NN){if(fA.commonAncestorContainer.nodeType==9){R.Lq().appendChild(mW);}else{fA.insertNode(mW);}}if(Ew){fA=EWEB.T.createRange();fA.setStartAfter(Ew);fA.collapse(true);Bd.removeAllRanges();Bd.addRange(fA);}}ci.eW();break;case "TEXT":case "CODE":var wa=EWEB.db;wa.focus();if(document.selection){var nr=document.selection.createRange();nr.text=NY;nr.select();}else if(wa.selectionStart||wa.selectionStart=='0'){var CX=wa.selectionStart;var Ev=wa.selectionEnd;var ED=wa.scrollTop;wa.value=wa.value.substring(0,CX)+NY+wa.value.substring(Ev,wa.value.length);if(ED>0){wa.scrollTop=ED;}wa.selectionStart=CX+NY.length;wa.selectionEnd=CX+NY.length;}else{wa.value+=NY;}break;}Et();};function setHTML(NY,ub,Lk){$("D_ContentEdit").value=NY;switch(EWEB.ae){case "CODE":EWEB.db.value=NY;break;case "TEXT":NY=GS(NY);EWEB.db.value=NY;break;case "EDIT":C.Release();if(F.IA&&NY==""){NY="<p></p>";}EWEB.T.open('text/html','replace');EWEB.T.write(pG(aE.jY(NY)));EWEB.T.close();EWEB.lo();R.az(EWEB.T.body,'paste',vd);R.az(EWEB.T,'help',nM);R.az(EWEB.T.body,'dragend',va);R.az(EWEB.T,'keydown',sZ);R.az(EWEB.T,'keyup',sU);R.az(EWEB.T,'contextmenu',CE);R.az(EWEB.T,'mousedown',rU);R.az(EWEB.T,'mouseup',rV);R.az(EWEB.T,'mousemove',sr);R.az(EWEB.T,'click',DF);R.az(EWEB.T,'dblclick',HJ);R.az(EWEB.T,'copy',NH);dN.IX();if(F.EY){R.az(EWEB.T,'beforedeactivate',function(){C.Save();});}DN();break;case "VIEW":EWEB.T.open('text/html','replace');EWEB.T.write(pG(NY));EWEB.T.close();R.az(EWEB.T,'help',nM);R.az(EWEB.T,'contextmenu',R.aw);break;}if(!ub&&(EWEB.ae=="EDIT")){ap.jO();ap.Save();}if(!Lk){Et();}};function getHTML(){var Cx=function(s){var kU=s.replace(/\s+/gi,"");kU=kU.toLowerCase();if((kU=="<p>&nbsp;</p>")||(kU=="<p></p>")||(kU=="<br>")||(kU=="<p><br></p>")){return "";}return s;};var NY;switch(EWEB.ae){case "CODE":NY=EWEB.db.value;break;case "EDIT":dp.wj();Rw();NY=EWEB.T.body.innerHTML;NY=aE.wV(NY);NY=Cx(NY);break;case "VIEW":NY=$("D_ContentEdit").value;NY=Cx(NY);break;case "TEXT":NY=EWEB.db.value;NY=FM(NY);break;default:NY=$("D_ContentEdit").value;NY=Cx(NY);break;}NY=vy.vi(NY);return NY;};function appendHTML(NY){if(ps()){return;}switch(EWEB.ae){case "EDIT":NY=aE.jY(NY);var dK=R.Lq();dK.innerHTML+=NY;break;case "CODE":case "TEXT":EWEB.db.value+=NY;break;}};function Rw(){var K=EWEB.T.getElementsByTagName("input");for(var i=0;i<K.length;i++){var el=K[i];if(el.type=="text"){el.setAttribute("value",FM(el.value,true));}else if(el.type=="radio"||el.type=="checkbox"){if(el.checked){el.setAttribute("checked","true");}else{el.removeAttribute("checked");}}}K=EWEB.T.getElementsByTagName("textarea");for(var i=0;i<K.length;i++){var el=K[i];el.innerHTML=FM(el.value,true);}};function openUploadDialog(v,dF,pw,pN,qK,hA){var cT;if(typeof(v)=="string"){cT=v;}else{cT=v['type']?v['type']:'image';dF=v['mode']?v['mode']:'2';pw=v['savepathfilename']?v['savepathfilename']:'';pN=v['savefilename']?v['savefilename']:'';qK=v['originalfilename']?v['originalfilename']:'';hA=v['returnflag']?v['returnflag']:'';}var aG='i_upload.htm?type='+cT+'&mode='+dF+'&savepathfilename='+pw+'&savefilename='+pN+'&originalfilename='+qK;if(hA){aG+='&returnflag='+hA;}ec.OpenDialog(aG);};function Remove(){if(aA.Ik=="0"){return;}if(EWEB.hq=="INPUT"){var aO=EWEB.bs.form;if(aO){R.hf(aO,'submit',ie);R.hf(aO,'reset',iT);}}};function ed(){if(EWEB.ae=="EDIT"){return true;}alert(lang["MsgOnlyInEditMode"]);return false;};function ps(){if(EWEB.ae=="VIEW"){alert(lang["MsgCanotSetInViewMode"]);return true;}return false;};function hH(){if(F.as||F.eo){return true;}alert(lang["MsgOnlyForIE"]);return false;};function HB(){if(F.Bx){return true;}alert(lang["MsgOnlyForWindow"]);return false;};function sy(){if(F.Bx||F.Tu){return true;}alert(lang["MsgOnlyForLinuxWindow"]);return false;};function format(aN,fN){if(!ed()){return;}EWEB.Focus();if((aN=="unselect")&&(!F.as)){C.Collapse(true);}else{EWEB.T.execCommand(aN,false,fN);}C.Release();EWEB.Focus();ci.eW();if(R.KO(["selectall","unselect"],aN)<0){Et();}};function nq(s){var r;switch(s+""){case "1":r="8pt";break;case "2":r="10pt";break;case "3":r="12pt";break;case "4":r="14pt";break;case "5":r="18pt";break;case "6":r="24pt";break;case "7":r="36pt";break;default:r="";break;}return r;};function setMode(dA,ud){if(dA==EWEB.ae){return;}var Lk=true;if(dA=="TEXT"){if(EWEB.ae==$("D_CurrMode").value){if(!confirm(lang["MsgHtmlToText"])){return;}else{Lk=false;}}}try{$("eWebEditor_CODE").className="SB_Mode_BtnOff";}catch(e){}try{$("eWebEditor_EDIT").className="SB_Mode_BtnOff";}catch(e){}try{$("eWebEditor_TEXT").className="SB_Mode_BtnOff";}catch(e){}try{$("eWebEditor_VIEW").className="SB_Mode_BtnOff";}catch(e){}try{$("eWebEditor_"+dA).className="SB_Mode_BtnOn";}catch(e){}var ja=$("eWebEditor_ToolarTREdit");var hQ=$("eWebEditor_ToolarTRText");var EN=$("eWebEditor_ToolarTRView");if(EWEB.ReadOnly){ja.style.display="none";hQ.style.display="none";EN.style.display="none";}else{if(dA=="EDIT"){ja.style.display="";hQ.style.display="none";EN.style.display="none";}else{ja.style.display="none";if(config.TB2Flag=="1"){if(dA=="VIEW"){hQ.style.display="none";EN.style.display="";}else{hQ.style.display="";EN.style.display="none";}}else{hQ.style.display="none";EN.style.display="none";}}}var NY=getHTML();if(dA=="EDIT"||dA=="VIEW"){$("eWebEditor").style.display="";$("eWebEditorTextarea").style.display="none";}else{$("eWebEditor").style.display="none";$("eWebEditorTextarea").style.display="";if(dA=="CODE"){$("eWebEditorTextarea").className="codemode";}else{$("eWebEditorTextarea").className="textmode";}}EWEB.ae=dA;$("D_CurrMode").value=dA;Dj();setHTML(NY,false,Lk);if(dA=="EDIT"){jK.jJ();kh.jJ();}ci.rk();if(!ud){EWEB.Focus();}};function kZ(el){var Tx=["p","div","h1","h2","h3","h4","h5","h6","pre","ol","ul","fieldset","form","table","tr","blockquote","dl","li","br"];var rW=["script","style","object","embed"];var bE="";var de=el.childNodes;for(var i=0;i<de.length;i++){if(de[i].nodeType==1){var aH=de[i].tagName.toLowerCase();if(rW.indexOf(aH)<0){if(aH=="pre"){var lg=de[i].innerHTML;lg=lg.replace(/<[^>]*?>/gi,"");bE+=lg;}else{bE+=kZ(de[i]);}}if(Tx.indexOf(aH)>=0){bE+="\n";}}else if(de[i].nodeType==3){var fm=de[i].nodeValue;fm=fm.replace(/\n/gi," ");bE+=fm;}}return bE;};function aK(aG,uE,tn,fP,NZ){if(uE&& !ed()){return;}if(tn&& !hH()){return;}if(aG.indexOf(".")<0){aG=aG+".htm";}ec.OpenDialog(aG,fP,NZ);};function FM(NY,Ss){if(NY==null){return "";}NY=NY.replace(/&/gi,"&amp;");NY=NY.replace(/\"/gi,"&quot;");NY=NY.replace(/</gi,"&lt;");NY=NY.replace(/>/gi,"&gt;");if(!Ss){NY=NY.replace(/ (?= )/gi,"&nbsp;");NY=NY.replace(/\n/gi,"<br>");NY=NY.replace(/\r/gi,"");}return NY;};function uf(NY){if(NY==null){return "";}NY=NY.replace(/<br(?=[ \/>]).*?>/gi,"\n");NY=NY.replace(/&nbsp;;/gi," ");NY=NY.replace(/&quot;/gi,"\"");NY=NY.replace(/&lt;/gi,"<");NY=NY.replace(/&gt;/gi,">");NY=NY.replace(/&amp;/gi,"&");return NY;};function addUploadFiles(ek,gw){if(ek){var ea=ek.split("|");var ey=gw.split("|");for(var i=0;i<ea.length;i++){if(ey[i]){var cf=ea[i];var fo=ey[i];addUploadFile(cf,fo);}}}};function addUploadFile(cf,fo){if(!fo){return;}var qN=fo.substr(fo.lastIndexOf("/")+1);hY(aA.wg,cf);hY(aA.vZ,qN);hY(aA.vj,fo);sk({"flag":"AfterUploadOne","savepathfilename":fo,"savefilename":qN,"originalfilename":cf});};function hY(gn,bv){if(!bv){return;}if(gn){var cK=parent.document.getElementById(gn);if(!cK){cK=parent.document.getElementsByName(gn)[0];}if(cK){if(cK.value!=""){cK.value=cK.value+"|";}cK.value=cK.value+bv;try{cK.onchange();}catch(e){}}}};function pb(hv,NY){hv.value=NY;};function remoteUpload(pO){if(config.AutoRemote!="1"){return;}if(EWEB.ae=="TEXT"){return;}hF(lang["MsgRemoteUploading"]);eG.Rj(EWEB.T,{"sy":""},function(eY){dw();if(pO){if(typeof(pO)=='function'){pO();}else{eval("parent."+pO);}}sk({flag:"AfterRemoteUpload"});Et();});};function localUpload(){if(EWEB.ae=="TEXT"){return;}hF(lang["MsgLocalUploading"]);var fh=getHTML();eG.xO(fh,{"cs":"c","sy":""},function(jE){setHTML(jE["html"]);dw();sk({flag:"AfterLocalUpload"});});};function hF(msg){$("msgProcessing").innerHTML=msg;var cR=$("divProcessing");cR.style.top=(document.body.clientHeight-parseFloat(cR.style.height))/2+"px";cR.style.left=(document.body.clientWidth-parseFloat(cR.style.width))/2+"px";};function dw(){$("divProcessing").style.left="-10000px";};function MC(){if(F.eo){return "<p></p>";}else if(!F.EY){if(config.EnterMode=="2"){return '<br>';}else{return '<p><br></p>';}}return "";};function pG(NY){var CR=function(s){if(s==''){return MC();}else{return s;}};var dS;dS='<!DOCTYPE html>';var Sj=(config.FixWidth)?' class="fixwidth"':'';dS+='<html unselectable=on'+Sj+'>';dS+='<head><meta name="referrer" content="never">';dS+='<link href="'+EWEB.cd+'/skin/'+config.Skin+'/editarea.css?v='+EWEB.V+'" type="text/css" rel="stylesheet">';switch(EWEB.ae){case 'CODE':break;case 'TEXT':break;case 'EDIT':case 'VIEW':if(config.AreaCssMode!='1'){dS+='<link href="'+EWEB.cd+'/skin/'+config.Skin+'/editarea.zh-cn.css?v='+EWEB.V+'" type="text/css" rel="stylesheet">';}dS+=EWEB.ExtCSS;break;}if(EWEB.ae=="VIEW"){dS+='<base target="_blank">';NY=NY.replace(/(<a\s[^>]*?target\s*?=\s*?[\'\"]?)\_[a-zA-Z]+([\'\"]?[^>]*?>)/gi,'$1_blank$2');}dS+=EWEB.BaseHref+'</head>';var FT='';if(aA.rD){FT+='overflow-y:hidden;';}if(config.FixWidth){FT+='width:'+config.FixWidth+';';}if(FT){FT=' style="'+FT+'"';}var aI=dS+'<body'+FT+'>'+CR(NY)+'</body></html>';return aI;};function getCount(jN){var bM=getText();bM=bM.replace(/\n/g,"");bM=bM.replace(/\r/g,"");var l=bM.length;var n=0;for(var i=0;i<l;i++){if(bM.charCodeAt(i)<0||bM.charCodeAt(i)>255){if(jN!=0){n++;if(jN==3){n++;}}}else{if(jN!=1){n++;}}}return n;};function getText(){var bE;if(EWEB.ae=="TEXT"){bE=EWEB.db.value;}else{bE=GS(getHTML());}return bE;};function GS(NY){NY=NY.replace(/<script[^>]*?>(?:[^a]|a)*?<\/script>/gi,"");NY=NY.replace(/<style[^>]*?>(?:[^a]|a)*?<\/style>/gi,"");NY=NY.replace(/<object[^>]*?>(?:[^a]|a)*?<\/object>/gi,"");NY=NY.replace(/<embed[^>]*?>(?:[^a]|a)*?<\/embed>/gi,"");NY=NY.replace(/(<br[\s]*?\/?>|<\/[a-zA-Z]+>)([\r\n]+)([^<])/gi,"$1$3");var el=$("eWebEditor_Temp_HTML");el.innerHTML=NY;if(F.EY){return el.innerText;}else{return kZ(el);}};function PS(wx,HG){var el=document.createElement('link');el.type='text/css';el.rel='stylesheet';if(el.readyState){el.onreadystatechange=function(){if(el.readyState==='loaded'||el.readyState==='complete'){el.onreadystatechange=null;if(HG){HG(true);}}}}else{el.onload=function(){if(HG){HG(true);}};el.onerror=function(){if(HG){HG(false);}};}el.href=wx;document.head.appendChild(el);};function RS(wx,HG){var el=document.createElement('script');el.type='text/javascript';if(el.readyState){el.onreadystatechange=function(){if(el.readyState==='loaded'||el.readyState==='complete'){el.onreadystatechange=null;if(HG){HG(true);}}}}else{el.onload=function(){if(HG){HG(true);}};el.onerror=function(){if(HG){HG(false);}};}el.src=wx;document.head.appendChild(el);};function Er(ri){var ak="<style>html,body{margin:0px;padding:0px;border:0px;height:100%;}</style>";var RG="<table id='t_errbox' style='width:100%;height:100%;border-collapse:collapse;border-color:#999999;background-color:#fefefe;' border='1'><tr><td style='text-align:center;font-size:9pt;line-height:2;'>eWebEditor!<br><br>";var QP="</td></tr></table>";document.body.innerHTML=ak+RG+ri+QP;var t=document.getElementById("t_errbox");document.body.style.margin="0px";t.style.height=document.documentElement.offsetHeight+"px";};function QU(){var bC="";bC+="<table id='eWebEditor_Layout' border='0' cellpadding='0' cellspacing='0' width='100%' height='100%' style='table-layout:fixed'>";bC+="<tr id='eWebEditor_ToolarPTR'><td>";bC+="<table id='eWebEditor_Toolbar' border=0 cellpadding=0 cellspacing=0 width='100%'>";bC+="<tr id='eWebEditor_ToolarTRText' style='display:none'><td>";bC+=qy(vL("Text"),"Text");bC+="</td></tr>";bC+="<tr id='eWebEditor_ToolarTRView' style='display:none'><td>";bC+=qy(vL("View"),"View");bC+="</td></tr>";bC+="<tr id='eWebEditor_ToolarTREdit' style='display:'><td>";bC+=qy(config.Toolbars,"Edit");bC+="</td></tr>";bC+="</table>";bC+="</td></tr>";bC+="<tr><td id='eWebEditor_EditareaTD' height='100%'>";bC+="<textarea id='eWebEditorTextarea' style='display:none;width:100%;height:100%;' spellcheck='false' autocorrect='off'></textarea>";bC+='<iframe id="eWebEditor" style="width:100%;height:100%"  frameborder="0" allowTransparency="true" src="'+R.iO()+'"></iframe>';bC+="</td></tr>";if(config.StateFlag){bC+="<tr id='eWebEditor_SB'><td class='SB'>";bC+="	<table border='0' cellpadding='0' cellspacing='0' width='100%' class='SB'>";bC+="	<tr valign='middle'>";bC+="	<td>";bC+="		<table id='eWebEditor_SB_Mode' border='0' cellpadding='0' cellspacing='0' class='SB_Mode'>";bC+="		<tr>";bC+="		<td class='SB_Mode_Left'></td>";if(config.SBCode){bC+="		<td class=SB_Mode_BtnOff id=eWebEditor_CODE onclick=\"setMode('CODE')\" unselectable=on><table border=0 cellpadding=0 cellspacing=0><tr><td class=SB_Mode_Btn_Img>"+ef("ModeCode")+"</td><td class=SB_Mode_Btn_Text>"+lang["StatusModeCode"]+"</td></tr></table></td>";bC+="		<td class=SB_Mode_Sep></td>";}if(config.SBEdit){bC+="		<td class=SB_Mode_BtnOff id=eWebEditor_EDIT onclick=\"setMode('EDIT')\" unselectable=on><table border=0 cellpadding=0 cellspacing=0><tr><td class=SB_Mode_Btn_Img>"+ef("ModeEdit")+"</td><td class=SB_Mode_Btn_Text>"+lang["StatusModeEdit"]+"</td></tr></table></td>";bC+="		<td class=SB_Mode_Sep></td>";}if(config.SBText){bC+="		<td class=SB_Mode_BtnOff id=eWebEditor_TEXT onclick=\"setMode('TEXT')\" unselectable=on><table border=0 cellpadding=0 cellspacing=0><tr><td class=SB_Mode_Btn_Img>"+ef("ModeText")+"</td><td class=SB_Mode_Btn_Text>"+lang["StatusModeText"]+"</td></tr></table></td>";bC+="		<td class=SB_Mode_Sep></td>";}if(config.SBView){bC+="		<td class=SB_Mode_BtnOff id=eWebEditor_VIEW onclick=\"setMode('VIEW')\" unselectable=on><table border=0 cellpadding=0 cellspacing=0><tr><td class=SB_Mode_Btn_Img>"+ef("ModeView")+"</td><td class=SB_Mode_Btn_Text>"+lang["StatusModeView"]+"</td></tr></table></td>";}bC+="		</tr>";bC+="		</table>";bC+="	</td>";if(aA.FullScreen!="1"&&config.SBSize){bC+="	<td align=right>";bC+="		<table id='eWebEditor_SB_Size' border=0 cellpadding=0 cellspacing=0 class=SB_Size>";bC+="		<tr>";bC+="		<td class=SB_Size_Btn onclick='ej(300)' title='"+lang["SizePlus"]+"'>"+ef("SizePlus")+"</td>";bC+="		<td class=SB_Size_Sep></td>";bC+="		<td class=SB_Size_Btn onclick='ej(-300)' title='"+lang["SizeMinus"]+"'>"+ef("SizeMinus")+"</td>";bC+="		<td class=SB_Size_Right></td>";bC+="		</tr>";bC+="		</table>";bC+="	</td>";}bC+="	</tr>";bC+="	</Table>";bC+="</td></tr>";}bC+="</table>";bC+="<div id='eWebEditor_Temp_HTML' style='overflow:hidden;position:absolute;width:1px;height:1px;left:-10000px;' contenteditable='true' eweb_donotdisableselect='true'></div>";bC+="<div style='width:1px;height:1px;position:absolute;left:-10000px;'>";bC+="<textarea type='text' id='D_ContentEdit' value='' spellcheck='false' wrap='off' autocorrect='off' autocapitalize='off' autocomplete='off'></textarea>";bC+="<input type='text' id='D_CurrMode' value=''>";bC+="<textarea type='text' id='D_ContentLoad' value='' spellcheck='false' wrap='off' autocorrect='off' autocapitalize='off' autocomplete='off'></textarea>";bC+="<input type='text' id='D_ContentFlag' value='0'>";bC+="<input type='text' id='D_PaginationTitle' value=''>";bC+="</div>";bC+="<div id=divProcessing style='width:200px;height:30px;position:absolute;left:-10000'>";bC+="<table border=0 cellpadding=0 cellspacing=1 bgcolor='#000000' width='100%' height='100%'><tr><td bgcolor=#3A6EA5><marquee id='msgProcessing' align='middle' behavior='alternate' scrollamount='5' style='font-size:9pt;color:#ffffff'></marquee></td></tr></table>";bC+="</div>";bC+="<div id='div_TableResizeSepV' style='position:absolute;display:none;background-color:transparent;overflow:hidden;' onmousedown='cW.MD2(event)' onmousemove='cW.MM2(event)' onmouseup='cW.MU2(event)'></div>";bC+="<div id='div_TableResizeSepH' style='position:absolute;display:none;background-color:transparent;overflow:hidden;' onmousedown='cW.MD2(event)' onmousemove='cW.MM2(event)' onmouseup='cW.MU2(event)'></div>";bC+='<div id="div_LS" style="position:absolute;left:-10000"></div>';if(!F.EY&& !F.KT){bC+='<div id="ImgResize_Line_L" class="ImgResize_Line" onmousemove="dN.MM2(event)" onmouseup="dN.MU2(event)"></div>'+'<div id="ImgResize_Line_R" class="ImgResize_Line" onmousemove="dN.MM2(event)" onmouseup="dN.MU2(event)"></div>'+'<div id="ImgResize_Line_T" class="ImgResize_Line" onmousemove="dN.MM2(event)" onmouseup="dN.MU2(event)"></div>'+'<div id="ImgResize_Line_B" class="ImgResize_Line" onmousemove="dN.MM2(event)" onmouseup="dN.MU2(event)"></div>'+'<div id="ImgResize_C_LT" class="ImgResize_C" onmousedown="dN.MD2(event)" onmousemove="dN.MM2(event)" onmouseup="dN.MU2(event)"></div>'+'<div id="ImgResize_C_LM" class="ImgResize_C" onmousedown="dN.MD2(event)" onmousemove="dN.MM2(event)" onmouseup="dN.MU2(event)"></div>'+'<div id="ImgResize_C_LB" class="ImgResize_C" onmousedown="dN.MD2(event)" onmousemove="dN.MM2(event)" onmouseup="dN.MU2(event)"></div>'+'<div id="ImgResize_C_CT" class="ImgResize_C" onmousedown="dN.MD2(event)" onmousemove="dN.MM2(event)" onmouseup="dN.MU2(event)"></div>'+'<div id="ImgResize_C_CB" class="ImgResize_C" onmousedown="dN.MD2(event)" onmousemove="dN.MM2(event)" onmouseup="dN.MU2(event)"></div>'+'<div id="ImgResize_C_RT" class="ImgResize_C" onmousedown="dN.MD2(event)" onmousemove="dN.MM2(event)" onmouseup="dN.MU2(event)"></div>'+'<div id="ImgResize_C_RM" class="ImgResize_C" onmousedown="dN.MD2(event)" onmousemove="dN.MM2(event)" onmouseup="dN.MU2(event)"></div>'+'<div id="ImgResize_C_RB" class="ImgResize_C" onmousedown="dN.MD2(event)" onmousemove="dN.MM2(event)" onmouseup="dN.MU2(event)"></div>';}return bC;};function qy(qH,sB){var Cw=false;var aI="<table border='0' cellpadding='0' cellspacing='0' width='100%' id='eWebEditor_Toolbar_"+sB+"' unselectable='on'>";for(var i=0;i<qH.length;i++){aI+="<tr id='eWebEditor_Toolbar_"+sB+"_TR"+i+"' class='tbrow' style='display:"+(Cw?"none":"")+"'><td class='TB_Left'></td><td class='TB_Center'><table border='0' cellpadding='0' cellspacing='0'><tr>";var tb=qH[i];for(var j=0;j<tb.length;j++){var aM=tb[j];if(aM=="ExpandToolbar"){if(!Cw){ci.CO(i+1);Cw=true;}}var di=Buttons[aM];if(!di){alert("Invalid Button: "+aM);break;}var hL=di[1]?di[1]:"exec('"+aM+"')";if(aM=="TBSep"){aI+="<td class='TB_Btn_Padding'><div class='TB_Sep'></div></td>";}else if(di[3]==0){aI+="<td class='TB_Btn_Padding'><div class='TB_Btn' name='TB_Name_"+aM+"' title=\""+lang[aM]+"\" onclick=\""+hL+"\">";if(typeof(di[0])=="number"){var cA="skin/"+config.Skin+"/buttons.gif?v="+EWEB.V;var dM=16-di[0]*16;if(F.as&&(!F.nb)&&(!F.GD)){aI+="<div class='TB_Btn_Image'><img src='"+cA+"' style='top:"+dM+"px' /></div>";}else{aI+="<img class='TB_Btn_Image' src='sysimage/space.gif' style='background-position: 0px "+dM+"px;background-image: url("+cA+");' />";}}else{var cA="skin/"+config.Skin+"/"+di[0];aI+="<img class='TB_Btn_Image' src='"+cA+"'>";}aI+="</div></td>";}else if(di[3]==1){var aZ="";var bW="";switch(aM){case "FontName":aZ=" style='width:115px'";for(var k=0;k<lang[aM+"Item"].length;k++){bW+="<option value='"+lang[aM+"Item"][k]+"'>"+lang[aM+"Item"][k]+"</option>";}break;case "FontSize":aZ=" style='width:55px'";for(var k=0;k<lang[aM+"Item"].length;k++){bW+="<option value='"+lang[aM+"Item"][k][0]+"'>"+lang[aM+"Item"][k][1]+"</option>";}break;case "FormatBlock":aZ=" style='width:90px'";for(var k=0;k<lang[aM+"Item"].length;k++){bW+="<option value='"+lang[aM+"Item"][k][0]+"'>"+lang[aM+"Item"][k][1]+"</option>";}break;case "ZoomSelect":aZ=" style='width:55px'";for(var k=0;k<cY.Options.length;k++){bW+="<option value='"+cY.Options[k]+"'>"+cY.Options[k]+"%</option>";}break;}aI+="<td class='TB_Btn_Padding'><select name='TB_Name_"+aM+"' onchange=\""+hL+"\" size=1 "+aZ+"><option selected>"+lang[aM]+"</option>"+bW+"</select></td>";}}aI+="</tr></table></td><td class='TB_Right'></td></tr>";}aI+="</table>";if(qH.length==0){aI="";}return aI;};function vL(an){var a=new Array();var b=false;a.push("TBHandle");if(config.TB2Code=="1"){a.push("ModeCode");b=true;}if(config.TB2Edit=="1"){a.push("ModeEdit");b=true;}if(config.TB2Text=="1"){a.push("ModeText");b=true;}if(config.TB2View=="1"){a.push("ModeView");b=true;}if(an=="Text"){if(b){a.push("TBSep");}a.push("FindReplace");b=true;}if(config.TB2Max=="1"){if(b){a.push("TBSep");}a.push("Maximize");}return[a];};function ef(aM,rg){var HY=Buttons[aM];var dM=16-HY[0]*16;var cA="skin/"+config.Skin+"/buttons.gif?v="+EWEB.V;if(F.as){return "<div><img src='"+cA+"' style='top:"+dM+"px'></div>";}else{return "<img class='SB_Btn_Image' src='sysimage/space.gif' style='background-position: 0px "+dM+"px;background-image: url("+cA+");' />";}};var dp=new Object();dp.fv=function(){if(config.PaginationMode=="0"){return false;}EWEB.Focus();var el;if(C.ai()=="Control"){el=C.ax();}else{el=C.cI();}el=this.oS(el);if(!el){insertHTML("</P><P id=eWebEditor_Temp_P>");var p=EWEB.T.getElementById("eWebEditor_Temp_P");p.removeAttribute("id");this.ez(p,"beforeBegin");}else{this.ez(el,"afterEnd");}Et();};dp.ez=function(el,kH){var oI=false;if(kH=="afterEnd"&&(!el.nextSibling)){oI=true;}var aU=EWEB.T.createElement("img");aU.className="ewebeditor__pagination";aU.setAttribute("_ewebeditor_fake_tag","pagination");aU.setAttribute("src",EWEB.cd+"/sysimage/space.gif");if(F.as){el.insertAdjacentElement(kH,aU);}else{if(kH=="beforeBegin"){el.parentNode.insertBefore(aU,el);}else{el.parentNode.insertBefore(aU,el.nextSibling);}}if(oI){var p=EWEB.T.createElement("p");el.parentElement.appendChild(p);}};dp.oS=function(el){if(el.tagName=="HTML"){return null;}var te=null;while(el.tagName.toUpperCase()!="BODY"){te=el;el=el.parentNode;if(!el|| !el.tagName){break;}}return te;};dp.Auto=function(qC){if(config.PaginationMode=="0"){return false;}this.Empty();var lh=parseInt(qC);if(lh<1){return false;}if(getCount(2)<=lh){return false;}if(EWEB.ae!="EDIT"){setMode("EDIT");}var dK=R.Lq();var de=dK.childNodes;var l=0;for(var i=0;i<de.length;i++){var bz=de[i];if(bz.nodeType==1){var s=bz.innerText||bz.textContent;if(s){l+=s.length;}}else if(bz.nodeType==3){l+=bz.length;}if(l>=lh){if(bz.nextSibling){if(bz.nodeType==1){this.ez(bz,"afterEnd");}else{this.ez(bz.nextSibling,"beforeBegin");}l=0;}}}};dp.Empty=function(){if(config.PaginationMode=="0"){return;}var K=EWEB.T.getElementsByTagName("IMG");for(var i=K.length-1;i>=0;i--){var el=K[i];var cb=el.getAttribute("_ewebeditor_fake_tag",2);if(cb){if(cb.toLowerCase()=="pagination"){R.cE(el);}}}};dp.wj=function(){if(config.PaginationMode=="0"){return false;}var K=EWEB.T.getElementsByTagName("IMG");for(var i=K.length-1;i>=0;i--){var el=K[i];var cb=el.getAttribute("_ewebeditor_fake_tag",2);if(cb){if(cb.toLowerCase()=="pagination"){var te=this.oS(el);if(te){var b=false;if(te.tagName=="DIV"||te.tagName=="P"){var s=te.innerText||te.textContent;s=s.trim();if(!s){b=true;this.ez(te,"beforeBegin");R.cE(te);}}if(!b){this.ez(te,"afterEnd");R.cE(el);}}}}}};var aE=new Object();aE.jY=function(NY){NY=this.rZ(NY);NY=this.ob(NY,'script',/<script[\s\S]*?<\/script>/gi);NY=this.ob(NY,'noscript',/<noscript[\s\S]*?<\/noscript>/gi);NY=this.LZ(NY);NY=this.KK(NY);NY=this.sI(NY);NY=this.uU(NY);NY=this.gS(NY,"img");NY=this.sX(NY);NY=this.DJ(NY,"img","src");NY=this.DJ(NY,"a","href");NY=this.DJ(NY,"area","href");NY=this.DJ(NY,"a","name");NY=this.Gk(NY);NY=this.MF(NY);return NY;};aE.wV=function(NY){NY=this.EH(NY);NY=this.yr(NY);NY=this.Uc(NY);NY=this.rG(NY);NY=this.sQ(NY);NY=this.gS(NY,"img");NY=this.ER(NY);NY=this.vb(NY);NY=this.sG(NY);NY=this.Fw(NY);return NY;};aE.wv=function(){var el=C.ax();return el.getAttribute("_ewebeditor_fake_tag",2);};aE.MF=function(NY){var gm=function(m,m1,m2){return m1+":"+(parseInt(m2)/100);};return NY.replace(/(<\w\s[^>]*?style\s*?=\s*?[\'\"][^>]*?line-height)\s*?:\s*?(\d[\d\.]*?)%/gi,gm);};aE.yr=function(NY){NY=NY.replace(/\u2002/gi,"&ensp;");NY=NY.replace(/\u2003/gi,"&emsp;");NY=NY.replace(/\u2009/gi,"&thinsp;");NY=NY.replace(/\u200c/gi,"&zwnj;");NY=NY.replace(/\u200d/gi,"&zwj;");return NY;};aE.Uc=function(NY){var gm=function(m,m1,m2,m3){var v=m2.replace(/\"/gi,"&quot;");return m1+v+m3;};NY=NY.replace(/(<textarea\b[^>]*?>)([\s\S]*?)(<\/textarea>)/gi,gm);return NY;};aE.EH=function(NY){var aI=NY.replace(/<(span|font|strong|b|i|u|strike)\b[^>]*?><\/\1>/gi,"");if(aI!=NY){return this.EH(aI);}else{return aI;}};aE.Fw=function(NY){var aI=NY;var sO=new Array();var uI=function(s){var fa='__ewebeditor__sepstr__';while(true){fa=fa+'a';var re=new RegExp(fa+'[0-9]+','gi');if(!re.test(s)){break;}}return fa;};var El=uI(NY);var gm=function(m){sO.push(m);return El+(sO.length-1);};while(true){var kU=aI.replace(/<(ul|ol|dl)(?=[\s>])[^>]*>((?!<\/?(ul|ol|dl)>)[\s\S])*<\/\1>/gi,gm);if(kU==aI){break;}else{aI=kU;}}var gC=function(m,m1){return m.replace(/[ \t\n\r]*$/g,'')+'</'+m1+'>';};for(var i=0;i<sO.length;i++){sO[i]=sO[i].replace(/<(li|dd|dt)(?=[\s>])[^>]*>((?!<\/?(li|dd|dt)[\s>])[\s\S])*(?=<(li|dd|dt|\/ul|\/ol|\/dl)[\s>])/gi,gC)}for(var i=sO.length-1;i>=0;i--){aI=aI.replace(El+i,sO[i]);}return aI;};aE.ob=function(NY,aH,um){function _Replace(m){return aE.ct(aH,m);};return NY.replace(um,_Replace);};aE.vb=function(NY){function _Replace(m,aH){function gm(m,bv){if(['flash','flv','mediaplayer6','mediaplayer7','realplayer','quicktime','vlc','video','audio','unknownobject'].indexOf(aH)>=0){var ak=aE.pr(m,'img');if(ak!=''){ak=' style='+ak;}var eh=(aE.mA(m,'img','width')=='')?aE.co(m,'img','width'):'';var ff=(aE.mA(m,'img','height')=='')?aE.co(m,'img','height'):'';var fQ=aE.co(m,'img','align');var jB=aE.co(m,'img','vspace');var gq=aE.co(m,'img','hspace');var eu=decodeURIComponent(bv);eu=aE.ov(eu,"object",ak);eu=aE.ov(eu,"embed",ak);eu=aE.ov(eu,"video",ak);eu=aE.ov(eu,"audio",ak);eu=aE.sv(eu,["object","embed","video","audio"],[["width",eh],["height",ff],["align",fQ],["vspace",jB],["hspace",gq]]);return eu;}else{return decodeURIComponent(bv);}};return m.replace(/<img [^>]*?_ewebeditor_fake_value=\"([^\">]+?)\"[^>]*?>/gi,gm);};return NY.replace(/<img [^>]*?_ewebeditor_fake_tag=\"(\w+?)\"[^>]*?>/gi,_Replace);};aE.rZ=function(NY){if(config.PaginationMode=="0"){return NY;}var aI='';var fg='';var cA=aE.ct('pagination',"");if(config.PaginationMode=="1"){aI="";var re=/<!--ewebeditor:page title=\"([^\">]*)\"-->((?:[^a]|a)+?)<!--\/ewebeditor:page-->/gi;var m;var ir=0;while((m=re.exec(NY))!=null){ir++;fg+=uf(m[1])+"\n";if(aI!=""){aI+=cA;}aI+=m[2];}if(ir==0){aI=NY;}}else{var re=new RegExp(config.PaginationKey.replace(/([\[\]\{\}\.\(\)\*\+\?])/gi,"\\$1"),'gi');aI=NY.replace(re,cA);}$("D_PaginationTitle").value=fg;return aI;};aE.rG=function(NY){if(config.PaginationMode=="0"){return NY;}var aI=NY;var a=NY.split(/<img [^>]*?_ewebeditor_fake_tag=\"pagination\"[^>]*?>/gi);if(a.length>1){if(config.PaginationMode=="1"){aI="";var iv=$("D_PaginationTitle").value.split("\n");for(var i=0;i<a.length;i++){var fg="";if(iv[i]){fg=FM(iv[i]);}aI+="<!--ewebeditor:page title=\""+fg+"\"-->\r\n";aI+=a[i]+"\r\n";aI+="<!--/ewebeditor:page-->\r\n\r\n";}}else{aI=a[0];for(var i=1;i<a.length;i++){aI+="\r\n"+config.PaginationKey+"\r\n"+a[i];}}}return aI;};aE.sI=function(NY){function _Replace(m){var dG=m.replace(/<object [^>]*?classid\s*=\s*[\'\"]?clsid\s*:\s*([a-z0-9\-]+)[\'\"]?[^>]*?>[\s\S]*/gi,'$1');dG=dG.toUpperCase();if(dG=='D27CDB6E-AE6D-11CF-96B8-444553540000'){if(/plugin\/flvplayer\.swf/.test(m)){return aE.ct('flv',m,'object');}else{return aE.ct('flash',m,'object');}}else if(dG=='22D6F312-B0F6-11D0-94AB-0080C74C7E95'){return aE.ct('mediaplayer6',m,'object');}else if(dG=='6BF52A52-394A-11D3-B153-00C04F79FAA6'){return aE.ct('mediaplayer7',m,'object');}else if(dG=='CFCDAA03-8BE4-11CF-B84B-0020AFBBCCFA'){return aE.ct('realplayer',m,'object');}else if(dG=='02BF25D5-8C17-4B23-BC80-D3488ABDDC6B'){return aE.ct('quicktime',m,'object');}else if(dG=='9BE31822-FDAD-461B-AD51-BE1D1C159921'){return aE.ct('vlc',m,'object');}else if(dG=='0002E510-0000-0000-C000-000000000046'||dG=='0002E551-0000-0000-C000-000000000046'||dG=='0002E559-0000-0000-C000-000000000046'){return m;}else{return aE.ct('unknownobject',m,'object');}};return NY.replace(/<object[\s\S]*?<\/object>/gi,_Replace);};aE.uU=function(NY){function _Replace(m){var cT=m.replace(/<embed [^>]*?type\s*=\s*[\'\"]?([^\'\"\s]+)[\'\"]?[^>]*?>[\s\S]*/gi,'$1');cT=cT.toLowerCase();if(cT=='application/x-shockwave-flash'){return aE.ct('flash',m,'embed');}else if(['application/x-mplayer2','video/x-ms-asf','video/x-msvideo','video/mpeg','audio/mid','audio/mpeg','audio/wav','video/x-ms-wm','audio/x-ms-wma','video/x-ms-wmv','video/x-ms-wmp','video/x-ms-wmx'].indexOf(cT)>=0){return aE.ct('mediaplayer6',m,'embed');}else if(cT=='video/quicktime'){return aE.ct('quicktime',m,'embed');}else if(['audio/x-pn-realaudio','audio/x-pn-realaudio-plugin','application/vnd.rn-realmedia'].indexOf(cT)>=0){return aE.ct('realplayer',m,'embed');}else if(['application/x-vlc-plugin'].indexOf(cT)>=0){return aE.ct('vlc',m,'embed');}else{return aE.ct('unknownobject',m,'embed');}};return NY.replace(/<embed[\s\S]*?<\/embed>/gi,_Replace);};aE.LZ=function(NY){function _Replace(m){return aE.ct('video',m,'video');};return NY.replace(/<video[\s\S]*?<\/video>/gi,_Replace);};aE.KK=function(NY){function _Replace(m){return aE.ct('audio',m,'audio');};return NY.replace(/<audio[\s\S]*?<\/audio>/gi,_Replace);};aE.ct=function(aH,bv,eJ){if(eJ){var ak=aE.pr(bv,eJ);var eh=aE.co(bv,eJ,'width');var ff=aE.co(bv,eJ,'height');var fQ=aE.co(bv,eJ,'align');var jB=aE.co(bv,eJ,'vspace');var gq=aE.co(bv,eJ,'hspace');if(ak!=''){ak=' style='+ak;}var NY='<img src="'+EWEB.cd+'/sysimage/space.gif" class="ewebeditor__'+aH+'" _ewebeditor_fake_tag="'+aH+'" _ewebeditor_fake_value="'+encodeURIComponent(bv)+'"'+ak;if(eh!=''){NY+=' width="'+eh+'"';}if(ff!=''){NY+=' height="'+ff+'"';}if(fQ!=''){NY+=' align="'+fQ+'"';}if(jB!=''){NY+=' vspace="'+jB+'"';}if(gq!=''){NY+=' hspace="'+gq+'"';}NY+='>';return NY;}else{return '<img src="'+EWEB.cd+'/sysimage/space.gif" class="ewebeditor__'+aH+'" _ewebeditor_fake_tag="'+aH+'" _ewebeditor_fake_value="'+encodeURIComponent(bv)+'">';}};aE.pr=function(NY,aH){var re=new RegExp('^[\\s\\S]*?<'+aH+'(?=[\\s>])[^>]*?\\sstyle\\s*?=\\s*?(\'[^\'>]+?\'|\"[^\">]+?\")[^>]*?>[\\s\\S]*$','gi');if(re.test(NY)){return NY.replace(re,'$1');}else{return '';}};aE.mA=function(NY,aH,bL){var re=new RegExp('^[\\s\\S]*?<'+aH+'(?=[\\s>])[^>]*?\\sstyle\\s*?=\\s*?([\'\"])[^>]*?\\b'+bL+'\\s*?:\\s*?(\\w+)(?=[\\s\;\'\"])[^>]*?\\1[^>]*?>[\\s\\S]*$','gi');if(re.test(NY)){return NY.replace(re,'$2');}else{return '';}};aE.co=function(NY,aH,bL){var re=new RegExp('^[\\s\\S]*?<'+aH+'(?=[\\s>])[^>]*?\\s'+bL+'\\s*?=\\s*?([\'\"]?)(\\w+)\\1[^>]*?>[\\s\\S]*$','gi');if(re.test(NY)){return NY.replace(re,'$2');}else{return '';}};aE.ov=function(NY,aH,ak){function _Replace(m){var r=/\sstyle\s*?=\s*?([\'\"])[^>]*?\1/gi;if(r.test(m)){ak=ak.replace('$','\\$');return m.replace(r,ak);}else{return m.substring(0,m.length-1)+ak+'>';}};var re=new RegExp('<'+aH+'(?=[\\s>])[^>]*?>','gi');return NY.replace(re,_Replace);};aE.sv=function(NY,eE,gc){for(var i=0;i<eE.length;i++){NY=this.ti(NY,eE[i],gc);}return NY;};aE.ti=function(NY,aH,gc){function _Replace(m){var bL,fO;for(var i=0;i<gc.length;i++){bL=gc[i][0];fO=gc[i][1];var s='';if(fO!=''){s=' '+bL+'="'+fO+'"';}var r=new RegExp('\\s'+bL+'\\s*?=\\s*?([\'\"]?)\\w+\\1','gi');if(r.test(m)){m=m.replace(r,s);}else{if(fO!=''){m=m.substring(0,m.length-1)+s+'>';}}}return m;};var re=new RegExp('<'+aH+'[^>]*?>','gi');return NY.replace(re,_Replace);};aE.sX=function(NY){function _Replace(m){function gC(m,bL){return ' _ewebeditor_pe_'+bL+'="'+encodeURIComponent(m)+'"';};return m.replace(/\s(on\w+)\s*=\s*?(\'|\")([\s\S]*?)\2/gi,gC);};return NY.replace(/<[^\>]+ on\w+\s*=\s*?(\'|\")[\s\S]+?\>/gi,_Replace);};aE.sQ=function(NY){function _Replace(m,m1){return decodeURIComponent(m1);};return NY.replace(/\s_ewebeditor_pe_\w+=\"([^\"]+)\"/gi,_Replace);};aE.gS=function(NY,aH,bL){function _Replace(m,m1,m2){var aF=m2.replace(/</gi,"&lt;");aF=aF.replace(/>/gi,"&gt;");return m1+aF+">";};var fu;if(bL){fu="(?:"+bL+")";}else{fu="[a-zA-Z]+?";}var GG='(<'+aH+'(?=\\s))(([^<>]*?(\"[^\"]*?\"|\'[^\']*?\')[^<>]*?)+?)>';var re=new RegExp(GG,'gi');var aI=NY.replace(re,_Replace);if(aI!=NY){return aE.gS(aI,aH,bL);}else{return aI;}};aE.DJ=function(NY,aH,bL){function _Replace(m,m1,m2,m3,m4,m5){var r=new RegExp('_ewebeditor_pa_'+bL,'gi');if(r.test(m)||/_ewebeditor_fake_/.test(m)){return m;}else{return m1+m2+' _ewebeditor_pa_'+bL+'="'+encodeURIComponent(m4.replace(/\"/gi,"'"))+'"'+m5;}};var re=new RegExp('(<'+aH+'(?=\\s)[^>]*?)(\\s'+bL+'\\s*?=\\s*?([\'\"])([^>]*?)\\3)([\\s\\S]*?>)','gi');return NY.replace(re,_Replace);};aE.ER=function(NY){function _Replace(m,bL,bv){var r=new RegExp('\\s'+bL+'\\s*?=\\s*?([\'\"])[^>]*?\\1','gi');var s=m.replace(r,'');r=new RegExp('\\s'+bL+'\\s*?=[^\\s\'\">]*','gi');s=s.replace(r,'');r=new RegExp('\\s_ewebeditor_pa_'+bL+'\\s*?=\\s*?\"[^\"]*?\"','gi');var Oa=decodeURIComponent(bv);Oa=Oa.replace(/\$/gi,"$$$$");return s.replace(r,' '+bL+'="'+Oa+'"');};var aI="";while(true){aI=NY.replace(/<\w+[^>]*?_ewebeditor_pa_(\w+)\s*?=\s*?\"([^\">]*?)\"[^>]*>/gi,_Replace);if(aI!=NY){NY=aI;}else{break;}}return aI;};aE.sG=function(NY){NY=NY.replace(/(<\w+(?=\s)[^>]*?)\sclass\s*?=ewebeditor__\w+([^>]*?>)/gi,'$1$2');NY=NY.replace(/(<\w+(?=\s)[^>]*?\sclass\s*?=[^>]*?)(ewebeditor__\w+)([^>]*?>)/gi,'$1$3');NY=NY.replace(/(<\w+(?=\s)[^>]*?)(\sclass\s*?=\s*?\"\s*\")([^>]*>)/gi,'$1$3');NY=NY.replace(/(<\w+(?=\s)[^>]*?\sclass\s*?=\s*?\")\s*([^\"]+?)\s*(\"[^>]*>)/gi,'$1$2$3');return NY;};aE.Gk=function(NY){function DK(DH,rg){var s=DH.replace(/(\sclass=\"[^\"]*?)(\")/gi,'$1 '+rg+'$2');if(s==DH){s=DH.substring(0,DH.length-1)+' class="'+rg+'">';}return s;};function _Replace(m,m1,m2,m3){if(m2.length>0){return DK(m1,"ewebeditor__anchorc")+m2+m3;}else{return DK(m1,"ewebeditor__anchor")+m2+m3;}};var re=new RegExp('(<a\\s[^>]*?ewebeditor_pa_name[^>]*?>)([\\s\\S]*?)(</a>)','gi');return NY.replace(re,_Replace);};aE.CL=function(el,bL){var yV="_ewebeditor_pa_"+bL;var wU=el.attributes[yV];if(wU==null|| !wU.specified){return dE(el,bL);}else{return decodeURIComponent(el.getAttribute(yV,2));}};aE.BK=function(el){var cb=el.getAttribute("_ewebeditor_fake_tag",2);return((cb)?true:false);};var vy={vi:function(NY){var ka=this.tm();if(ka==''){return NY;}var fa=this.uI(NY);var kY=new Array();var qL=/^\<\/(HTML|HEAD|BODY|FORM|TABLE|TBODY|THEAD|TR|UL|OL|DL)[ \>]/i;var qk=/^\<(HTML|HEAD|BODY|FORM|TABLE|TBODY|THEAD|TR|UL|OL|DL)[ \/\>]/i;var pu=new RegExp('^'+ka);var gm=function(m,m1,m2,m3,m4){kY.push(m3);return m1+fa+m4;};var re=/(<(style|script|pre)(?=[\s>])[^>]*?>)([\s\S]*?)(<\/\2>)/gi;NY=NY.replace(re,gm);NY=NY.replace(/\<(P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DL|DT|DD|TITLE|META|LINK|BASE|SCRIPT|LINK|TD|TH|AREA|OPTION)[^\>]*\>/gi,'\n$&');NY=NY.replace(/\<\/(P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DL|DT|DD|TITLE|META|LINK|BASE|SCRIPT|LINK|TD|TH|AREA|OPTION)[^\>]*\>/gi,'$&\n');NY=NY.replace(/\<(BR|HR)[^\>]*\>/gi,'$&\n');NY=NY.replace(/\<\/?(HTML|HEAD|BODY|FORM|TABLE|TBODY|THEAD|TR)[^\>]*\>/gi,'\n$&\n');var nA=NY.split(/[\r\t\f ]*\n+[\r\t\f ]*/g);var hE='';NY='';for(var i=0;i<nA.length;i++){var gY=nA[i];if(gY.length==0){continue;}if(qL.test(gY)){hE=hE.replace(pu,'');}NY+=hE+gY+'\n';if(qk.test(gY)){hE+=ka;}}var gC=function(m,m1,m2){return m1.toLowerCase()+m2;};NY=NY.replace(/(<\/?\w+(?=[\s>]))([^>]*?>)/gi,gC);var BB=function(m,m1,m2,m3){var BH=new Array();var Ca=function(m,m1){BH.push(m);return '"'+fa+'"';};var vM=m2.replace(/([\'\"])[\s\S]*?\1/gi,Ca);var BC=function(m,m1,m2){return ' '+m1.toLowerCase()+'="'+m2+'"';};vM=vM.replace(/\s(\w+)\s*=([^\"\'\s]+)/gi,BC);var hJ=vM.split('"'+fa+'"');vM=hJ[0];for(var i=0;i<BH.length;i++){vM+=BH[i]+hJ[i+1];}return m1+vM+m3;};NY=NY.replace(/(<\w+(?=[\s]))([^>]*?)(>)/gi,BB);var nI=NY.split(fa);NY=nI[0];for(var i=0;i<kY.length;i++){NY+=kY[i]+nI[i+1];}return NY.trim();},uI:function(NY){var fa='__ewebeditor__sepstr__';var i=0;while(true){i=i+1;fa=fa+i;if(NY.indexOf(fa)<0){break;}}return fa;},tm:function(){var n=parseInt(config.CodeFormat);var oB='';for(var i=0;i<n;i++){oB+=' ';}return oB;}};function ej(lW){if(kQ.hM){return;}var bQ=window.frameElement;var cq=bQ.clientHeight;var GL=cq+lW;if(GL>=config.UIMinHeight){bQ.style.height=GL+"px";}else{bQ.style.height=config.UIMinHeight+"px";}};function qG(){var cR=EWEB.T.createElement("div");cR.innerHTML='<span style="margin:0;padding:0;border:0;clear:both;width:1px;height:1px;display:block;">'+(F.xb?'&nbsp;':'')+'</span>';var gi=R.cE(cR.firstChild);var dK=R.Lq();dK.appendChild(gi);var wN=R.hg(EWEB.aR,gi).y;if(!config.FixWidth){wN+=gi.offsetHeight;}R.cE(gi);var vA=R.eF(EWEB.aR).Height;var jR=wN-vA;if(F.jo){jR+=20;}if(Math.abs(jR)<3){return;}var mg=R.mD(document).frameElement;var wK=mg.offsetHeight;var vm=Math.max(wK+jR,parseInt(config.UIMinHeight));mg.height=vm;};function qu(){if(EWEB.ae=="EDIT"){aK('findreplace.htm',true);}else{ec.OpenDialog('findreplacetext.htm',false);}};function tM(){if(!ed()){return;}EWEB.Focus();if(!iY()){alert(lang["MsgNotParagraph"]);return;}aK('paragraph.htm',true);};function iY(){if(C.ai()=="Control"){return false;}if(C.dh(["P","DIV"],true)){return true;}else{return false;}};function tQ(){if(!ed()){return;}var b=false;if(C.ai()=="Control"){var bg=C.ax();if(bg.tagName.toUpperCase()=="IMG"){if(!aE.BK(bg)){b=true;}}}if(!b){alert(lang["MsgMapLimit"]);return;}aK("map.htm",true);};function uB(){if(!ed()){return;}if(C.ai()=="Control"){var bg=C.ax();if(bg.tagName.toUpperCase()!="IMG"){alert(lang["MsgHylnkLimit"]);return;}}aK("hyperlink.htm",true);};function dB(aN){if(!ed()){return;}EWEB.Focus();var bE=getSelectedText();switch(aN){case "nowdate":var d=new Date();insertHTML(d.toLocaleDateString());break;case "nowtime":var d=new Date();insertHTML(d.toLocaleTimeString());break;case "br":insertHTML("<br>");break;case "code":insertHTML('<table width=95% border="0" align="Center" cellpadding="6" cellspacing="0" style="border: 1px Dotted #CCCCCC; TABLE-LAYOUT: fixed"><tr><td bgcolor=#FDFDDF style="WORD-WRAP: break-word"><font style="color: #990000;font-weight:bold">'+lang["HtmlCode"]+'</font><br>'+FM(bE)+'</td></tr></table>');break;case "quote":insertHTML('<table width=95% border="0" align="Center" cellpadding="6" cellspacing="0" style="border: 1px Dotted #CCCCCC; TABLE-LAYOUT: fixed"><tr><td bgcolor=#F3F3F3 style="WORD-WRAP: break-word"><font style="color: #990000;font-weight:bold">'+lang["HtmlQuote"]+'</font><br>'+FM(bE)+'</td></tr></table>');break;case "big":insertHTML("<big>"+bE+"</big>");break;case "small":insertHTML("<small>"+bE+"</small>");break;case "printbreak":insertHTML("<div style=\"FONT-SIZE: 1px; PAGE-BREAK-BEFORE: always; VERTICAL-ALIGN: middle; HEIGHT: 1px; BACKGROUND-COLOR: #c0c0c0\">&nbsp; </div>");break;default:alert(lang["ErrParam"]);break;}};var cY={Options:[10,25,50,75,100,150,200,500],qr:100,Execute:function(kX){if(F.as){EWEB.T.body.runtimeStyle.zoom=kX+"%";}else{EWEB.T.body.style.transformOrigin='0 0';EWEB.T.body.style.transform='scale('+(kX/100)+')';}this.qr=kX;}};function uD(){if(C.ai()!="Control"){return;}if(F.as){var fA=EWEB.T.selection.createRange();for(var i=0;i<fA.length;i++){var bg=fA.item(i);if(bg.style.position!='relative'){bg.style.position='relative';}else{bg.style.position='static';}}}else{var bg=C.ax();if(bg.style.position!='relative'){bg.style.position='relative';}else{bg.style.position='static';}}Et();};function pe(an){if(C.ai()!="Control"){return;}if(F.as){var fA=EWEB.T.selection.createRange();for(var i=0;i<fA.length;i++){var bg=fA.item(i);if(an=='forward'){bg.style.zIndex+=1;}else{bg.style.zIndex-=1;}bg.style.position='relative';}}else{var bg=C.ax();if(an=='forward'){bg.style.zIndex+=1;}else{bg.style.zIndex-=1;}bg.style.position='relative';}Et();};function pl(aV){C.Restore();EWEB.aR.focus();if(C.ai()!="Text"){return;}if(F.as){var bk=EWEB.T.selection;var aD=bk.createRange();var r=EWEB.T.body.createTextRange();var ni=0;while(r.compareEndPoints("StartToStart",aD)<0){r.moveStart("character",1);ni++;}var eQ=0;while(r.compareEndPoints("EndToEnd",aD)>0){r.moveEnd("character",-1);eQ--;}var a=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];var l,u,gr,kK;for(var i=0;i<26;i++){l=a[i];u=a[i].toUpperCase();switch(aV){case "uppercase":gr=l;kK=u;break;case "lowercase":gr=u;kK=l;break;}r=aD.duplicate();while(r.findText(gr,0,4)){r.text=kK;r=aD.duplicate();}}r=EWEB.T.body.createTextRange();r.moveStart("character",ni);r.moveEnd("character",eQ);r.select();}else{nL.og(aV);}Et();};function fq(aN,fN){C.Restore();EWEB.aR.focus();if(C.ai()!="Text"){return;}if(F.as){var r=EWEB.T.selection.createRange();if(r.text==""){var Ds=true;var Dg=r.parentElement();if(Dg.tagName!="BODY"){if(Dg.innerHTML==""){Ds=false;}}if(Ds){var DX=R.Gu(EWEB.T);insertHTML("<span id='"+DX+"'>&nbsp;</span>");Dg=EWEB.T.getElementById(DX);}C.vR(Dg);C.Collapse(false);nD(Dg,aN,fN);if(Ds){Dg.removeAttribute("id");}Dg.innerHTML="";ci.eW();return;}var pi="eWebEditor_Temp_FontName";EWEB.T.execCommand("fontname","",pi);var lm=EWEB.T.body.getElementsByTagName("FONT");var by=new Array();for(var i=0;i<lm.length;i++){var dI=lm[i];if(dI.getAttribute("face")==pi){by[by.length]=lm[i];}}for(var i=0;i<by.length;i++){var dI=by[i];pg(dI,aN);kJ(dI);nD(dI,aN,fN);dI.removeAttribute("face");var bd=dI.parentElement;if(bd.tagName=="FONT"){lG(bd);}if((bd.tagName=="FONT")||(bd.tagName=="SPAN")){if(bd.innerText==dI.innerText){bd.style.cssText=bd.style.cssText+";"+dI.style.cssText;bd.innerHTML=dI.innerHTML;by[i]=bd;continue;}}}var f1,f2;for(var i=0;i<by.length;i++){if(by[i]&&by[i].innerText){if(!f1){f1=by[i];}f2=by[i];}}var r1=EWEB.T.body.createTextRange();r1.moveToElementText(f1);var r2=EWEB.T.body.createTextRange();r2.moveToElementText(f2);r.setEndPoint("StartToStart",r1);r.setEndPoint("EndToEnd",r2);r.select();}else{if(["uppercase","lowercase","size"].indexOf(aN)>=0){nL.og(aN,fN);}else{if(aN=="face"){aN="fontName";}EWEB.T.execCommand(aN,false,fN);}}Et();};function pg(obj,aN){oM(obj,aN,"");var aY=obj.children;for(var j=0;j<aY.length;j++){pg(aY[j],aN);if(aY[j].tagName=="FONT"){lG(aY[j]);}}};function kJ(obj){var aY=obj.children;for(var j=0;j<aY.length;j++){kJ(aY[j]);if((aY[j].tagName=="FONT")||(aY[j].tagName=="SPAN")){if((aY[j].style.cssText==""&&aY[j].className=="")||(aY[j].innerHTML=="")){aY[j].removeNode(false);kJ(obj);return;}}}};function nD(obj,aN,v){oM(obj,aN,v);var aY=obj.children;for(var j=0;j<aY.length;j++){if((aY[j].tagName=="SPAN")||(aY[j].tagName=="FONT")){nD(aY[j],aN,v);}}};function oM(obj,aN,v){try{switch(aN){case "face":obj.style.fontFamily=v;break;case "size":obj.style.fontSize=v;break;case "color":obj.style.color=v;break;default:break;}}catch(e){}};function lG(el){if(el.style.fontFamily==""){var s=el.getAttribute("face");if(s){el.style.fontFamily=s;}}el.removeAttribute("face");if(el.style.fontSize==""){var s=el.getAttribute("size");s=nq(s);if(s){el.style.fontSize=s;}}el.removeAttribute("size");if(el.style.color==""){var s=el.getAttribute("color");if(s){el.style.color=s;}}el.removeAttribute("color");};var nL=(function(){var kb,kL,hd,je;var bi=[];var aB,fp,cL,cO,ft,jU;var Fk,FS;return{og:function(aV,fN){if(C.ai()!="Text"){return;}kL=false;kb=false;bi.length=0;hd=aV;je=fN;ft=(hd=="uppercase"||hd=="lowercase")?true:false;jU=false;Fk=false;FS=false;var bk=EWEB.aR.getSelection();var aD=bk.getRangeAt(0);if(aD.collapsed){if(hd=="size"){var aU=this.ic("&nbsp;",true);aD.insertNode(aU);C.vR(aU.firstChild);return;}else{return;}}aB=aD.startContainer;fp=aD.endContainer;cL=aD.startOffset;cO=aD.endOffset;if(aB.nodeType==1){aB=this.oZ(aB);if(!aB){return;}cL=0;}if(fp.nodeType==1){fp=this.me(fp);if(!fp){return;}cO=fp.nodeValue.length;}if(aB==fp){jU=true;var fm=aB.nodeValue;if(ft){aB.nodeValue=fm.substring(0,cL)+this.jh(fm.substring(cL,cO))+fm.substring(cO);}else{var ao=aB.parentNode;var pm=fm.substring(0,cL);var oi=fm.substring(cL,cO);var qm=fm.substring(cO);if(ao.tagName.toUpperCase()=="SPAN"&&ao.innerHTML==oi){this.hx(ao);}else{var aU=this.ic(oi);aU.setAttribute("id","eWebEditor_Temp_Span_FontSize",0);ao.insertBefore(aU,aB);aB.nodeValue=qm;if(pm){var kO=EWEB.T.createTextNode(pm);ao.insertBefore(kO,aU);}}}}else{this.jG(aD.commonAncestorContainer);}if(ft){aD.setStart(aB,cL);aD.setEnd(fp,cO);}else{if(jU){var ib=EWEB.T.getElementById("eWebEditor_Temp_Span_FontSize");if(ib){ib.removeAttribute("id");aD.selectNodeContents(ib.firstChild);}}else{aD.setStart(aB,cL);aD.setEnd(fp,cO);}}bk.removeAllRanges();bk.addRange(aD);EWEB.Focus();},jG:function(el){if(el==aB){kL=true;}if(kL){if(el==aB){if(ft){el.nodeValue=el.nodeValue.substring(0,cL)+this.jh(el.nodeValue.substring(cL));}else{bi[bi.length]=el;Fk=true;}}else if(el==fp){if(ft){el.nodeValue=this.jh(el.nodeValue.substring(0,cO))+el.nodeValue.substring(cO);}else{bi[bi.length]=el;FS=true;for(var i=0;i<bi.length;i++){if(!bi[i].nodeValue||bi[i].nodeValue=="\n"){continue;}if(i==0){var ao=bi[i].parentNode;if((ao.tagName.toUpperCase()=="SPAN")&&(bi[i].nodeValue.substring(cL)==ao.innerHTML)){this.hx(ao);}else{var v=bi[i].nodeValue.substring(cL);if(v){var aU=this.ic(v);ao.insertBefore(aU,bi[i].nextSibling);bi[i].nodeValue=bi[i].nodeValue.substring(0,cL);if(Fk){aB=aU.childNodes[0];cL=0;}}}}else if(i==bi.length-1){var ao=bi[i].parentNode;if((ao.tagName.toUpperCase()=="SPAN")&&(bi[i].nodeValue.substring(0,cO)==ao.innerHTML)){this.hx(ao);}else{var v=bi[i].nodeValue.substring(0,cO);if(v){var aU=this.ic(v);ao.insertBefore(aU,bi[i]);if(FS){fp=aU.childNodes[0];}bi[i].nodeValue=bi[i].nodeValue.substring(cO);}}}else{var ao=bi[i].parentNode;if((ao.tagName.toUpperCase()=="SPAN")&&(bi[i].nodeValue==ao.innerHTML)){this.hx(ao);}else{var aU=this.ic(bi[i].nodeValue);ao.replaceChild(aU,bi[i]);}}}}kb=true;}else if(el.nodeType==3){if(ft){el.nodeValue=this.jh(el.nodeValue);}else{bi[bi.length]=el;}}}if(el.hasChildNodes()){for(var i=0;i<el.childNodes.length;i++){if(kb){return;}this.jG(el.childNodes[i]);}}},jh:function(bM){switch(hd){case "uppercase":return bM.toUpperCase();break;case "lowercase":return bM.toLowerCase();break;case "size":return "<span id=\"eWebEditor_Temp_Span_FontSize\" style=\"font-size:"+je+"\">"+bM+"</span>";break;}},ic:function(bE,pB){var kk=EWEB.T.createElement("span");if(pB){kk.innerHTML=bE;}else{var kO=EWEB.T.createTextNode(bE);kk.appendChild(kO);}this.hx(kk);return kk;},hx:function(el){switch(hd){case "size":el.style.fontSize=je;break;case "face":el.style.fontName=je;break;}},oZ:function(el){if(el.nodeType==3){return el;}if(el.hasChildNodes()){for(var i=0;i<el.childNodes.length;i++){var bz=this.oZ(el.childNodes[i]);if(bz){return bz;}}}return null;},me:function(el){var bz;if(el.nodeType==3){bz=el;}if(el.hasChildNodes()){for(var i=0;i<el.childNodes.length;i++){var mj=this.me(el.childNodes[i]);if(mj){bz=mj;}}}if(bz){return bz;}else{return null;}}};})();var hZ={Execute:function(aN){if(C.ai()=="Control"){var bg=C.ax();if(aN=="justifyfull"){bg.removeAttribute("align");}else{bg.align=aN.substr(7);}var p=R.Mv(bg,["P","DIV","TD","TH"]);var p1,p2;if(p){if(R.KO(["TD","TH"],p.tagName)>=0){p2=p;}else{p1=p;}}else{p2=R.Lq();}if(p2){var c1=R.Mc(bg,p2);var IQ=EWEB.T.createElement("p");c1.parentNode.insertBefore(IQ,c1);IQ.appendChild(c1.parentNode.removeChild(c1));p1=IQ;}if(p1){p1.removeAttribute("align");if(aN=="justifyfull"){p1.style.textAlign="justify";p1.style.textJustify="inter-ideograph";}else{p1.style.textAlign=aN.substr(7);p1.style.textJustify="";}}}else{var a=C.dh(["P","DIV","TD","TH"]);if(a.length>0){for(var i=0;i<a.length;i++){var p=a[i];if(aN=="justifyfull"){p.style.textAlign="justify";p.style.textJustify="inter-ideograph";}else{p.style.textAlign=aN.substr(7);p.style.textJustify="";}p.removeAttribute("align");}}else{EWEB.T.execCommand(aN,false,null);}}EWEB.Focus();ci.eW();Et();}};var kC=new Object();kC.Execute=function(aN){var iu=false;if(F.as){var np=function(){iu=true;};var pY='on'+aN.toLowerCase();EWEB.T.body.attachEvent(pY,np);EWEB.T.execCommand(aN,false,null);EWEB.T.body.detachEvent(pY,np);}else{try{iu=EWEB.T.execCommand(aN,false,null);}catch(e){}}if(!iu){if(config.AutoDetectPaste=="1"){dU.FV(true,function(ML){if(ML){var NY=getSelectedHTML();var bE=getSelectedText();dU.eS({"act":"scbhtml","html":NY,"text":bE},true,"c",function(TC){if(TC["state"]!="ok"){return;}if(aN=="Cut"){exec("delete");}});}else{return;}});}else{alert(lang['MsgSafe'+aN]);}}else{if(aN=="Cut"){Et();}}};var kQ=new Object();kQ.Execute=function(){var bQ=window.frameElement;var kN=parent.document.documentElement;var hm=parent.document.body.style;var bd;if(!this.hM){R.az(parent,'resize',iR);this.oJ=R.gL(parent);this.ug=R.oE(bQ);bd=bQ;while((bd=bd.parentNode)){if(bd.nodeType==1){bd._ewebSavedStyles=R.oE(bd);}}if(F.as){this.ss=kN.style.overflow;kN.style.overflow='hidden';hm.overflow='hidden';}else{kN.style.overflow='hidden';hm.overflow='hidden';hm.width='0px';hm.height='0px';}var hl=R.eF(parent);bQ.style.position="absolute";bQ.offsetLeft;bQ.style.zIndex=9999777;bQ.style.left="0px";bQ.style.top="0px";bQ.style.width=hl.Width+"px";bQ.style.height=hl.Height+"px";bQ.style.boxSizing="content-box";if(!F.as){bQ.style.borderRight=bQ.style.borderBottom="9999px solid white";bQ.style.backgroundColor="white";}parent.scrollTo(0,0);var gz=R.vU(parent,bQ);var Km=BW(R.ce(bQ,"border-left-width"));var Kv=BW(R.ce(bQ,"border-top-width"));var Is= -1*gz.x-Km;var Ib= -1*gz.y-Kv;if(Is!=0){bQ.style.left=Is+"px";}if(Ib!=0){bQ.style.top=Ib+"px";}this.hM=true;}else{R.hf(parent,'resize',iR);bd=bQ;while((bd=bd.parentNode)){if(bd._ewebSavedStyles){R.lO(bd,bd._ewebSavedStyles);bd._ewebSavedStyles=null;}}if(F.as){kN.style.overflow=this.ss;}R.lO(bQ,this.ug);parent.scrollTo(this.oJ.X,this.oJ.Y);this.hM=false;}var HF=$("eWebEditor_SB_Size");if(HF){HF.style.display=this.hM?"none":"";}this.eD();if(EWEB.ae=="EDIT"&& !F.as){EWEB.lo();}EWEB.Focus();};kQ.eD=function(){ci.nT("other","Maximize",this.hM);};function iR(){var hl=R.eF(parent);var bQ=window.frameElement;bQ.style.width=hl.Width+'px';bQ.style.height=hl.Height+'px';};var Ry=(function(){var Qo=false;var TN=function(){if(!HB()){return;}var Mp=config.WordEqVersion;if(Mp==""){alert("Not Installed!");return;}if(Qo){PF();}else{dU.eS({"act":"wordeqinstall","ver":Mp},true,"c",function(HN){if(HN["state"]!="ok"){return;}if(HN["installed"]!="yes"){aK("installwordeq.htm",true);return;}Qo=true;PF();});}};var PF=function(){if(config.weql){LH();}else{var Pp=R.Nl();IG.CT("get",EWEB.Po+"&action=wordeqlicense&r="+Pp,true,null,function(eL){var fM="";if(eL["state"]=="ok"){if(eL["isjson"]&&eL["data"]["lc"]){fM=eL["data"]["lc"];}}else if(eL["state"]=="err"){if(eL["errflag"]=="xhrstatus"){alert(eL["xhrstatus"]);return;}}if(!fM){alert(lang["ErrLicenseWordEQ"]);return;}dU.eS({"act":"wordeqlc","lc":fM,"rnd":Pp},true,"c",function(IY){if(IY["l"]){config.weql=IY["l"];}else{alert(lang["ErrLicenseWordEQ"]);return;}LH();});});}};var LH=function(){var Iz="dB";var LP="";var LX="";var qA=9;var IE=11;var iZ="";var bn="";if(C.ai()=="Control"){var bg=C.ax();if(bg.tagName=="IMG"&&bg.getAttribute("_tag",2)=="wordeq"){Iz="edit";LP=bg.getAttribute("_eqcode",2);if(!LP){LP=""}LX=bg.getAttribute("_eqtype",2);if(!LX){LX=""}}else{iZ=R.ce(bg.parentNode,"font-size");var kU=nq(iZ);if(kU){iZ=kU;}}}else{var iZ=C.BA();}if(Iz=="dB"){iZ=iZ.toLowerCase();var lW=parseFloat(iZ);if(isNaN(lW)){bn=IE+"";}else{if(iZ.indexOf("px")>0){lW=lW*3/4;}lW=parseInt(lW+0.5);if(lW<qA){lW=qA;}bn=lW+"";}}var bu="width:880;height:500;action:"+Iz+";pointsize:"+bn+";eqtype:"+LX+";ver:"+config.WordEqVersion+";";dU.eS({"act":"wordeqshow","opt":bu,"eqcode":LP},true,"c",function(cC){if(cC["state"]!="ok"){return;}var yQ=cC["html"];eG.xO(yQ,{"cs":"c","sy":""},function(eC){dU.eS({"act":"cache","acttype":"wordeqshow","actkey":cC["actkey"]},false,"c");var NY=eC["html"];insertHTML(NY);sk({flag:"wordeq"});});});};return{KE:function(){TN();}}})();function ue(){if(!HB()){return;}dU.eS({"act":"capture"},true,"c",function(Qn){if(Qn["state"]=="ok"){var jn=Qn["image"];var En=R.GQ(jn,"png","x.png");eG.oR(En,{"filetype":"image","sy":""},function(iw){if(iw["state"]=="ok"){var NY="<img src=\""+iw["url"]+"\" style=\"max-width:100%\">";insertHTML(NY);sk({flag:"capture"});}});}});};function oX(){if(config.AutoDetectPaste=="2"||config.AutoDetectPaste=="3"){window.setTimeout("ix()",10);return;}if(config.AutoDetectPaste=="1"){dU.eS({"act":"gcbformat"},true,"c",function(iX){if(iX["state"]!="ok"){return;}if(iX["html"]&&((iX["source"]=="word")||(iX["source"]=="wps"))){kF(iX);return;}else if(iX["html"]&&((iX["source"]=="excel")||(iX["source"]=="et"))){uH(iX);return;}else{var n=0;if(iX["filelist"]){n++;}if(iX["html"]){n++;}if(iX["image"]){n++;}if(iX["text"]){n++;}if(n>1){tG(iX);return;}else if(iX["filelist"]){Qd();}else if(iX["html"]){Ox();}else if(iX["image"]){PG();}else if(iX["text"]){ix();}}});}else{if(F.EY){mB();}else{aK("pastegecko.htm");}}};function Qd(JY){var lM=false;var fX="";if(JY){if(JY["sy"]!=undefined){fX=(JY["sy"])?"1":"";}if(JY["sethtml"]!=undefined){lM=JY["sethtml"];}}dU.eS({"act":"gcbfilelist"},true,"c",function(TG){if(TG["state"]!="ok"){return;}var PE=TG["filelist"];var GC=PE.split("|");eG.RY(GC,{"filetype":"image","cs":"c","sy":fX},function(eY){var NY="";for(var i=0;i<eY.length;i++){if(eY[i]["state"]=="ok"){if(NY!=""){NY+="<br><br>";}var aG=eY[i]["url"];var GZ=eY[i]["slt"];if(GZ){NY+='<a href="'+aG+'" target="_blank"><img src="'+GZ+'" style="max-width:100%"></a>';}else{NY+='<img src="'+aG+'" style="max-width:100%">';}}}Bs(NY,lM);});});};function PG(JY){var lM=false;var fX="";if(JY){if(JY["sy"]!=undefined){fX=(JY["sy"])?"1":"";}if(JY["sethtml"]!=undefined){lM=JY["sethtml"];}}dU.eS({"act":"gcbimage"},true,"c",function(Tq){if(Tq["state"]!="ok"){return;}var jn=Tq["image"];if(!jn){return;}var En=R.GQ(jn,"png","x.png");eG.oR(En,{"filetype":"image","sy":fX},function(iw){if(iw["state"]=="ok"){var aG=iw["url"];var GZ=iw["slt"];var NY;if(GZ){NY='<a href="'+aG+'" target="_blank"><img src="'+GZ+'" style="max-width:100%"></a>';}else{NY='<img src="'+aG+'" style="max-width:100%">';}Bs(NY,lM);sk({flag:"Paste",type:"image"});}});});};function Ox(JY){var Oy=true;var MN=true;var fX="";var lM=false;if(JY){if(JY["local"]!=undefined){Oy=JY["local"];}if(JY["remote"]!=undefined){MN=JY["remote"];}if(JY["sy"]!=undefined){fX=(JY["sy"])?"1":"";}if(JY["sethtml"]!=undefined){lM=JY["sethtml"];}}dU.eS({"act":"gcbhtml"},true,"c",function(SA){if(SA["state"]!="ok"){return;}var NY=SA["html"];NY=NY.replace(/<script\b[^>]*?>[\s\S]*?<\/script>/gi,"");NY=NY.replace(/^[\s\S]*?(<html\b[^>]*?>[\s\S]*<\/html>)[\s\S]*?$/gi,"$1");NY=NY.replace(/^[\s\S]*?(<body\b[^>]*?>[\s\S]*<\/body>)[\s\S]*?$/gi,"$1");NY=NY.replace(/<!--StartFragment\s*?-->/gi,"");NY=NY.replace(/<!--EndFragment-->/gi,"");NY=NY.replace(/(<img\b[^>]*?)\scrossorigin\s*?=\s*?\"anonymous\"([^>]*?>)/gi,"$1$2");if(Oy){eG.xO(NY,{"cs":"c","sy":fX},function(eC){var Pa=eC["html"];if(MN){eG.Qe(Pa,{"sy":fX},function(MI){var NR=MI["html"];Bs(NR,lM);});}else{Bs(Pa,lM);}});}else{if(MN){eG.Qe(NY,{"sy":fX},function(MI){var NR=MI["html"];Bs(NR,lM);});}else{Bs(NY,lM);}}});};function Bs(NY,lM){if(lM){setHTML(NY);}else{insertHTML(NY);}};function mB(){var NY=sD();insertHTML(NY);sk({flag:"Paste",type:"html"});};function tG(iX){var aG="pasteoption.htm?x=1";if(iX["text"]){aG+="&text=1";}if(iX["html"]){aG+="&html=1";}if(iX["image"]){aG+="&image=1";}if(iX["filelist"]){aG+="&filelist=1";}if(config.AutoDonePasteOption){aK(aG+"&autodone=1",true,false,true);}else{aK(aG,true);}};function kF(iX){var aG="importword.htm?action=paste";if(iX&&iX["image"]){aG+="&image=1";}if(config.AutoDonePasteWord){aK(aG+"&autodone=1",true,false,true);}else{aK(aG,true);}};function uH(){if(config.AutoDonePasteExcel){aK("importexcel.htm?action=paste&autodone=1",true,false,true);}else{aK("importexcel.htm?action=paste",true);}};function ix(JY){var lM=false;if(JY){if(JY["sethtml"]!=undefined){lM=JY["sethtml"];}}if(F.EY){var fh=FM(clipboardData.getData("Text"));Bs(fh,lM);sk({flag:"Paste",type:"text"});}else{if(config.AutoDetectPaste=="1"||config.AutoDetectPaste=="2"){dU.eS({"act":"gcbtext"},true,"c",function(hT){if(hT["state"]!="ok"){return;}var fh=FM(hT["text"]);Bs(fh,lM);sk({flag:"Paste",type:"text"});});}else{aK("pastegecko.htm?action=text");}}};function sD(){var cR=$("eWebEditor_Temp_HTML");cR.innerHTML="";cR.focus();document.execCommand("Paste",false,null);var NY=cR.innerHTML;cR.innerHTML="";return NY;};var kh={Execute:function(){this.gN();this.cV= !this.cV;this.eD();},jJ:function(){this.gN();if(this.cV){this.eD();}},gN:function(){if(typeof(this.cV)=="undefined"){this.cV=(config.ShowBorder=="0")?false:true;}},eD:function(){var K=EWEB.T.getElementsByTagName("TABLE");for(var i=0;i<K.length;i++){var el=K[i];if(this.cV){el.className+=' ewebeditor__showtableborders';}else{el.className=el.className.replace(/(^| )ewebeditor__showtableborders/gi,'');}}ci.nT("other","ShowBorders",this.cV);}};var jK={Execute:function(){this.gN();this.cV= !this.cV;this.eD();},jJ:function(){this.gN();if(this.cV){this.eD();}},gN:function(){if(typeof(this.cV)=="undefined"){this.cV=(config.ShowBlock=="1")?true:false;}},eD:function(){var dK=EWEB.T.body;if(this.cV){dK.className+=' ewebeditor__showblocks';}else{dK.className=dK.className.replace(/(^| )ewebeditor__showblocks/gi,'');}ci.nT("other","ShowBlocks",this.cV);}};var vp=(function(){var cV=false;var xe;var yS;var CB;var BG;var CP;var Cj;var BD;var Bb;var nV;var qq;var BV=function(){ci.nT("other","FormatBrush",cV);};var fi=function(aV){var v;switch(aV){case "fontsize":v=C.BA();break;case "bold":case "italic":case "underline":case "strikethrough":case "superscript":case "subscript":v=EWEB.T.queryCommandState(aV);break;case "fontname":v=EWEB.T.queryCommandValue(aV);break;case "forecolor":case "backcolor":if(!F.as&& !F.AM&&aV=="backcolor"){aV="hiliteColor";}v=EWEB.T.queryCommandValue(aV);if(F.as){v=BZ(v);}break;}if(v==null){v="";}return v;};var BZ=function(CG){if(CG==null){return "";}var aQ=CG.toString(16);switch(aQ.length){case 1:aQ="0"+aQ+"0000";break;case 2:aQ=aQ+"0000";break;case 3:aQ=aQ.substring(1,3)+"0"+aQ.substring(0,1)+"00";break;case 4:aQ=aQ.substring(2,4)+aQ.substring(0,2)+"00";break;case 5:aQ=aQ.substring(3,5)+aQ.substring(1,3)+"0"+aQ.substring(0,1);break;case 6:aQ=aQ.substring(4,6)+aQ.substring(2,4)+aQ.substring(0,2);break;default:aQ="";}return '#'+aQ;};var lK=function(BQ,aV){var CJ=fi(aV);if(BQ!=CJ){format(aV);}if(!BQ&& !CJ){format(aV);format(aV);}};return{Es:function(){return cV;},Execute:function(){if(!cV){xe=fi("fontname");yS=fi("fontsize");CB=fi("bold");BG=fi("italic");CP=fi("underline");Cj=fi("strikethrough");BD=fi("superscript");Bb=fi("subscript");nV=fi("forecolor");qq=fi("backcolor");}cV= !cV;BV();},Stop:function(){if(!cV){return;}cV=false;BV();},Di:function(){if(!cV){return;}if(C.ai()!="Text"){return;}var AY;if(F.as){AY=C.bG().createRange().text;}else{AY=C.bG()+"";}if(!AY){return;}if(xe&&xe!=fi("fontname")){fq('face',xe);}lK(CB,"bold");lK(BG,"italic");lK(CP,"underline");lK(Cj,"strikethrough");lK(BD,"superscript");lK(Bb,"subscript");if(nV&&nV!=fi("forecolor")){if(F.as){fq('color',nV);}else{fq('forecolor',nV);}}if(qq&&qq!=fi("backcolor")){if(F.as){format('backcolor',qq);}else{format('hiliteColor',qq);}}if(yS&&yS!=fi("fontsize")){fq('size',yS);}ap.jO();ap.Save();Et();}};})();function Bw(){if(!hH()){return;}aK('imagedoc.htm',true);};function ow(an){if(!HB()){return;}switch(an){case "word":aK('importword.htm',true);break;case "excel":aK('importexcel.htm',true);break;case "ppt":aK('importppt.htm',true);break;case "pdf":aK('importpdf.htm',true);break;}};var eO={fv:function(an){switch(an){case "inputtext":insertHTML('<input type="text">');break;case "textarea":insertHTML('<textarea></textarea>');break;case "radio":insertHTML('<input type="radio">');break;case "checkbox":insertHTML('<input type="checkbox">');break;case "select":insertHTML('<select></select>');break;case "button":insertHTML('<input type="button">');break;}}};function tp(){EWEB.aR.print();};var R=new Object();R.Clone=function(obj){var le;if(obj&&(obj instanceof Array)){le=[];for(var i=0;i<obj.length;i++){le[i]=this.Clone(obj[i]);}return le;}if(obj===null||(typeof(obj)!='object')||(obj instanceof String)||(obj instanceof Number)||(obj instanceof Boolean)||(obj instanceof Date)||(obj instanceof RegExp)){return obj;}le=new obj.constructor();for(var hO in obj){var property=obj[hO];le[hO]=this.Clone(property);}return le;};R.fR=function(J){return("CSS1Compat"==(J.compatMode||(F.ik?"CSS1Compat":null)));};R.hh=function(kG){kG.style.cssText="margin:0;"+"padding:0;"+"border:0;"+"background-color:transparent;"+"background-image:none;";};R.dV=function(kG){return kG.ownerDocument||kG.document;};R.mh=function(kG){return this.mD(this.dV(kG));};R.mD=function(J){return J.parentWindow||J.defaultView;};R.lJ=function(){var jC=window.parent;while(jC.parent&&jC.parent!=jC){try{if(jC.parent.document.domain!=document.domain){break;}if(jC.parent.document.getElementsByTagName("frameset").length>0){break;}}catch(e){break;}jC=jC.parent;}return jC;};R.hg=function(w,node){var x=0;var y=0;var bN=node;var ku=null;var hn=R.mh(bN);while(bN&& !(hn==w&&(bN==w.document.body||bN==w.document.documentElement))){var obj_Scroll=bN;if(bN.tagName=="BODY"){if(bN.ownerDocument.compatMode!="BackCompat"){obj_Scroll=bN.ownerDocument.documentElement;}}x+=bN.offsetLeft-obj_Scroll.scrollLeft;y+=bN.offsetTop-obj_Scroll.scrollTop;ku=bN;if(bN.offsetParent){bN=bN.offsetParent;var scrollNode=ku;while(scrollNode&&scrollNode!=bN){x-=scrollNode.scrollLeft;y-=scrollNode.scrollTop;scrollNode=scrollNode.parentNode;}}else{if(hn!=w){bN=hn.frameElement;ku=null;if(bN){hn=bN.contentWindow.parent;}}else{bN=null;}}}if(R.ce(w.document.body,'position')!='static'||(F.as&&R.vN(node)==null)){x+=w.document.body.offsetLeft;y+=w.document.body.offsetTop;}return{"x":x,"y":y};};R.vU=function(vY,bz){var Bh=this.hg(vY,bz);var Bm=R.gL(vY);Bh.x-=Bm.X;Bh.y-=Bm.Y;return Bh;};R.zD=function(kG,Bq){var vY=this.mh(kG);var Bz=this.eF(vY).Height;var ro=Bz* -1;if(Bq===false){ro+=kG.offsetHeight||0;ro+=parseInt(this.ce(kG,'margin-bottom')||0,10)||0;}var st=this.hg(vY,kG);ro+=st.y;var rf=this.gL(vY).Y;if(ro>0&&(ro>rf||ro<rf-Bz)){vY.scrollTo(0,ro);}};R.ns=function(nH){if(!nH||nH.nodeType!=1||nH.tagName.toLowerCase()!='form'){return[];}var kz=[];var Bl=['style','className'];for(var i=0;i<Bl.length;i++){var ay=Bl[i];if(nH.elements.namedItem(ay)){var BS=nH.elements.namedItem(ay);kz.push([BS,BS.nextSibling]);nH.removeChild(BS);}}return kz;};R.lU=function(pU,kz){if(!pU||pU.nodeType!=1||pU.tagName.toLowerCase()!='form'){return;}if(kz.length>0){for(var i=kz.length-1;i>=0;i--){var bz=kz[i][0];var Cs=kz[i][1];if(Cs){pU.insertBefore(bz,Cs);}else{pU.appendChild(bz);}}}};R.vN=function(kG){var oU=kG;while(oU!=R.dV(oU).documentElement){if(this.ce(oU,'position')!='static'){return oU;}oU=oU.parentNode;}return null;};R.oQ=function(qX,Ba,tO,rE,BY){return(BY||window).setTimeout(function(){if(rE){qX.apply(tO,[].concat(rE));}else{qX.apply(tO);}},Ba);};R.za=function(qX,tO,rE,BY){if(qX){this.oQ(qX,0,tO,rE,BY);}};R.cP=function(kG,Cr){var Cb=kG.style;for(var rr in Cr){Cb[rr]=Cr[rr];}};R.kx=function(kG,Cr,eE){if(kG.hasChildNodes()){for(var i=0;i<kG.childNodes.length;i++){var bz=kG.childNodes[i];if(bz.nodeType==1){if(!eE||(eE&&bz.tagName&&this.KO(eE,bz.tagName)>=0)){this.cP(bz,Cr);}this.kx(bz,Cr,eE);}}}};R.KO=function(a,s){for(var i=0;i<a.length;i++){if(a[i]==s){return i;}}return-1;};R.NP=function(MX,s,NQ,AO){if(!AO){AO="|";}MX=AO+MX+AO;s=AO+s+AO;if(NQ){MX=MX.toLowerCase();s=s.toLowerCase();}return(MX.indexOf(s)>=0);};R.cE=function(bz,CQ){if(CQ){var mz;while((mz=bz.firstChild)){bz.parentNode.insertBefore(bz.removeChild(mz),bz);}}return bz.parentNode.removeChild(bz);};R.tz=function(bz,mL){mL=mL.toUpperCase();return R.Mv(bz,[mL]);};R.Mv=function(bz,Jo){while(bz&&bz.tagName&&bz.tagName!="BODY"){var mL=bz.tagName.toUpperCase();if(R.KO(Jo,mL)>=0){return bz;}bz=bz.parentNode;}return null;};R.Mc=function(LU,Lz){var bz=LU;while(bz&&bz.tagName&&bz.tagName!="BODY"){if(bz.parentNode==Lz){return bz;}else{bz=bz.parentNode;}}return LU;};R.Lq=function(){return EWEB.T.body;};R.Lg=function(bz){if(bz&&bz.tagName&&(bz.tagName=="BODY")){return true;}else{return false;}};R.Gu=function(J){if(!this.DU){this.DU=1;}var sB="eWebEditor_tmp_"+this.DU;if(J.getElementById(sB)){this.DU++;return this.Gu(J);}this.DU++;return sB;};R.lE=function(hS){hS.$=function(Cu){return hS.document.getElementById(Cu);};};R.iO=function(){if(F.as){if(F.xZ){return "javascript: '';";}else{return "";}}else{if(F.eo){return "";}else{return "javascript: void(0);";}}};R.aw=function(e){if(F.as){try{e.returnValue=false;e.cancelBubble=true;e.keyCode=0;}catch(er){}return false;}else{if(e){e.preventDefault();e.stopPropagation();}}};R.az=function(jP,pY,Ia){if(F.as){jP.attachEvent("on"+pY,Ia);}else{jP.addEventListener(pY,Ia,false);}};R.hf=function(jP,pY,Ia){if(F.as){jP.detachEvent("on"+pY,Ia);}else{jP.removeEventListener(pY,Ia,false);}};R.eF=function(vY){if(F.as){var nm;var cl=vY.document.documentElement;if(cl&&cl.clientWidth){nm=cl;}else{nm=vY.document.body;}if(nm){return{Width:nm.clientWidth,Height:nm.clientHeight};}else{return{Width:0,Height:0};}}else{return{Width:vY.innerWidth,Height:vY.innerHeight};}};R.gL=function(BM){if(F.as){var cl=BM.document;var fs={X:cl.documentElement.scrollLeft,Y:cl.documentElement.scrollTop};if(fs.X>0||fs.Y>0){return fs;}return{X:cl.body.scrollLeft,Y:cl.body.scrollTop};}else{return{X:BM.pageXOffset,Y:BM.pageYOffset};}};R.rN=function(kG,qs){if(F.as&& !F.BX){qs=Math.round(qs*100);kG.style.filter=(qs>100?"":"progid:DXImageTransform.Microsoft.Alpha(opacity="+qs+")");}else{kG.style.opacity=qs;}};R.ce=function(kG,hO){if(F.as){hO=hO.replace(/\-(\w)/g,function(CC,p1){return p1.toUpperCase();});return kG.currentStyle[hO];}else{try{return kG.ownerDocument.defaultView.getComputedStyle(kG,"").getPropertyValue(hO);}catch(e){}}};R.ko=function(kG){if(F.EY){kG.unselectable='on';kG.setAttribute("unselectable","on");var e,i=0;while((e=kG.children[i++])){if(e.getAttribute('eweb_donotdisableselect',2)=='true'){continue;}switch(e.tagName){case 'IFRAME':case 'TEXTAREA':case 'INPUT':case 'SELECT':break;default:this.ko(e);}}}else{if(F.jo){kG.style.MozUserSelect='-moz-none';}else if(F.eo){kG.style.msUserSelect='none';}else if(F.ik){kG.style.KhtmlUserSelect='none';}else{kG.style.userSelect='none';}var K=kG.getElementsByTagName("*");for(var i=0;i<K.length;i++){switch(K[i].tagName){case "INPUT":case "TEXTAREA":if(F.jo){K[i].style.MozUserSelect='text';}else if(F.eo){K[i].style.msUserSelect='text';}else if(F.ik){K[i].style.KhtmlUserSelect='text';}else{K[i].style.userSelect='text';}break;default:}}}};R.oE=function(kG){var Cp=R.ns(kG);var fE=new Object();if(kG.className.length>0){fE.Class=kG.className;kG.className='';}if(F.as){var nk=kG.style.cssText;if(nk.length>0){fE.Inline=nk;kG.style.cssText='';}kG.style.position='static';}else{var nk=kG.getAttribute('style');if(nk&&nk.length>0){fE.Inline=nk;kG.setAttribute('style','',0);}try{kG.style.position='static';}catch(e){}}R.lU(kG,Cp);return fE;};R.lO=function(kG,fE){var Cp=R.ns(kG);if(F.as){kG.className=fE.Class||'';kG.style.cssText=fE.Inline||'';}else{kG.className=fE.Class||'';if(fE.Inline){kG.setAttribute('style',fE.Inline,0);}else{kG.removeAttribute('style',0);}}R.lU(kG,Cp);};R.KN=function(GP,Hh){var GT={"M+":GP.getMonth()+1,"d+":GP.getDate(),"h+":GP.getHours(),"m+":GP.getMinutes(),"s+":GP.getSeconds(),"q+":Math.floor((GP.getMonth()+3)/3),"S+":GP.getMilliseconds()};if(/(y+)/i.test(Hh)){Hh=Hh.replace(RegExp.$1,(GP.getFullYear()+"").substr(4-RegExp.$1.length));}for(var k in GT){if(new RegExp("("+k+")").test(Hh)){var s="00"+GT[k];var n=RegExp.$1.length;var v=(n==1)?GT[k]:s.substr(s.length-n);Hh=Hh.replace(RegExp.$1,v);}}return Hh;};R.Sp=function(qP){var SB=Math.pow(10,qP);var n=Math.floor(Math.random()*SB);var s=n+"";var j=qP-s.length;for(var i=0;i<j;i++){s="0"+s;}return s;};R.Nl=function(){return R.KN(new Date(),"yyyyMMddhhmmssSSS")+R.Sp(5);};var C=new Object();C.lF=function(eE){var FX=function(a,s){for(var i=0;i<a.length;i++){if(a[i]==s){return i;}}return-1;};var el=null;if(C.ai()!="Control"){el=C.cI();if((!el)||(el.nodeType!=1)||(el.tagName=="HTML")){return null;}while(FX(eE,el.tagName.toUpperCase())<0){if(el.tagName.toUpperCase()=="BODY"){el=null;break;}el=el.parentNode;}}return el;};C.Mk=function(){var p=null;if(F.as){var Bd=EWEB.T.selection;if(Bd&&Bd.type&&Bd.type=="None"){var nr=Bd.createRange();if(nr){var Mj=nr.parentElement();var bz=R.Mv(Mj,["P","DIV","TD","TH","TABLE"]);if(bz){var aH=bz.tagName.toUpperCase();if(R.KO(["P","DIV"],aH)>=0){var KG=EWEB.T.body.createTextRange();KG.moveToElementText(bz);if(KG.collapse){KG.collapse(true);if(nr.isEqual(KG)){p=bz;}}}}}}}else{var Bd=EWEB.aR.getSelection();if(Bd&&Bd.rangeCount==1){var nr=Bd.getRangeAt(0);if(nr.collapsed&&nr.startOffset==0){var bz=nr.startContainer;while(bz){if(bz.nodeType==1){var aH=bz.tagName.toUpperCase();if(R.KO(["P","DIV"],aH)>=0){p=bz;bz=null;}else if(R.KO(["TABLE","TD","TH","BODY"],aH)>=0){bz=null;}else if(bz.previousSibling){bz=null;}else{bz=bz.parentNode;}}else{if(bz.previousSibling){bz=null;}else{bz=bz.parentNode;}}}}}}return p;};C.ai=function(){if(F.as){try{var DZ=C.bG().type;if(DZ=='Control'||DZ=='Text'){return DZ;}if(this.bG().createRange().parentElement){return 'Text';}}catch(e){}return 'None';}else{var cT='Text';var Dr={img:1,hr:1,li:1,table:1,tr:1,td:1,embed:1,object:1,ol:1,ul:1};var Bd;try{Bd=this.bG();}catch(e){}if(Bd&&Bd.rangeCount==1){var nr=Bd.getRangeAt(0);this.FY(nr);if(nr.startContainer==nr.endContainer&&(nr.endOffset-nr.startOffset)==1&&nr.startContainer.nodeType==1&&Dr[nr.startContainer.childNodes[nr.startOffset].nodeName.toLowerCase()]){cT='Control';}}return cT;}};C.FY=function(nr){if(F.eo&&(!nr.collapsed)){var Ek=nr.startContainer;var CS;if(Ek.nodeType==3){if(nr.startOffset==Ek.nodeValue.length){CS=Ek.nextSibling;}}else{CS=Ek.childNodes[nr.startOffset];}var Dk=nr.endContainer;var EB;if(Dk.nodeType==3){if(nr.endOffset==0){EB=Dk.previousSibling;}}else{if(nr.endOffset>0){EB=Dk.childNodes[nr.endOffset-1];}}if(CS&&CS.nodeType==1&&CS==EB&&CS.tagName=="IMG"){nr.selectNode(CS);}}};C.ax=function(){if(F.as){if(this.ai()=='Control'){var oRange=this.bG().createRange();if(oRange&&oRange.item){return this.bG().createRange().item(0);}}return null;}else{var selection= ! !EWEB.aR&&this.bG();if(!selection||selection.rangeCount<1){return null;}var range=selection.getRangeAt(0);this.FY(range);if(range.startContainer!=range.endContainer||range.startContainer.nodeType!=1||range.startOffset!=range.endOffset-1){return null;}var node=range.startContainer.childNodes[range.startOffset];if(node.nodeType!=1){return null;}return node;}};C.cI=function(){if(F.as){switch(this.ai()){case 'Control':var el=C.ax();return el?el.parentElement:null;case 'None':return null;default:if(F.Cf||F.GD){return this.bG().createRange().parentElement();}else{var Kl=this.bG().createRange();var el=Kl.parentElement();var Mf=EWEB.T.body.createTextRange();Mf.moveToElementText(el);if(Kl.text.length>Mf.text.length){return el.parentNode;}else{return el;}}}}else{if(this.ai()=='Control'){return C.ax().parentNode;}else{var af=this.bG();if(af&&af.rangeCount>0){if(af.anchorNode&&af.anchorNode==af.focusNode){if(af.anchorNode.nodeType==3){return af.anchorNode.parentNode;}else if(af.anchorNode.nodeType==9){return null;}else{return af.anchorNode;}}var oRange=af.getRangeAt(0);return oRange.commonAncestorContainer;}}return null;}};C.xt=function(AZ){if(F.as){switch(this.ai()){case 'Control':var el=C.ax();return el?el.parentElement:null;case 'None':return null;default:var J=EWEB.T;var fA=J.selection.createRange();fA.collapse(AZ!==false);var el=fA.parentElement();return R.dV(el)==J?el:null;}}else{if(!EWEB.aR){return null;}if(this.ai()=='Control'){return C.ax().parentNode;}else{var af=this.bG();if(af&&af.rangeCount>0){var fA=af.getRangeAt(AZ?0:(af.rangeCount-1));var kG=AZ?fA.startContainer:fA.endContainer;return(kG.nodeType==1?kG:kG.parentNode);}}return null;}};C.vR=function(bz){if(F.as){EWEB.Focus();this.bG().empty();var oRange;try{oRange=EWEB.T.body.createControlRange();oRange.addElement(bz);oRange(0).select();}catch(e){oRange=EWEB.T.body.createTextRange();oRange.moveToElementText(bz);oRange.select();}}else{var oRange=EWEB.T.createRange();oRange.selectNode(bz);var af=this.bG();af.removeAllRanges();af.addRange(oRange);}};C.Empty=function(){if(F.as){this.bG().empty();}else{this.bG().removeAllRanges();}};C.Collapse=function(uK){if(F.as){EWEB.Focus();if(this.ai()=='Text'){var oRange=this.bG().createRange();oRange.collapse(uK==null||uK===true);oRange.select();}}else{var af=this.bG();if(uK==null||uK===true){af.collapseToStart();}else{af.collapseToEnd();}}};C.zp=function(sg){if(F.as){var cr;if(this.bG().type=="Control"){cr=this.ax();}else{var oRange=this.bG().createRange();cr=oRange.parentElement();}while(cr){if(cr.nodeName.IEquals(sg))return true;cr=cr.parentNode;}return false;}else{var cr=this.ax();if(!cr&&EWEB.aR){try{cr=this.bG().getRangeAt(0).startContainer;}catch(e){}}while(cr){if(cr.nodeType==1&&cr.nodeName.IEquals(sg))return true;cr=cr.parentNode;}return false;}};C.AG=function(sg){if(F.as){var io,oRange;if(!EWEB.T)return null;if(this.bG().type=="Control"){oRange=this.bG().createRange();for(i=0;i<oRange.length;i++){if(oRange(i).parentNode){io=oRange(i).parentNode;break;}}}else{oRange=this.bG().createRange();io=oRange.parentElement();}while(io&& !io.nodeName.Equals(sg)){io=io.parentNode;}return io;}else{var io;var cr=this.ax();if(!cr){cr=this.bG().getRangeAt(0).startContainer;}while(cr){if(cr.nodeName.IEquals(sg)){return cr;}cr=cr.parentNode;}return null;}};C.Delete=function(){var af=this.bG();if(F.as){if(af.type.toLowerCase()!="none"){af.clear();}}else{for(var i=0;i<af.rangeCount;i++){af.getRangeAt(i).deleteContents();}}return af;};C.bG=function(){if(F.as){this.Restore();return EWEB.T.selection;}else{return EWEB.aR.getSelection();}};C.Save=function(Ed){if(!F.EY){return;}var vY,J;if(EWEB.ae=="EDIT"){vY=EWEB.aR;J=EWEB.T;}else{vY=window;J=document;}if(!J){return;}if(this.yw){return;}this.yw= ! !Ed;var Bd;var nr;if(F.eo){Bd=vY.getSelection();if(Bd.rangeCount>0){nr=Bd.getRangeAt(0);}}else{Bd=J.selection;if(Bd){nr=Bd.createRange();}}if(this.zw(nr)!=J){nr=null;}this.sN=nr;};C.zw=function(nr){if(!nr){return null;}else if(nr.item){return R.dV(nr.item(0));}else if(nr.parentElement){return R.dV(nr.parentElement());}else if(nr.startContainer){return R.dV(nr.startContainer);}};C.Restore=function(DR){if(!F.EY){return;}if(this.sN){EWEB.yB=true;try{var vY,J,Bd,nr;if(EWEB.ae=="EDIT"){vY=EWEB.aR;J=EWEB.T;}else{vY=window;J=document;}if(F.eo){Bd=vY.getSelection();if(Bd.rangeCount>0){nr=Bd.getRangeAt(0);}}else{Bd=J.selection;if(Bd){nr=Bd.createRange();}}if(!DR&&this.zw(nr)==J){EWEB.yB=false;return;}if(F.eo){Bd.removeAllRanges();Bd.addRange(this.sN);}else{this.sN.select();}}catch(e){}EWEB.yB=false;}};C.Release=function(){if(!F.EY){return;}this.yw=false;delete this.sN;};C.ww=function(el){if(F.as){var iP,gF;iP=EWEB.T.selection.createRange();gF=EWEB.T.body.createTextRange();gF.moveToElementText(el);if(iP.inRange(gF)){return true;}else{if(((iP.compareEndPoints("StartToEnd",gF)<0)&&(iP.compareEndPoints("StartToStart",gF)>0))||((iP.compareEndPoints("EndToStart",gF)>0)&&(iP.compareEndPoints("EndToEnd",gF)<0))){return true;}}return false;}else{var Bd=C.bG();if(Bd.rangeCount<1){return false;}var iP=Bd.getRangeAt(0);var gF=EWEB.T.createRange();gF.selectNodeContents(el);if((gF.compareBoundaryPoints(Range.START_TO_END,iP)>=0)&&(gF.compareBoundaryPoints(Range.END_TO_START,iP)<=0)){return true;}return false;}};C.dh=function(eE,nz){var gG=new Array();var bd=C.lF(eE);var LN=(bd)?bd:EWEB.T.body;for(var i=0;i<eE.length;i++){var a=LN.getElementsByTagName(eE[i]);for(var j=0;j<a.length;j++){if(C.ww(a[j])){if(a[j]){gG[gG.length]=a[j];if(nz){return gG;}}}}}if(gG.length<=0){if(bd){gG[0]=bd;}}return gG;};C.Os=function(){if(C.ai()=="Control"){return "";}var r="";if(F.EY){try{r=EWEB.T.queryCommandValue("FontName");}catch(e){r="";}}else{var eU=C.cI();if(!eU){return "";}var ad=C.bG().getRangeAt(0);var fG=EWEB.T.createRange();r=R.ce(eU,"font-family");var K=eU.getElementsByTagName("*");for(var i=0;i<K.length;i++){var el=K[i];fG.selectNodeContents(el);if((fG.compareBoundaryPoints(Range.START_TO_END,ad)>=0)&&(fG.compareBoundaryPoints(Range.END_TO_START,ad)<=0)){var v=R.ce(el,"font-family");if(r!=v){r="";break;}}}}return r;};C.BA=function(){if(C.ai()=="Control"){return "";}var vf=function(){if(C.ai()=="Control"){return "";}var r="";if(F.as){var aD=C.bG().createRange();if(aD.text.length<=1){return aD.parentElement().currentStyle.fontSize;}var html=aD.htmlText;html=html.replace(/<[^>]+>/gi," ");html=html.replace(/(&nbsp\;|\s)+/gi," ");html=html.replace(/(^\s*)|(\s*$)/gi,"");var kr=html.split(" ");var pZ=aD.getBookmark();aD.collapse();for(var i=0;i<kr.length;i++){if(!kr[i]){continue;}var b=aD.findText(kr[i]);if(b){var v=aD.parentElement().currentStyle.fontSize;if((r!="")&&(r!=v)){r="";break;}r=v;aD.collapse(false);}else{break;}}aD.moveToBookmark(pZ);}else{var eU=C.cI();if(!eU){return "";}var ad=C.bG().getRangeAt(0);var fG=EWEB.T.createRange();r=R.ce(eU,"font-size");var K=eU.getElementsByTagName("*");for(var i=0;i<K.length;i++){var el=K[i];fG.selectNodeContents(el);if((fG.compareBoundaryPoints(Range.START_TO_END,ad)>=0)&&(fG.compareBoundaryPoints(Range.END_TO_START,ad)<=0)){var v=R.ce(el,"font-size");if(r!=v){r="";break;}}}if(r!=""){}}return r;};var v;if(F.as){v=EWEB.T.queryCommandValue("FontSize");if(v){v=nq(v);}}if(!v){v=vf();}return v;};function getSelectedHTML(){switch(EWEB.ae){case "EDIT":var NY="";if(window.getSelection){var Ml=EWEB.aR.getSelection().rangeCount;for(var i=0;i<Ml;i++){var r=EWEB.aR.getSelection().getRangeAt(i);var c=document.createElement('div');c.appendChild(r.cloneContents());NY+=c.innerHTML;}}else if(document.getSelection){var r=EWEB.T.getSelection().getRangeAt(0);var c=document.createElement('div');c.appendChild(r.cloneContents());NY=c.innerHTML;}else if(document.selection){NY=EWEB.T.selection.createRange().htmlText;}NY=aE.wV(NY);return NY;break;case "TEXT":var fV=EWEB.db;var bE="";if(window.getSelection){bE=fV.value.substring(fV.selectionStart,fV.selectionEnd);}else{fV.focus();var Bd=document.selection.createRange();bE=Bd.text;}return FM(bE);break;default:return "";}};function getSelectedText(){switch(EWEB.ae){case "EDIT":if(window.getSelection){return EWEB.aR.getSelection().toString();}else if(document.getSelection){return EWEB.T.getSelection().toString();}else if(document.selection){return EWEB.T.selection.createRange().text;}break;case "TEXT":var fV=EWEB.db;if(window.getSelection){return fV.value.substring(fV.selectionStart,fV.selectionEnd);}else{fV.focus();var Bd=document.selection.createRange();return Bd.text;}break;default:return "";}};function getSelectedElement(){var jE;if(EWEB.ae=="EDIT"){jE=C.cI();}if(jE){var cb=jE.getAttribute("_ewebeditor_fake_tag",2);if(cb){jE=null;}}return jE;};function getAllImageSrc(){var NY=getHTML();var re=/<img(?=[\s])[^>]*?\ssrc\s*=\s*([\'\"])([^\'\">]+?)\1[^>]*?>/gi;var m;var Ce=new Array();while((m=re.exec(NY))!=null){Ce.push(m[2]);}return Ce;};function getMode(){return EWEB.ae;};function CF(){if(EWEB.ae!="EDIT"){return;}if(C.ai()=="Control"){var bg=C.ax();if(bg.tagName.toUpperCase()=="IMG"){if(!aE.BK(bg)){var wx=aE.CL(bg,"src");sk({flag:"SetTitleImage",src:wx,obj:bg});}}}};function update(){var NY=getHTML();if(EWEB.hq=="INPUT"){EWEB.bs.value=NY;}else{EWEB.bs.innerHTML=NY;}};function BW(v){var n=parseInt(v);if(isNaN(n)){n=0;}return n;};var IG=(function(){var IO=function(){try{return new window.XMLHttpRequest();}catch(e){try{return new window.ActiveXObject("Microsoft.XMLHTTP");}catch(e){alert("XHR is not supported!");}}};var JF=function(hT){if(!hT)return '';var Hj=[];for(var ay in hT){var bv=hT[ay]+"";ay=ay;bv=encodeURIComponent(bv);Hj.push(ay+'='+bv);}return Hj.join('&');};var Sv=function(hT){var aO=new FormData();var RR="application/x-www-form-urlencoded";for(var ay in hT){if(typeof(hT[ay])=="object"){RR="multipart/form-data";aO.append(ay,hT[ay],hT[ay].name);}else{aO.append(ay,hT[ay]+"");}}return aO;};return{CT:function(cT,aG,Bn,rs,HG,lL){var xhr=IO();if(!xhr){return;}cT=cT.toLowerCase();xhr.open(cT,aG,Bn);var HL=function(){if(xhr.readyState==4){if(!HL){return}HL=null;var jE={};jE["xhrstatus"]=xhr.status;jE["state"]="";jE["isjson"]=false;if(xhr.status==200){jE["state"]="ok";try{jE["data"]=JSON.parse(xhr.responseText);jE["isjson"]=true;}catch(e){jE["data"]=xhr.responseText;}}else{jE["state"]="err";jE["errflag"]="xhrstatus";jE["data"]={};}if(!Bn){return jE;}else{if(HG){HG(jE);}}}};if(Bn){xhr.onreadystatechange=HL;if(lL){xhr.onprogress=lL;}}try{if(cT=="post"){xhr.send(Sv(rs));}else{xhr.send(null);}}catch(e){}if(!Bn||xhr.readyState==4){return HL();}}}})();var Jz=(function(){var Mr=function(aV,KC){aV=aV.toLowerCase();var nz=false;if(KC&&aV=="textindent"){nz=true;}var a;if(C.ai()=="Control"){a=new Array();var el=R.Mv(C.ax(),["P","DIV"]);if(el){a[0]=el;}}else{a=C.dh(["P","DIV"],nz);}var iQ="";if(a.length>0){switch(aV){case "textindent":if(a[0].style.textIndent){iQ="yes";}break;case "lineheight":case "margintop":case "marginbottom":iQ=JT(a[0],aV);for(var i=1;i<a.length;i++){if(JT(a[i],aV)!=iQ){iQ="unknow";break;}}break;}}return{"V":iQ,"P":a};};var JT=function(el,aV){switch(aV){case "lineheight":return el.style.lineHeight;break;case "margintop":return el.style.marginTop;break;case "marginbottom":return el.style.marginBottom;break;}};var Md={"lineheight":["","1","1.5","1.75","2","3","4","5"],"margintop":["","5px","10px","15px","20px","25px","30px"],"marginbottom":["","5px","10px","15px","20px","25px","30px"]};return{KD:function(aV){return Md[aV.toLowerCase()];},Kk:function(aV){var jE=Mr(aV,true);return jE["V"];},Ky:function(aV,bv){aV=aV.toLowerCase();var jE=Mr(aV);var a=jE["P"];if(a.length<=0){return;}if(aV=="textindent"){if(bv===undefined){bv=(jE["V"])?"":"2em";}}for(var i=0;i<a.length;i++){if(aV=="textindent"){a[i].style.textIndent=bv;}else if(aV=="lineheight"){a[i].style.lineHeight=bv;R.kx(a[i],{"lineHeight":""},["SPAN"]);}else if(aV=="margintop"){a[i].style.marginTop=bv;}else if(aV=="marginbottom"){a[i].style.marginBottom=bv;}}if(aV=="textindent"){EWEB.Focus();ci.eW();}Et();}}})();var dU=(function(){var LG;var SU;var ME;var Nf=function(jT){var fW="ws://127.0.0.1:20037";if(F.EY&&(aA.Proto=="https")){fW="wss://127.0.0.1:20038";}if(!ME){ME=new QC(fW,false);}LG=ME;};var Qw=function(bU,rS,yF,jT,zP){var oz=2000000;var rj=Math.ceil(bU.size/oz);Qi(bU,1,oz,rj,"",rS,yF,jT,zP);};var Qi=function(bU,mk,oz,rj,NS,rS,yF,jT,zP){var hX;if(mk==rj){hX=bU.slice((mk-1)*oz,bU.size,bU.type);rS["blockflag"]="end";}else{hX=bU.slice((mk-1)*oz,mk*oz,bU.type);rS["blockflag"]="";}rS["filename"]=bU.name;rS["blockkey"]=NS;R.Rm(hX,function(mZ){rS["blockfile"]=mZ;dU.eS(rS,true,jT,function(jE){if(jE["state"]=="ok"){if(mk==rj){zP(jE);}else{NS=jE["blockkey"];Qi(bU,mk+1,oz,rj,NS,rS,yF,jT,zP);}}else{zP(jE);}});});};var Fi=[];var Pd=function(vn,mk,jT,zP){if(mk==1){Fi=[];}dU.eS({"act":"getfile","filekey":vn,"blockindex":mk},true,jT,function(jE){if(jE["state"]=="ok"){var Fm=R.PR(jE["blockfile"]);Fi.push(Fm);if(jE["blockflag"]&&jE["blockflag"]=="end"){var PU=0;for(var i=0;i<Fi.length;i++){PU+=Fi[i].length;}var OB=new Uint8Array(PU);var ro=0;for(var i=0;i<Fi.length;i++){OB.set(Fi[i],ro);ro+=Fi[i].length;}var cs=vn.substring(vn.lastIndexOf(".")+1);var rJ=R.PO(cs);var hX=new Blob([OB],{type:rJ});var bU=R.HM(hX,"x."+cs);zP({"state":"ok","file":bU});}else{Pd(vn,mk+1,jT,zP);}}else{zP(jE);}});};return{eS:function(rS,yF,jT,zP){if(F.p!="w"){alert(lang["MsgOnlyForWindow"]);if(zP){zP({"state":"err","errflag":"p"});}return;}Nf(jT);LG.eS(rS,yF,zP);},yR:function(bU,rS,yF,jT,zP){Qw(bU,rS,yF,jT,zP);},PY:function(vn,jT,zP){Pd(vn,1,jT,zP);},Im:function(jT){Nf(jT);LG.eS({"act":"cancel"},false);},FV:function(qg,zP){Nf("c");LG.FV(qg,zP);},Rc:function(){var cR=$("div_LS");var kS="";if(F.EY&&(aA.Proto=="https")){kS="port=20038";}cR.innerHTML="<iframe id='ifr_LS' width=1 height=1 src='ewebeditorws:"+kS+"'></iframe>";}}})();function QC(Ql,Tg){var Qv="15.2.0.0";var yn="";var xs;var zu="";var eI=[];var Pb=false;var Ob="";var pW=false;var Oi=function(oC){var Do=oC.split(".");var EO=TZ.split(".");if(Do.length==4){for(var i=0;i<4;i++){var EA=parseInt(Do[i]);var EZ=parseInt(EO[i]);if(EA>EZ){return true;}else if(EA<EZ){return false;}}return true;}return false;};var OC=function(){try{xs.close();}catch(e){}xs=null;};var Qy=function(){if(xs){switch(xs.readyState){case 0:case 1:return true;break;default:OC();break;}}else{if(typeof(WebSocket)==="undefined"){alert("WebSocket is not supported by this browser.");return false;}}try{xs=new WebSocket(Ql);}catch(e){alert("ws url error: "+Ql);return false;}xs.onopen=function(){if(zu==""){zu="open";}};xs.onmessage=function(e){RU(e.data);};xs.onclose=function(){xs=null;};xs.onerror=function(e){if(zu==""){zu="err";}OC();};return true;};var OW=function(HS,yF,zP){if(yF){if(pW){if(zP){zP({"state":"err","errflag":"cancel"});}return;}eI.push({"actinfo":HS,"callback":zP});OE();}else{OH(HS);}};var OE=function(){if(eI.length==0){return;}if(Pb){return;}Pb=true;OH(eI[0]["actinfo"]);};var OH=function(HS){xs.send(JSON.stringify(HS));};var RU=function(KW){if(typeof(KW)=="string"){var uF;try{uF=JSON.parse(KW);}catch(e){uF={};}switch(uF["act"]){case "config":if(uF["state"]=="ok"){Ob=uF["cid"];config.weql=uF["weql"];if(uF["l"]!="ok"){IG.CT("get",EWEB.Po+"&action=license&r="+Ob,true,null,function(eL){var fM="";if(eL["state"]=="ok"){if(eL["isjson"]&&eL["data"]["lc"]){fM=eL["data"]["lc"];}}else if(eL["state"]=="err"){if(eL["errflag"]=="xhrstatus"){alert("xhrstatus:"+eL["xhrstatus"]);return;}}if(!fM){eI=[];yn="y";config.L="";return;}var Ub={"act":"lc","lc":fM,"cid":Ob};OW(Ub,true,function(IY){if(IY["l"]!="ok"){config.L="";}yn="y";});});}else{yn="y";}}else if(uF["state"]=="err"){yn="n";}else{yn="n";}return;break;default:break;}if(eI.length<=0){return;}var HS=eI[0]["actinfo"];if(HS["act"]==uF["act"]){var zP=eI[0]["callback"];if(zP){zP(uF);}if((uF["state"]=="ok")||(uF["state"]=="err")){eI.shift();Pb=false;OE();}}}else if(KW instanceof ArrayBuffer){}};var OT=function(qg,zP){if(yn=="y"){if(zP){zP(true);}return;}if(zu=="err"){zu="";yn="";}if(zu=="open"){Qr(qg,zP);}else{if(Qy()){R.oQ(OX,50,null,[qg,zP]);}else{if(zP){zP(false);}return;}}};var OX=function(qg,zP){switch(zu){case "open":Qr(qg,zP);break;case "err":if(zP){zP(false);}if(qg){Ru("install");}break;default:R.oQ(OX,50,null,[qg,zP]);break;}};var Qr=function(qg,zP){var SG={"act":"config","sendurl":EWEB.OS,"serverext":config.ServerExt,"o":aA.hW,"h":aA.H,"sv":config.v,"sl":config.sl,"cp":config.cp,"cv":Qv,"allowimagesize":config.AllowImageSize,"allowmediasize":config.AllowMediaSize,"allowfilesize":config.AllowFileSize,"allowimageext":config.AllowImageExt,"allowmediaext":config.AllowMediaExt,"allowfileext":config.AllowFileExt,"wordeqversion":config.WordEqVersion,"lang":"zh-cn","charset":config.Charset};OH(SG);OR(qg,zP);};var OR=function(qg,zP){if(yn==""){R.oQ(OR,50,null,[qg,zP]);}else{if(yn=="y"){if(zP){zP(true);}}else{if(zP){zP(false);}if(qg){Ru("update");}}}};var Ru=function(an){aK("installactivex.htm?action="+an,true);};this.eS=function(HS,yF,zP){if(HS["act"]=="cancel"){pW=true;if(yn!="y"){return;}}else{pW=false;}OT(true,function(Ug){if(Ug){if(!config.L){alert(lang["ErrLicense"]);if(zP){zP({"state":"err"});}return;}OW(HS,yF,zP);}else{if(zP){zP({"state":"err","errflag":"notinstall"});}}});};this.FV=function(qg,zP){OT(qg,zP);};};R.PO=function(cs){var rJ;switch(cs){case "png":case "bmp":case "gif":case "webp":rJ="image/"+cs;break;case "jpg":case "jpeg":rJ="image/jpeg";break;case "svg":rJ="image/svg+xml";break;case "ico":rJ="image/x-icon";break;case "pdf":rJ="application/pdf";break;default:rJ="application/octet-stream";break;}return rJ;};R.By=function(rJ){if(!rJ){return "";}switch(rJ.toLowerCase()){case "image/png":return "png";case "image/bmp":return "bmp";case "image/gif":return "gif";case "image/webp":return "webp";case "image/jpeg":return "jpg";case "image/svg+xml":return "svg";case "image/x-icon":case "image/vnd.microsoft.icon":return "ico";case "application/pdf":return "pdf";default:return "";}};R.Qp=function(mZ,cs){var rJ=this.PO(cs);return this.Sh(mZ,rJ);};R.PR=function(mZ){mZ=mZ.replace(/\r\n/g,"");var Sc=atob(mZ);var n=Sc.length;var Fm=new Uint8Array(n);while(n--){Fm[n]=Sc.charCodeAt(n);}return Fm;};R.Sh=function(mZ,rJ){var Fm=this.PR(mZ);var hX=new Blob([Fm],{type:rJ});return hX;};R.GQ=function(mZ,cs,qi){var hX=this.Qp(mZ,cs);return this.HM(hX,qi);};R.SJ=function(mZ,rJ,qi){var hX=this.Sh(mZ,rJ);return this.HM(hX,qi);};R.HM=function(hX,qi){hX.lastModifiedDate=new Date();hX.name=qi;return hX;};R.Rm=function(hX,HG){var fr=new FileReader();fr.onload=function(){var Ns=fr.result;var mZ=Ns.split(',')[1];HG(mZ);};fr.readAsDataURL(hX);};var eG=(function(){var pW=false;var Pg=function(wx){if(!wx){return true;}wx=wx.toLowerCase();if((wx.substring(0,7)=="http://")||(wx.substring(0,8)=="https://")){if(wx.substring(0,aA.hW.length)!=aA.hW){return false;}}return true;};var Tm=function(OG,JY,zP){var Bf=[];var pd=function(gU){for(var k=0;k<Bf.length;k++){if(Bf[k]["url"]==gU){return k;}}return-1;};var jI=function(gU,qV,cT){var jM={"el":qV,"type":cT};var k=pd(gU);if(k>=0){Bf[k]["K"].push(jM);}else{Bf[Bf.length]={"url":gU,"K":[jM]};}};var K=OG.getElementsByTagName("*");for(var i=0;i<K.length;i++){var el=K[i];if(el.tagName=="IMG"){if(el.complete){if((el.naturalWidth>0)&&(el.naturalHeight>0)){var wx=el.getAttribute("src");if(!Pg(wx)){jI(wx,el,"img");}}}}var mI=el.style.backgroundImage;if(mI){var gy=mI.replace(/^\s*?url\s*?\(\s*?([^\s][^\r\n\t]*?)\s*?\)\s*?$/gi,"$1");if(gy!=mI){gy=gy.replace(/(^[\'\"]|[\'\"]$)/gi,"");if(!Pg(gy)){jI(gy,el,"bg");}}}}Nn(Bf,JY,function(eY){for(var i=0;i<Bf.length;i++){if(eY[i]["state"]=="ok"){var aG=eY[i]["url"];var K=Bf[i]["K"];for(var j=0;j<K.length;j++){var el=K[j]["el"];var cT=K[j]["type"];if(cT=="img"){el.setAttribute("src",aG,0);el.setAttribute("_ewebeditor_pa_src",encodeURIComponent(aG),0);}if(cT=="bg"){el.style.backgroundImage="url("+aG+")";}}}}if(zP){zP(eY);}});};var Te=function(NY,JY,zP){var r=/(<img\b[^>]*?\ssrc\s*?=\s*?)([\'\"])([^>]*?)(\2[^>]*?>)/gi;var m,s;var nI=[];var Ce=[];var dO=0;while((m=r.exec(NY))!=null){if(!Pg(m[3])){s=NY.substring(dO,m.index)+m[1]+m[2];nI.push(s);Ce.push(m[3]);dO=m.index+m[1].length+m[2].length+m[3].length;}}s=NY.substring(dO);nI.push(s);Nn(Ce,JY,function(eY){var IB="";for(var i=0;i<Ce.length;i++){IB+=nI[i];if(eY[i]["state"]=="ok"){var aG=eY[i]["url"];IB+=aG;}else{IB+=Ce[i];}}IB+=nI[nI.length-1];if(zP){zP({"html":IB,"result":eY});}});};var Nn=function(xi,JY,zP){var eY=[];if(xi.length==0){zP([]);return;}Sb(xi,JY,0,eY,function(){if(zP){zP(eY);}});};var Sb=function(xi,JY,dO,eY,zP){if(xi.length<=dO){return;}var Hd=dO+1;var kI="";if(xi.length>1){kI=(dO+1)+"";var Lu=(xi.length+"").length-kI.length;for(var i=0;i<Lu;i++){kI="0"+kI;}}var GW=function(){if(Hd==xi.length){zP();}else{Sb(xi,JY,Hd,eY,zP);}};Qz(xi[dO],JY,kI,function(Ey){eY[dO]=Ey;GW();});};var TK=function(GY,JY,zP,lL){Qz(GY,JY,"",zP,lL);};var Qz=function(GY,JY,kI,zP,lL){var aG;if(typeof GY=="string"){aG=GY;}else{aG=GY["url"];}var cs="";var n=aG.lastIndexOf(".");if(n>0){cs=aG.substring(n+1);}var wh=Mz("image");var Su=function(hX){var zg=new Image();var KI;zg.onload=function(){var Mg=document.createElement("canvas");Mg.width=zg.width;Mg.height=zg.height;var TI=Mg.getContext("2d");TI.drawImage(zg,0,0,zg.width,zg.height);var Ns=Mg.toDataURL();var mZ="";var a=Ns.split(",");if(a.length==2){mZ=a[1];}if(mZ==""){zP({"state":"err","errflag":"invalidimage"});return;}window.URL.revokeObjectURL(KI);var bU=R.SJ(mZ,"image/png","remote.png");Ni(bU,JY,kI,zP,lL);};zg.onerror=function(){zP({"state":"err","errflag":"invalidimage"});return;};KI=window.URL.createObjectURL(hX);zg.src=KI;};dU.eS({"act":"r2b4","url":aG,"type":"image","allowsize":wh},true,"c",function(EC){if(EC["state"]=="ok"){var rJ=EC["contenttype"];var xL=R.By(rJ);if(xL){var bU=R.SJ(EC["file"],rJ,"remote."+xL);Ni(bU,JY,kI,zP,lL);}else{if(rJ){var hX=R.Sh(EC["file"],rJ);}else{var hX=R.Qp(EC["file"],cs);}Su(hX);}}else{zP({"state":"err","errflag":EC["errflag"],"errdesc":""});}});};var TP=function(NY,JY,zP){var r=/(<img\s[^>]*?src\s*?=\s*?[\'\"])file:\/\/\/([^\'\">]*?)([\'\"][^>]*?>)/gi;var m;var Gv=[];while((m=r.exec(NY))!=null){var wx=m[2];if(Gv.indexOf(wx)== -1){Gv.push(wx);}}if(Gv.length==0){zP({"html":NY,"result":[]});return;}RD(Gv,JY,function(eY){var _Replace=function(s,ab,aF,vM){for(var i=0;i<Gv.length;i++){if(Gv[i]==aF){if(eY[i]["state"]=="ok"){return ab+eY[i]["url"]+vM}else{return s;}}}return s;};NY=NY.replace(r,_Replace);zP({"html":NY,"result":eY});});};var RD=function(tx,JY,zP){var eY=[];RZ(tx,0,JY,eY,function(){if(zP){zP(eY);}});};var RZ=function(tx,dO,JY,eY,zP){if(tx.length<=dO){return;}var Hd=dO+1;var kI="";if(tx.length>1){kI=(dO+1)+"";var Lu=(tx.length+"").length-kI.length;for(var i=0;i<Lu;i++){kI="0"+kI;}}var GW=function(){if(Hd==tx.length){zP();}else{RZ(tx,Hd,JY,eY,zP);}};if(typeof tx[dO]=="string"){QI(tx[dO],JY,kI,function(Ey){eY[dO]=Ey;GW();});}else{Ni(tx[dO],JY,kI,function(Ey){eY[dO]=Ey;GW();});}};var TL=function(es,JY,zP,lL){QI(es,JY,"",zP,lL);};var QI=function(es,JY,kI,zP,lL){var wL=JY["filetype"];var cs=R.Pe(es,wL);if(cs==""){zP({"state":"err","errflag":"ext"});return;}var wh=Mz(wL);if(wh==0){zP({"state":"err","errflag":"size"});return;}dU.eS({"act":"l2b4","file":es,"type":wL,"allowsize":wh},true,JY["cs"],function(EC){if(EC["state"]=="ok"){var ay=R.Py(es);var NF=R.GQ(EC["file"],cs,ay);QG(NF,JY,kI,function(Ey){zP(Ey);},lL);}else{zP({"state":"err","errflag":EC["errflag"],"errdesc":""});}});};var Mz=function(wL){var wh=0;switch(wL){case "image":wh=parseInt(config.AllowImageSize);break;case "media":wh=parseInt(config.AllowMediaSize);break;case "file":wh=parseInt(config.AllowFileSize);break;case "flash":wh=parseInt(config.AllowFlashSize);break;default:break;}return wh;};var TO=function(wL,lW){var wh=Mz(wL);if(lW>wh*1024){return false;}else{return true;}};var ST=function(bU,JY,zP,lL){Ni(bU,JY,"",zP,lL);};var Ni=function(bU,JY,kI,zP,lL){var wL=JY["filetype"];var cs=R.Pe(bU.name,wL);if(cs==""){zP({"state":"err","errflag":"ext"});return;}var Tw=TO(wL,bU.size);if(!Tw){zP({"state":"err","errflag":"size"});return;}QG(bU,JY,kI,zP,lL);};var QG=function(bU,JY,kI,zP,lL){var oz=0;var rj=1;if(config.MFUBlockSize){oz=parseInt(config.MFUBlockSize)*1024;rj=Math.ceil(bU.size/oz);}Sf(bU,JY,kI,oz,rj,1,"",zP,lL);};var Sf=function(bU,JY,kI,oz,rj,mk,Ig,zP,KX){var wL=JY["filetype"];var HE=EWEB.OS+"&action=mfu&type="+wL;if(JY["sy"]){HE+="&sy="+JY["sy"];}if(Ig){HE+="&blockfile="+Ig;}if(pW){if(Ig){var Tn=HE+"&blockflag=cancel";IG.CT("post",Tn,true,{});}pW=false;return;}var rs={};if(rj==1){rs["uploadfile"]=bU;}else{var hX;if(mk==rj){hX=bU.slice((mk-1)*oz,bU.size,bU.type);}else{hX=bU.slice((mk-1)*oz,mk*oz,bU.type);}var NF=R.HM(hX,bU.name);rs["uploadfile"]=NF;}rs["originalfilename"]=bU.name;var NU=HE;if(kI){NU+="&rnd="+kI;}if(mk==rj){NU+="&blockflag=end";}IG.CT("post",NU,true,rs,function(FH){var jE={};if(FH["state"]=="ok"){if(FH["isjson"]){if(FH["data"]["state"]=="ok"){if(rj==mk){jE["state"]="ok";jE["url"]=FH["data"]["url"];jE["originalname"]=R.Py(bU.name);addUploadFile(jE["originalname"],jE["url"]);if(FH["data"]["slt"]){jE["slt"]=FH["data"]["slt"];addUploadFile(jE["originalname"],jE["slt"]);}zP(jE);}else{Ig=FH["data"]["blockfile"];Sf(bU,JY,kI,oz,rj,mk+1,Ig,zP,KX);}}else{jE=FH["data"];zP(jE);}}else{jE["state"]="err";jE["errflag"]="ajaxisnotjson";jE["errdesc"]=""+FH["data"];zP(jE);}}else{jE["state"]="err";jE["errflag"]="ajaxstatus";jE["errdesc"]=""+FH["xhrstatus"];zP(jE);}},function(e){if(!KX){return;}var Tz=e.loaded+(mk-1)*oz;KX({"loaded":Tz,"total":bU.size});});};return{xO:function(NY,JY,zP){pW=false;JY["filetype"]="image";TP(NY,JY,zP);},SV:function(es,JY,zP,lL){pW=false;TL(es,JY,zP,lL);},oR:function(bU,JY,zP,lL){pW=false;ST(bU,JY,zP,lL);},RY:function(tx,JY,zP){pW=false;RD(tx,JY,zP);},Rj:function(OG,JY,zP){pW=false;JY["filetype"]="image";JY["cs"]="c";Tm(OG,JY,zP);},Qe:function(NY,JY,zP){pW=false;JY["filetype"]="image";JY["cs"]="c";Te(NY,JY,zP);},Sm:function(xi,JY,zP){pW=false;JY["filetype"]="image";JY["cs"]="c";Nn(xi,JY,zP);},wb:function(){pW=true;}}})();R.Pe=function(es,cT){var kn;switch(cT){case "image":kn=config.AllowImageExt;break;case "file":kn=config.AllowFileExt;break;case "flash":kn=config.AllowFlashExt;break;case "media":kn=config.AllowMediaExt;break;case "remote":kn=config.AllowRemoteExt;break;default:return "";}kn=kn.toLowerCase();var n1=es.length;var ab=es.toLowerCase();var a=kn.split("|");for(var i=0;i<a.length;i++){if(a[i]!=""){var n2=a[i].length;if(n1>n2+1){var aF="."+a[i];if(ab.substring(n1-n2-1)==aF){return a[i];}}}}return "";};R.Py=function(gx){gx=gx.replace(/\\/gi,"/");var n=gx.lastIndexOf("/");if(n>=0){return gx.substring(n+1);}else{return gx;}};var ld=(function(){var Ri;var Pk;return{Ta:function(Mn,kn){Ri=Mn;Pk=kn;},Dx:function(Mn){return lang["ErrUploadSizeLimit"]+":"+Mn+"KB";},FL:function(kn){return lang["ErrInvalidExt"]+":"+kn;},Fq:function(an){var ri="";switch(an){case "ext":ri=lang["ErrInvalidExt"]+":"+Pk;break;case "size":ri=lang["ErrUploadSizeLimit"]+":"+Ri+"KB";break;case "file":ri=lang["ErrInvalidFile"];break;case "style":ri=lang["ErrInvalidStyle"];break;case "space":ri=lang["ErrUploadSpaceLimit"]+":"+config.SpaceSize+"MB";break;case "ajaxstatus":ri=lang["ErrAjaxStatus"];break;case "wpscompat":ri=lang["ErrWpsCompat"];break;case "wordcreate":ri=lang["ErrWordCreate"];break;case "office2007plus":ri=lang["ErrOffice2007Plus"];break;case "invalidimage":ri=lang["ErrInvalidImage"];break;default:var yb="err_"+an;if(lang[yb]){ri=lang[yb];}else{ri=an;}break;}return ri;},CA:function(ND){if(["notinstall","p"].indexOf(ND)<0){alert(ld.Fq(ND));}}}})(); 