/*
*######################################
* eWebEditor V15.3 - Advanced online web based WYSIWYG HTML editor.
* Copyright (c) 2003-2023 eWebSoft.com
*
* For further information go to http://www.ewebeditor.net/
* This copyright notice MUST stay intact for use.
*######################################
*/

var cc=(function(){var Pq=new Object();var xm=document.location.search.substr(1).split('&');for(var i=0;i<xm.length;i++){var xF=xm[i].split('=');Pq[xF[0]]=xF[1];}return Pq;})();var EWIN=parent.EWIN;var EWEB=EWIN.EWEB;var ec=EWIN.ec;var R=EWIN.R;var F=EWIN.F;var aA=EWIN.aA;var lang=EWIN.lang;var config=EWIN.config;var C=EWIN.C;var dU=EWIN.dU;var eG=EWIN.eG;var ld=EWIN.ld;var IG=EWIN.IG;var dP=parent.dP();if(dP){dP=dP.contentWindow.yu;}R.lE(window);function lC(ay,bv){return(cc[ay])?cc[ay]:bv;};function Nq(s){s=s.replace(/&/gi,"&amp#");s=s.replace(/:/gi,"&maohao#");s=s.replace(/;/gi,"&fenhao#");return s;};function fk(bM){qS=0;qw=bM.length;if(fk.arguments.length==2){gR=fk.arguments[1].toLowerCase();}else{gR="all";}for(var i=0;i<bM.length;i++){xY=bM.substring(qS,qS+1);xH=bM.substring(qw,qw-1);if((gR=="all"||gR=="left")&&xY==" "){qS++;}if((gR=="all"||gR=="right")&&xH==" "){qw--;}}bM=bM.slice(qS,qw);return bM;};function bX(wz,zj){alert(zj);wz.focus();wz.select();return false;};function oV(color){var temp=color;if(temp=="")return true;if(temp.length!=7)return false;return(temp.search(/\#[a-fA-F0-9]{6}/)!= -1);};function AN(bM){return(bM.search(/[^0-9]+/)== -1);};function Ck(bM){return(AN(bM)&&parseInt(bM)>0);};function eR(e){if(!e){e=window.event;}if((e.keyCode>=48&&e.keyCode<=57)||(e.keyCode>=96&&e.keyCode<=105)||(e.keyCode>=35&&e.keyCode<=40)||e.keyCode==46||e.keyCode==8){return true;}return R.aw(e);};function hu(tj){var aG="selcolor.htm?returnfieldflag="+tj;ec.OpenDialog(aG);};function vo(){ec.OpenDialog("backimage.htm?action=other");};function nf(type,tj){ec.OpenDialog('browse.htm?returnfieldflag='+tj+'&type='+type);};function aC(xd,bv){for(var i=0;i<xd.length;i++){if(xd.options[i].value==bv){xd.selectedIndex=i;return true;}}return false;};function HK(QM){var K=document.getElementsByName(QM);for(var i=0;i<K.length;i++){var el=K[i];if(el.checked){return el.value;}}return "";};function fe(bM){bM=fk(bM);if(bM!=""){var ho=parseFloat(bM);if(isNaN(ho)){bM="";}else{bM=ho;}}return bM;};function iV(es,kn){var a=kn.toUpperCase().split("|");for(var i=0;i<a.length;i++){if(es.length>(a[i].length+1)){var s=es.substring(es.length-a[i].length-1);s=s.toUpperCase();if(s==("."+a[i])){return true;}}}return false;};function Nh(aG){if(!config.FSPath){return aG;}if(aG.indexOf("://")>=0){return aG;}var MU=config.FSPath;if(aG.substring(0,1)=="/"){var Od=MU.replace(/^([^\/]+?:\/\/[^\/]+?)\/.*?$/gi,"$1");return Od+aG;}else{var qc=MU;var n=qc.length;if(qc.substr(n-1,1)=="/"){qc=qc.substr(0,n-1);}while(aG.substr(0,3)=="../"){aG=aG.substr(3);qc=qc.substring(0,qc.lastIndexOf("/"));}return qc+"/"+aG;}};function tX(aG){if(aG.substring(0,1)=="/"){return aG;}if(aG.indexOf("://")>=0){return aG;}var qc=EWEB.cd;while(aG.substr(0,3)=="../"){aG=aG.substr(3);qc=qc.substring(0,qc.lastIndexOf("/"));}return qc+"/"+aG;};function qf(aG){if(config.BaseHref==""){return aG;}if(aG.substring(0,1)=="/"){return aG;}if(aG.indexOf("://")>=0){return aG;}var hN=config.BaseHref;hN=hN.substring(0,hN.length-1);while(aG.substring(0,3)=="../"){aG=aG.substr(3);hN=hN.substring(0,hN.lastIndexOf("/"));}return hN+"/"+aG};function AI(aG){var oT=EWEB.cd+"/plugin/";while(true){var n1=aG.indexOf("/");var n2=oT.indexOf("/");if(n1>=0&&n1==n2){if(aG.substring(0,n1+1)==oT.substring(0,n2+1)){aG=aG.substr(n1+1);oT=oT.substr(n2+1);}else{break;}}else{break;}}var s=oT.replace(/[^\/]+/gi,'');var n=s.length;for(var i=0;i<n;i++){aG="../"+aG;}return aG;};function gh(url,Nd){if(Nd){if(config.ResMovePath){url=config.ResMovePath+url;return url;}}switch(config.BaseUrl){case "0":url=tX(url);return Af(url);break;case "1":return tX(url);break;case "2":case "3":return aA.hW+tX(url);break;}};function Af(url){var baseHref=config.BaseHref;var b=true;while(b){var n1=url.indexOf("/");var n2=baseHref.indexOf("/");if((n1>=0)&&(n2>=0)){var u1=url.substring(0,n1+1);var u2=baseHref.substring(0,n2+1);if(u1==u2){url=url.substr(n1+1);baseHref=baseHref.substr(n2+1);}else{b=false;}}else{b=false;}}if(baseHref!=""){var a=baseHref.split("/");for(var i=1;i<a.length;i++){url="../"+url;}}return url;};function Ao(el){if(!el["imageinitliazed"]){el["oncontextmenu"]=new Function("event.returnValue=false");el["onmouseout"]=new Function("wn(this)");el["onmousedown"]=new Function("wA(this)");el["unselectable"]="on";el["imageinitliazed"]=true;}el.className="Ao";};function wn(el){el.className="wn";};function wA(el){el.className="wA";};function lN(cT){var qd,Oq,kn;Oq="";switch(cT){case "image":qd=config.AllowImageSize;kn=config.AllowImageExt;break;case "flash":qd=config.AllowFlashSize;kn=config.AllowFlashExt;break;case "media":qd=config.AllowMediaSize;kn=config.AllowMediaExt;break;case "file":qd=config.AllowFileSize;kn=config.AllowFileExt;break;case "pdf":qd=config.AllowFileSize;kn="pdf";break;default:return "";}Oq="."+kn.replace(/\|/gi,",.");if(Oq){Oq='accept="'+Oq+'"';}var Ad=parseFloat(qd)*1024;var html="<input type=file name='uploadfile' id='uploadfile' size=28 style='width:100%' "+Oq+"  onchange=\"try{eT();} catch(e){}\">";return html;};function md(an,cs,Ay){var ii="";switch(an){case "ext":ii=lang["ErrInvalidExt"]+":"+cs;break;case "size":ii=lang["ErrUploadSizeLimit"]+":"+Ay+"KB";break;case "file":ii=lang["ErrInvalidFile"];break;case "style":ii=lang["ErrInvalidStyle"];break;case "space":ii=lang["ErrUploadSpaceLimit"]+":"+config.SpaceSize+"MB";break;case "ajaxstatus":ii=lang["ErrAjaxStatus"];break;default:ii=an;break;}return ii;};function pR(ay){var yW="";var gr=ay+"=";if(document.cookie.length>0){ro=document.cookie.indexOf(gr);if(ro!= -1){ro+=gr.length;var eQ=document.cookie.indexOf(";",ro);if(eQ== -1){eQ=document.cookie.length;}yW=unescape(document.cookie.substring(ro,eQ));}}return yW;};function qz(ay,bv){var pS="";pS=new Date((new Date()).getTime()+24*365*3600000);pS=";expires="+pS.toGMTString();document.cookie=ay+"="+escape(bv)+pS;};function bq(kG,dg,iG){if(iG==null||iG.length==0){kG.removeAttribute(dg,0);}else{kG.setAttribute(dg,iG,0);}};function nP(kG,bL,fO){bq(kG,"_ewebeditor_pa_"+bL,encodeURIComponent(fO));};function dE(kG,dg){var fu=kG.attributes[dg];if(fu==null|| !fu.specified){return "";}var bv=kG.getAttribute(dg,2);if(bv==null){bv=fu.nodeValue;}return(bv==null?"":bv);};function eZ(el,dg){dg=dg.replace(/\-(\w)/g,function(Cz,p1){return p1.toUpperCase();});var bv=el.style[dg];if(bv&&(!F.as)&&dg.indexOf("Color")>=0){bv=zr(bv);}if(!bv){switch(dg){case "backgroundColor":dg="bgColor";break;case "textAlign":dg="align";break;case "verticalAlign":dg="valign";break;default:}bv=dE(el,dg);}return bv;};function lZ(bv){var n=parseInt(bv);if(isNaN(n)){return '';}var l=bv.length;if(l>2){if(bv.toLowerCase().substr(l-2)=="px"){bv=n+"";}}return bv;};function vH(el,bL){var yV="_ewebeditor_pa_"+bL;var wU=el.attributes[yV];if(wU==null|| !wU.specified){return dE(el,bL);}else{return decodeURIComponent(el.getAttribute(yV,2));}};function xV(el){return dE(el,"_ewebeditor_fake_tag");};function wi(el){return decodeURIComponent(dE(el,"_ewebeditor_fake_value"));};function zG(el,NY){bq(el,'_ewebeditor_fake_value',encodeURIComponent(NY));};function ty(N){if(N==null)return "00";N=parseInt(N);if(N==0||isNaN(N))return "00";N=Math.max(0,N);N=Math.min(N,255);N=Math.round(N);return "0123456789ABCDEF".charAt((N-N%16)/16)+"0123456789ABCDEF".charAt(N%16);};function zr(bM){if(bM.substring(0,3)=='rgb'){var by=bM.split(",");var r=by[0].replace('rgb(','').trim();var g=by[1].trim();var b=by[2].replace(')','').trim();var hex=[ty(r),ty(g),ty(b)];return "#"+hex.join('');}else{return bM;}};var aj={Init:function(NY){this.pL=new Object();this.Html=NY;var re=new RegExp("<(video|audio)(?=[\\s>])","gi");if(re.test(NY)){NY=NY.replace(/<object[\s\S]*?<\/object>/gi,"");}re=new RegExp("<object(?=[\\s>])","gi");if(re.test(NY)){this.oA="object";re=/<param\s+name\s*?=\s*?([\'\"]?)(\w+)\1[\s]+value\s*?=\s*?(\w+|\'[^\'>]+\'|\"[^\">]+\")[^>]*?>/gi;while((by=re.exec(NY))!=null){var fz=RegExp.$3;if(fz.substring(0,1)=='\''||fz.substring(0,1)=='"'){fz=fz.substring(1,fz.length-1);}this.pL[RegExp.$2.toLowerCase()]=fz;}}else{this.oA="common";re=/\s(\w+)\s*?=\s*?(\w+|\'[^\'>]+\'|\"[^\">]+\")/gi;while((by=re.exec(NY))!=null){var fz=RegExp.$2;if(fz.substring(0,1)=='\''||fz.substring(0,1)=='"'){fz=fz.substring(1,fz.length-1);}this.pL[RegExp.$1.toLowerCase()]=fz;}}},kM:function(bA){return(this.pL[bA])?this.pL[bA]:"";},uT:function(){return this.Html;},jk:function(bA,bv){var NY=this.Html;function gm(m,m1){if(bv==''){return '';}else{return '<param name="'+bA+'" value="'+bv+'">';}};function gC(m){return m+'<param name="'+bA+'" value="'+bv+'">';};if(this.oA=='object'){var re=new RegExp('<param(?=\\s)[^>]*?\\sname\\s*?=\\s*?(\w+|\'[^\'>]+\'|\"[^\">]+\")[^>]*?>','gi');if(re.test(NY)){NY=NY.replace(re,gm);}else{if(bv!=''){NY=NY.replace(/<object[^>]*?>/,gC);}}NY=this.wD(NY,'embed',bA,bv);}else{NY=this.wD(NY,'\\w+',bA,bv);}this.Html=NY;},wD:function(NY,aH,bA,bv){function gm(m,m1,m2,m3){if(bv==''){return m1+m3;}else{return m1+' '+bA+'="'+bv+'"'+m3;}};function gC(m){return m.substring(0,m.length-1)+' '+bA+'="'+bv+'">';};var re=new RegExp('(<'+aH+'(?=[\\s>])[^>]*?)\\s'+bA+'\\s*?=\\s*?(\w+|\'[^\'>]+\'|\"[^\">]+\")([^>]*>)','gi');if(re.test(NY)){NY=NY.replace(re,gm);}else{if(bv!=''){re=new RegExp('<'+aH+'(?=[\\s>])[^>]*>','gi');NY=NY.replace(re,gC);}}return NY;}};var ck={Click:function(dO,iq){if($("tab_nav_"+dO).className=="tab_on"){return;}var pV,bZ,pE;for(var i=1;i<=iq;i++){pV="tab_nav_"+i;bZ=$(pV).getAttribute("_content_id",2);if($(pV).className=="tab_on"){if(!ck.iy){ck.iy=new Array();}if(!ck.iy[i]){ck.iy[i]={Width:$("tabDialogSize").offsetWidth,Height:$("tabDialogSize").offsetHeight};}if(!ck.jp){ck.jp=new Array();}if(!ck.jp[i]){ck.jp[i]={Width:$(bZ).offsetWidth,Height:$(bZ).offsetHeight};}$(pV).className="tab_off";$(bZ).style.display="none";}}i=dO;pV="tab_nav_"+i;bZ=$(pV).getAttribute("_content_id",2);pE=bZ;$(pV).className="tab_on";$(bZ).style.display="";if(!ck.iy[i]){ck.iy[i]={Width:$("tabDialogSize").offsetWidth,Height:$("tabDialogSize").offsetHeight};}if(!ck.jp[i]){ck.jp[i]={Width:$(bZ).offsetWidth,Height:$(bZ).offsetHeight};}try{jS(dO,iq,pE);}catch(e){}},lQ:function(qF){var NY='<table class=tab_layout1 border=0 cellpadding=0 cellspacing=0 width="100%"><tr><td>'+'<table class=tab_layout2 border=0 cellpadding=0 cellspacing=0><tr>'+'<td class=tab_begin></td>';for(var i=1;i<=qF.length;i++){var rg='tab_on';if(i>1){NY+='<td class=tab_sep></td>';rg='tab_off';}NY+='<td><table id="tab_nav_'+i+'" class="'+rg+'" _content_id="'+qF[i-1][1]+'" border=0 cellpadding=0 cellspacing=0><tr>'+'<td class=tab_left></td>'+'<td class=tab_center onclick="ck.Click('+i+','+qF.length+')">'+qF[i-1][0]+'</td>'+'<td class=tab_right></td>'+'</tr></table></td>';}NY+='</tr></table></td></tr></table>';document.write(NY);}};var iU={Load:function(cT,zI,eh,ff,rh){if(this.AB){return;}this.yz=cT;this.nU=zI;this.SD=rh||'1';this.PW=((this.SD=='0')?false:true);this.nU.style.width=eh;this.nU.style.height=ff;this.fS=[];this.we();},we:function(){var Qf='';switch(this.yz){case 'image':this.Dq=config.AllowImageSize;this.wf=config.AllowImageExt;this.DQ=lang['DlgMFUFYDImage'];if(window.FE){Qf='<td><input type=checkbox id=d_mfu_syflag value="1"><label for=d_mfu_syflag>'+lang['DlgImgSYFlag']+'</label></td><td width=10></td>';}break;case 'media':this.Dq=config.AllowMediaSize;this.wf=config.AllowMediaExt;this.DQ=lang['DlgMFUFYDMedia'];break;case 'flash':this.Dq=config.AllowFlashSize;this.wf=config.AllowFlashExt;this.DQ=lang['DlgMFUFYDFlash'];break;case 'file':this.Dq=config.AllowFileSize;this.wf=config.AllowFileExt;this.DQ=lang['DlgMFUFYDFile'];break;}var NY='<table id="mfu_maintable" border=0 cellpadding=0 cellspacing=5 width="100%" height="100%">'+'<tr>'+'<td id="mfu_msgtd">'+lang['DlgComMFUMsgAllow'].replace('<ext>',this.wf).replace('<size>',wR(this.Dq))+'</td>'+'</tr>'+'<tr>'+'<td>'+'<table width="100%" cellspacing=0 cellpadding=0><tr>'+'<td><input id="mfu_btn_browse" type=button class="dlgBtnCommon dlgBtn" value="'+lang['DlgMFUBrowse']+'" onclick="iU.Browse()">&nbsp;'+'<input id="mfu_btn_del" type=button class="dlgBtnCommon dlgBtn" value="'+lang['DlgMFUDel']+'" onclick="iU.Del()">&nbsp;'+'<input id="mfu_btn_empty" type=button class="dlgBtnCommon dlgBtn" value="'+lang['DlgMFUEmpty']+'" onclick="iU.Empty()"></td>'+'<td align=right><input id="mfu_btn_up" type=button class="dlgBtnCommon dlgBtn" value="'+lang['DlgMFUUp']+'" onclick="iU.Up()">&nbsp;'+'<input id="mfu_btn_down" type=button class="dlgBtnCommon dlgBtn" value="'+lang['DlgMFUDown']+'" onclick="iU.Down()"></td>'+'</tr></table>'+'</td>'+'</tr>'+'<tr>'+'<td id="mfu_list_ptd" height="100%">'+'<div id="mfu_list_div" style="width:100%;height:100%;overflow:auto">'+'<table id="mfu_list_table" class="mfu_list_table" width="100%" cellspacing=1 cellpadding=2 border=0>'+'<tr class="mfu_list_headtr">'+'<td width="8%">'+lang["DlgMFUSeq"]+'</td>'+'<td width="50%">'+lang["DlgMFUFileName"]+'</td>'+'<td width="14%">'+lang["DlgMFUFileSize"]+'</td>'+'<td width="14%">'+lang["DlgMFUProgress"]+'</td>'+'<td width="14%">'+lang["DlgMFUStatus"]+'</td>'+'</tr>'+'</table>'+'</div>'+'</td>'+'</tr>'+'<tr>'+'<td>'+'<table width="100%" cellspacing=0 cellpadding=0><tr>'+'<td id="mfu_tpb_td">'+'<table border=0 cellpadding=0 cellspacing=0>'+'<tr>'+Qf+'<td>'+this.Fg(0,0)+'</td>'+'<td width="10px"></td>'+'<td width="100px">'+this.Dh('t','0%')+'</td>'+'</tr>'+'</table>'+'</td>'+'<td align=right><input id="mfu_btn_upload" type=button class="dlgBtnCommon dlgBtn" value="'+lang['DlgMFUUpload']+'" onclick="iU.Upload()">&nbsp;'+'<input id="mfu_btn_cancel" type=button class="dlgBtnCommon dlgBtn" value="'+lang['DlgMFUCancel']+'" onclick="iU.Cancel()"></td>'+'</tr></table>'+'</td>'+'</tr>'+'</table>';this.nU.innerHTML=NY;$('mfu_list_div').style.height=$('mfu_list_div').offsetHeight+'px';this.jW=$("mfu_list_table");this.lH=0;this.BV();this.AB=true;R.az(this.jW,'click',this.FC);R.az(this.jW,'mouseover',this.GB);R.az(this.jW,'mouseout',this.Gf);},Browse:function(){var bU=document.createElement("input");bU.type="file";bU.name="d_file";if(this.PW){bU.multiple=true;}bU.accept="."+this.wf.replace(/\|/gi,",.");bU.addEventListener('change',function(e){var dZ=e.srcElement||e.target;iU.Gl(dZ);});bU.click();},Empty:function(){var iq=this.jW.rows.length-1;for(var i=iq;i>0;i--){this.jW.deleteRow(-1);}this.lH=0;this.BV();this.fS=[];},Del:function(){var dO=this.lH;if(dO<=0){return;}var EK=this.jW;EK.deleteRow(dO);var iq=EK.rows.length-1;if(iq<=0){this.lH=0;}else if(iq<dO){this.lH=0;this.xn(iq);}else{this.lH=0;this.xn(dO);for(var i=dO;i<=iq;i++){EK.rows[i].cells[0].innerHTML=i+"";}}iU.BV();this.fS.splice(dO-1,1);},Up:function(){var dO=this.lH;var iq=this.jW.rows.length-1;if(dO<=1||dO>iq){return;}var PH=this.fS[dO-1];this.fS[dO-1]=this.fS[dO-2];this.fS[dO-2]=PH;iU.DW(dO,this.fS[dO-1]);iU.DW(dO-1,this.fS[dO-2]);iU.xn(dO-1);iU.BV();},Down:function(){var dO=this.lH;var iq=this.jW.rows.length-1;if(dO<=0||dO>=iq){return;}var PH=this.fS[dO-1];this.fS[dO-1]=this.fS[dO];this.fS[dO]=PH;iU.DW(dO,this.fS[dO-1]);iU.DW(dO+1,this.fS[dO]);iU.xn(dO+1);iU.BV();},Upload:function(){if(this.Fs){return;}if(this.jW.rows.length<2){return;}this.Dw=0;this.Eg(true);this.Fs=true;this.Rn="";if(window.FE){if($("d_mfu_syflag").checked){this.Rn="1";}}this.Av=0;this.Mi=0;this.LO=this.fS.length;this.LK=0;for(var i=0;i<this.fS.length;i++){this.LK+=this.fS[i]["file"].size;}this.FR(this.Av,this.LO,0);this.MT();},MT:function(){this.Dw=this.Dw+1;if(this.Dw>this.fS.length){window.setTimeout(iU.RC,200);return;}var wQ=this.fS[this.Dw-1];if(wQ["state"]=="ok"){iU.Av=iU.Av+1;var AE=iU.Mh();var DC=Math.ceil(AE*100/iU.LK);iU.FR(iU.Av,iU.LO,DC);this.MT();}else{this.Rx(this.Dw,"uploading");eG.oR(wQ["file"],{"filetype":this.yz,"sy":this.Rn},this.Rk,this.QY);}},RC:function(){iU.Fs=false;if(iU.Mi>0){if(confirm(lang["DlgMFUErrRetry"].replace("{count}",iU.Mi+""))){iU.Upload();}else{iU.Eg(false);}return;}try{MFUReturn(iU.fS);}catch(e){}},Rk:function(OI){iU.fS[iU.Dw-1]["uploadresult"]=OI;var Eq,Ff;if(OI["state"]=="ok"){iU.Av=iU.Av+1;Ff="100%";Eq="ok";}else{iU.Mi=iU.Mi+1;Ff="0%";Eq="errorupload";}iU.Dm(iU.Dw,Ff);iU.Rx(iU.Dw,Eq);var AE=iU.Mh();var DC=Math.ceil(AE*100/iU.LK);iU.FR(iU.Av,iU.LO,DC);iU.MT();},QY:function(e){if(iU.fS[iU.Dw-1]["state"]!="uploading"){return;}var zv=Math.ceil(e.loaded*100/e.total)+"%";iU.Dm(iU.Dw,zv);var AE=iU.Mh()+e.loaded;var DC=Math.ceil(AE*100/iU.LK);iU.FR(iU.Av,iU.LO,DC);},Mh:function(){var AE=0;for(var i=0;i<iU.Dw;i++){var wQ=iU.fS[i];if(wQ["uploadresult"]){if(wQ["uploadresult"]["state"]=="ok"){AE+=wQ["file"].size;}}}return AE;},Cancel:function(){if(this.Fs){eG.wb();parent.Cancel();}else{parent.Cancel();}},FC:function(ev){if(!ev){ev=window.event;}var dZ=ev.srcElement||ev.target;var pa=R.tz(dZ,"TR");if(!iU.DS(pa)){return;}if(pa.rowIndex>0){iU.xn(pa.rowIndex);iU.BV();}},GB:function(ev){iU.Fl(ev,true);},Gf:function(ev){iU.Fl(ev,false);},Fl:function(ev,Fp){if(!ev){ev=window.event;}var dZ=ev.srcElement||ev.target;var pa=R.tz(dZ,"TR");if(!iU.DS(pa)){return;}if(pa.rowIndex>0&&pa.rowIndex!=iU.lH){var Da=Fp?"mfu_list_tr_hover":"";iU.jW.rows[pa.rowIndex].className=Da;}},DS:function(pa){if(pa){var EK=R.tz(pa,"TABLE");if(EK==this.jW){return true;}}return false;},xn:function(dO){if(this.lH==dO||dO<1||this.jW.rows.length<=dO){return;}if(this.lH>0){this.jW.rows[this.lH].className="";}this.jW.rows[dO].className="mfu_list_tr_selected";this.lH=dO;},Dh:function(bA,zv){var KM='';var KZ='';var Lv='';if(isNaN(parseInt(bA))){KM='id="mfu_pb_c_'+bA+'"';KZ='id="mfu_pb_p_'+bA+'"';Lv='id="mfu_pb_t_'+bA+'"';}var NY='<div '+KM+' class="mfu_pb_c">'+'<div '+KZ+' class="mfu_pb_p" style="width:'+zv+'"></div>'+'<div '+Lv+' class="mfu_pb_t">'+zv+'</div>'+'</div>';return NY;},Dm:function(bA,zv){var Js;var KA;if(isNaN(parseInt(bA))){Js=$('mfu_pb_p_'+bA);KA=$('mfu_pb_t_'+bA);}else{iU.fS[parseInt(bA)-1]["pb"]=zv;var Lt=this.jW.rows[parseInt(bA)].cells[3];var IT=Lt.getElementsByTagName("div");for(var i=0;i<IT.length;i++){if(IT[i].className=='mfu_pb_p'){Js=IT[i];}if(IT[i].className=='mfu_pb_t'){KA=IT[i];}}}Js.style.width=zv;KA.innerHTML=zv;},Gl:function(LY){if(LY.files.length==0){return;}var Eo=0;for(var i=0;i<LY.files.length;i++){var bU=LY.files[i];if(!iV(bU.name,this.wf)){Eo++;continue;}if(bU.size>(parseInt(this.Dq)*1024)){Eo++;continue;}var n=this.fS.length;if(!this.PW){if(n>=1){this.Empty();n=0;}}var yf=wR(bU.size/1024);var Ff="0%";var Eq="wait";this.fS[n]={"file":bU,"input":LY,"index":i,"kb":yf,"pb":Ff,"state":Eq};var nK=this.jW.insertRow(-1);var be=nK.insertCell(-1);be.innerHTML=(n+1)+"";be=nK.insertCell(-1);be.style.textAlign="left";be.innerHTML=this.Fo(bU.name);be=nK.insertCell(-1);be.innerHTML=yf;be=nK.insertCell(-1);be.innerHTML=this.Dh(n+1,Ff);be=nK.insertCell(-1);be.innerHTML=this.Dz(Eq);}if(Eo>0){alert(lang["DlgMFUMsgFilter"].replace("{count}",Eo));}if(this.lH<=0){this.xn(1);}this.BV();},DW:function(dO,wQ){var nK=this.jW.rows[dO];nK.cells[1].innerHTML=this.Fo(wQ["file"].name);nK.cells[2].innerHTML=wQ["kb"];nK.cells[3].innerHTML=this.Dh(1,wQ["pb"]);nK.cells[4].innerHTML=this.Dz(wQ["state"]);},Fo:function(ay){var aI=ay;aI=aI.replace(/&/gi,"&amp;");aI=aI.replace(/\"/gi,"&quot;");aI=aI.replace(/</gi,"&lt;");aI=aI.replace(/>/gi,"&gt;");return aI;},Dz:function(an){var ca;switch(an){case 'ok':ca=lang["DlgMFUStateOk"];break;case 'uploading':ca=lang["DlgMFUStateUploading"];break;case 'errorupload':ca=lang["DlgMFUStateErrUpload"];break;case 'cancel':ca=lang["DlgMFUStateCancel"];break;case 'wait':ca=lang["DlgMFUStateWait"];break;}return ca;},Rx:function(dO,EW){iU.fS[dO-1]["state"]=EW;iU.jW.rows[dO].cells[4].innerHTML=iU.Dz(EW);},BV:function(){var iq=this.jW.rows.length-1;var dO=this.lH;var b=(iq<=0)?true:false;this.od("mfu_btn_upload",b);this.od("mfu_btn_del",b);this.od("mfu_btn_empty",b);b=(dO<=1)?true:false;this.od("mfu_btn_up",b);b=(dO>=iq)?true:false;this.od("mfu_btn_down",b);},Eg:function(b){this.od("mfu_btn_browse",b);this.od("mfu_btn_del",b);this.od("mfu_btn_empty",b);this.od("mfu_btn_up",b);this.od("mfu_btn_down",b);this.od("mfu_btn_upload",b);},od:function(ay,b){var Da=b?"dlgBtnCommon dlgBtn dlgBtnDisabled":"dlgBtnCommon dlgBtn";$(ay).disabled=b;$(ay).className=Da;},Fg:function(dO,iq,DC){var NY=lang['DlgMFUTotalProgress'].replace('{index}','<span id="mfu_tpb_index">'+dO+'</span>').replace('{count}','<span id="mfu_tpb_count">'+iq+'</span>');return NY;},FR:function(dO,iq,DC){$('mfu_tpb_index').innerHTML=dO+'';$('mfu_tpb_count').innerHTML=iq+'';this.Dm('t',DC+'%');}};function zJ(ay,b){var Da=b?"dlgBtnCommon dlgBtn dlgBtnDisabled":"dlgBtnCommon dlgBtn";$(ay).disabled=b;$(ay).className=Da;};function wR(yf){var n=parseFloat(yf);var s="";if(n>=1048576){n=n/1048576;s=Math.round(n*100)/100+"GB";}else if(n>=1024){n=n/1024;s=Math.round(n*100)/100+"MB";}else{s=Math.round(n*100)/100+"KB";}return s;};function DB(bv){if(!bv){return "";}if(bv.search(/[^0-9]+/)!= -1){return bv;}else{return bv+"px";}};var bB=(function(){var Np=false;var Nv="";var Hv="";return{OutHtml:function(sd){Nv=sd;document.write('<div id=div_doing_mask style="opacity:0.5;position:absolute;left:-10000px;top:-10000px;z-index:1"></div><div id=div_doing style="position:absolute;width:200px;height:30px;left:-10000px;top:-10000px;line-height:30px;border:1px solid #000000;background-color:#3A6EA5;z-index:2;">'+'<marquee align="middle" behavior="alternate" scrollamount="5" id="marq_msg"><span style="color:#ffffff">'+sd+'</span></marquee>'+'</div>');},MZ:function(sd,MD){var aQ="#ffffff";switch(MD){case "1":aQ="#ffff00";break;case "2":aQ="#ff0000";break;}$("marq_msg").innerHTML="<span style='color:"+aQ+"'>"+sd+"</span>";},Me:function(bo){if(bo){bB.MZ(lang["MsgCancel"],"1");}else{bB.MZ(Nv);}},NT:function(){return Np;},Show:function(Ou){Np=true;if(Ou){Hv=Ou;zJ(Hv,true);}else{Hv="";}var w=$("tabDialogSize").offsetWidth+"px";var h=parseInt($("tabDialogSize").offsetHeight-30)+"px";$("div_doing_mask").style.width=w;$("div_doing_mask").style.height=h;$("div_doing_mask").style.left="0px";$("div_doing_mask").style.top="0px";var FQ=parseInt(($("tabDialogSize").offsetWidth-200)/2)+"px";var mq=parseInt(($("tabDialogSize").offsetHeight-20-30)/2)+"px";$("div_doing").style.left=FQ;$("div_doing").style.top=mq;},Hide:function(ND){Np=false;$("div_doing_mask").style.left="-10000px";$("div_doing_mask").style.top="-10000px";$("div_doing").style.left="-10000px";$("div_doing").style.top="-10000px";if(Hv){zJ(Hv,false);}if(ND){if(["notinstall","p"].indexOf(ND)<0){alert(ld.Fq(ND));}}}};})();function yt(s){return s.replace(/(^[ \t\n\r]*)|([ \t\n\r]*$)/g,'');};function uy(OY,Pr,kK){var aI=OY.replace(Pr,kK);if(aI!=OY){return uy(aI,Pr,kK);}else{return aI;}};function PP(NY,Bc){var aI=NY;var xc=[];var zA=[];var bA="";var bv="";var n=0;var b=false;Bc=Bc.replace(/<\/?style>/gi,"");Bc=Bc.replace(/\"/gi,"'");var r=/([a-zA-Z\.\#][^\{\}]*?)\{([^\}]+?)\}/gi;var m;while((m=r.exec(Bc))!=null){bA=m[1];bv=m[2];bv=bv.replace(/[\r\n\t]+/gi,"");bv=yt(bv);if(bv.substring(bv.length-1)==";"){bv=bv.substring(0,bv.length-1);}var OJ=bA.split(",");for(var i=0;i<OJ.length;i++){bA=OJ[i];bA=bA.replace(/\t+/gi," ");bA=bA.replace(/[\r\n]+/gi,"");bA=(yt(bA));bA=bA.toLowerCase();if(bA){n=xc.indexOf(bA);if(n>=0){zA[n]=zA[n]+";"+bv;}else{xc.push(bA);zA.push(bv);}}}}if(xc.length<=0){return NY;}aI=aI.replace(/(<[^>]*?)(\sclass\s*=\s*)(\'?)([a-zA-Z0-9\_\-]+)\3(?=[\s>])([^>]*?>)/gi,"$1 class=\"$4\"$5");aI=uy(aI,/(<[^>]*?\sstyle\s*=\s*\'[^>\']*?)\"([^>\']*?\'[^>]*?>)/gi,"$1EWEBEDITORQUOT$2");aI=aI.replace(/(<[^>]*?)(\sstyle\s*=\s*)\'([^>\']*?)\'([^>]*?>)/gi,"$1 style=\"$3\"$4");aI=uy(aI,/(<[^>]*?)EWEBEDITORQUOT([^>]*?>)/gi,"$1'$2");var mL="";var JM="";var IW="";var _Replace=function(m){return QR(m,mL,IW);};for(var i=xc.length-1;i>=0;i--){bA=xc[i];n=bA.indexOf(".");if(n>0){mL=bA.substring(0,n);JM=bA.substring(n+1);IW=zA[i];r=new RegExp("<"+mL+"\\b[^>]*?\\sclass\\s*?=\\s*?[\'\"]?"+JM+"\\b[^>]*?>","gi");aI=aI.replace(r,_Replace);xc.splice(i,1);zA.splice(i,1);}}mL="";for(var i=xc.length-1;i>=0;i--){bA=xc[i];n=bA.indexOf(".");if(n==0){JM=bA.substring(1);IW=zA[i];aI=aI.replace(new RegExp("<\\w+?\\b([^>]*\\sclass\\s*?=\\s*?[\'\"]?"+JM+"\\b[^>]*?>)","gi"),_Replace);xc.splice(i,1);zA.splice(i,1);}}for(var i=xc.length-1;i>=0;i--){bA=xc[i];b=/[^a-zA-Z0-9]+/gi.test(bA);if(!b){mL=bA;IW=zA[i];aI=aI.replace(new RegExp("<"+mL+"\\b[^>]*?>","gi"),_Replace);xc.splice(i,1);zA.splice(i,1);}}aI=aI.replace(/(<[^>]*?)\sclass=\"[^\">]*\"([^>]*>)/gi,"$1$2");return aI;};function dq(NY,aH,BP,zd){var Ih=BP.toLowerCase();var Pf=(Ih.substring(Ih.length-1)=="*");var gm=function(m0,m1,m2,m3,m4){var r1=/(\sstyle\s*=\s*)([\'\"])([^>]*?)(\2)/gi;if(r1.test(m3)){var gC=function(m20,m21,m22,m23,m24){var a1=m23.split(";");var v="";for(var i=0;i<a1.length;i++){var a2=a1[i].split(":");if(a2.length==2){var bA=a2[0].replace(/(^\s*|\s*$)/g,"");var NG=bA.toLowerCase();var MJ=false;if(Pf){var n=Ih.length-1;if(NG.length>=n){if(NG.substring(0,n)==Ih.substring(0,n)){MJ=true;}}}else{if(NG==Ih){MJ=true;}}if(!MJ){v+=a2[0]+":"+a2[1]+";";}}}if(zd&&(!Pf)){v+=BP+":"+zd;}if(v==""){return "";}else{return m21+m22+v+m24;}};return m1+m2+m3.replace(r1,gC)+m4;}else{if(zd){return m1+m2+m3+" style=\""+BP+":"+zd+"\""+m4;}else{return m0;}}};return NY.replace(new RegExp("(<)("+aH+")\\b([^>]*?)(>)","gi"),gm);};function QR(NY,aH,RO){var aI=NY;var Qj=RO.split(";");for(var i=0;i<Qj.length;i++){var OZ=Qj[i].split(":");if(OZ.length==2){var k=yt(OZ[0]);var v=yt(OZ[1]);if((k!="")&&(v!="")){aI=Sl(aI,aH,k,v);}}}return aI;};function Sl(NY,aH,BP,zd){if((BP=="")||(zd=="")){return NY;}var gm=function(m0,m1,m2,m3,m4){var r1=/(style\s*=\s*)([\'\"])([^>]*?)(\2)/gi;if(r1.test(m3)){var gC=function(m20,m21,m22,m23,m24){var Sg=false;var a1=m23.split(";");var v=m23;for(var i=0;i<a1.length;i++){var a2=a1[i].split(":");if(a2.length==2){var bA=a2[0].replace(/(^\s*|\s*$)/g,"");if(bA.toLowerCase()==BP.toLowerCase()){Sg=true;break;}}}if(!Sg){v=BP+":"+zd+";"+m23;}return m21+m22+v+m24;};return m1+m2+m3.replace(r1,gC)+m4;}else{return m1+m2+m3+" style=\""+BP+":"+zd+"\""+m4;}};if(aH==""){aH="\\w+?";}return NY.replace(new RegExp("(<)("+aH+")\\b([^>]*?)(>)","gi"),gm);};function AT(NY,aH,FO,iG){var gm=function(m0,m1,m2,m3,m4){var r1=new RegExp("\\s"+FO+"\\s*?=\\s*?(\'[^\'>]*?\'|\"[^\">]*?\"|[^\'\"\\s>]*)","gi");var aI=m0.replace(r1,"");if(iG){aI=aI.substring(0,aI.length-1)+" "+FO+"=\""+iG+"\">";}return aI;};return NY.replace(new RegExp("(<)("+aH+")\\b([^>]*?)(>)","gi"),gm);};function hz(NY,aH,FO){var gm=function(m0,m1,m2,m3,m4){if(m3==""){return m0;}var lD=function(){var s="sn"+R.Nl();if(m3.indexOf(s)>=0){return lD();}else{return s;}};FO=FO.toLowerCase();var Pm="";var NJ={};var PQ=0;var gC=function(m20,m21){if(Pm==""){Pm=lD();}PQ++;var dc="["+Pm+PQ+"]";NJ[dc]=m20;return dc;};m3=m3.replace(/(\'[^\']*?\'|\"[^\"]*?\")/gi,gC);m3=m3.replace(/\s*=\s*/gi,"=");m3=m3.replace(/\s+/gi," ");m3=m3.replace(/^\s*([\s\S]*?)\s*$/gi,"$1");var KH=m3.split(" ");var aI="";for(var i=0;i<KH.length;i++){if(KH[i]!=""){var kv=KH[i].split("=");if(kv[0].toLowerCase()!=FO){aI+=" "+KH[i];}}}var BB=function(m30){if(NJ[m30]){return NJ[m30];}else{return m30;}};aI=aI.replace(/\[sn[0-9]+\]/gi,BB);return m1+m2+aI+m4;};return NY.replace(new RegExp("(<)("+aH+")\\b([^>]*?)(>)","gi"),gm);};function St(NY,aH){var r=new RegExp("<("+aH+")\\b[^>]*?>","gi");return NY.replace(r,"<$1>");};function OA(NY,aH,SM){var _Replace=function(m0,m1,m2){var s="";var r1=/\s([\w-]+?)\s*?=\s*?(\"[^\">]*?\"|\'[^\'>]*?\'|[^\s>\'\"]+)/gi;while((m=r1.exec(m2))!=null){if(SM.indexOf(m[1].toLowerCase())>=0){s+=m[0];}}return "<"+m1+s+">";};var r=new RegExp("<("+aH+")\\b([^>]*?)>","gi");var aI=NY.replace(r,_Replace);return aI;};function Qa(NY){var aI=NY;var zE=function(m2){var v="";var lm=["\u6977\u4f53","\u4eff\u5b8b"];var a=m2.split(",");for(var i=0;i<a.length;i++){var s=a[i].trim();s=s.replace(/(\'+|_gb2312)/gi,"");var n=lm.indexOf(s);if(n>=0){s=lm[n]+","+lm[n]+"_GB2312"}else{s=a[i];}if(v){v=v+",";}v=v+s;}return v;};var gm=function(m,m1,m2,m3){var v=zE(m2);return m1+v+m3;};var gC=function(m,m1,m2,m3){var v1=m2.substring(0,1);var v2=m2.substring(1,m2.length-1);var v=v1+zE(v2)+v1;return m1+v+m3;};aI=aI.replace(/(<\w+[^>]*?\sstyle\s*?=[^>]*?font-family\s*?:)([^\";>]*)([^>]*?>)/gi,gm);aI=aI.replace(/(<font\b[^>]*?\sface\s*?=\s*?)(\"[^\">]*?\"|\'[^\'>]*?\')([^>]*?>)/gi,gC);return aI;};function Qk(NY){var aI=NY;var _Replace=function(m,m1,m2,m3,m4,m5){var v=m4.replace(/\s+/," ");v=yt(v);var s="";var a=v.split(" ");for(var i=0;i<a.length;i++){if(a[i]!=""){if(s!=""){s+=" ";}var OQ=/^[0-9\.]+pt$/gi;if(OQ.test(a[i])){if(parseFloat(a[i])<=1){s+="1px";}else{s+=a[i];}}else{s+=a[i];}}}return m1+m2+m3+s+m5;};var gm=function(m,m1,m2,m3,m4){var a1=m3.split(";");var s="";for(var i=0;i<a1.length;i++){if(s!=""){s+=";";}var a2=a1[i].split(":");if(a2.length==2){var k=yt(a2[0]);if("|border|border-left|border-top|border-right|border-bottom|".indexOf("|"+k.toLowerCase()+"|")>=0){var v=a2[1];v=v.replace(/\s+/," ");v=yt(v);if(v!=""){var hJ=v.split(" ");var v2="";for(var j=0;j<hJ.length;j++){if(v2!=""){v2+=" ";}var OQ=/^[0-9\.]+pt$/gi;if(OQ.test(hJ[j])){if(parseFloat(hJ[j])<=1){v2+="1px";}else{v2+=hJ[j];}}else{v2+=hJ[j];}}s+=a2[0]+":"+v2;}else{s+=a1[i];}}else{s+=a1[i];}}else{s+=a1[i];}}return m1+m2+s+m4;};aI=NY.replace(/(<td\b[^>]*?\sstyle\s*?=\s*?)([\'\"])([^>\2]*?\b(?:border|border-left|border-top|border-right|border-bottom)\s*?:[^>\2]*?)(\2[^>]*?>)/gi,gm);return aI;};function Qh(NY,aH){var _Replace=function(m0,m1,m2){var v="";var r1=/\swidth\s*?=/gi;if(!r1.test(m2)){var r2=/\sstyle\s*?=[\'\"][^>]*?\bwidth\s*?:/gi;if(!r2.test(m2)){v=dq(m0,m1,"width","fit-content");}}if(v==""){return m0;}else{return v;}};var r=new RegExp("<("+aH+")\\b([^>]*?)>","gi");NY=NY.replace(r,_Replace);return NY;} 