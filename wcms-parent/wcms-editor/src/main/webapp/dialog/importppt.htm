<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"> <html> <head> <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7"> <meta http-equiv="Content-Type" content="text/html; charset=gb2312"> <script type="text/javascript" src="dialog.js?v=15.3"> </script> <script type="text/javascript"> document.write("<link href='../skin/"+config.Skin+"/dialog.css?v="+EWEB.V+"' type='text/css' rel='stylesheet'>");var bm=lang["DlgPPT"];document.write("<title>"+bm+"</title>");var wr=false;wr=(parseInt(config.WIAPI)<10)?true:false;var FE=((config.SYWZFlag=="2"||config.SYTPFlag=="2")?true:false);var gd="tab_pdf";function ok(){var bU;if($("d_file").files.length<=0){alert(ld.Fq("file"));return;}bU=$("d_file").files[0];if(!iV(bU.name,"ppt|pptx|dps")){alert(ld.FL("ppt|pptx|dps"));return;}var bu="";var cw="0";if(wr){cw=HK("d_api");}else{cw=(parseInt(config.WAPI)-10)+"";}bu+="api:"+cw+";";if(gd=="tab_pdf"){bu+="docprop:"+($("d_pdf_docprop").checked?"1":"0")+";";bu+="hide:"+($("d_pdf_hide").checked?"1":"0")+";";var HD=Nq($("d_pdf_title").value);bu+="title:"+HD+";";}if(gd=="tab_image"){var AX=$("d_img_bl").value;if(/[\:\;]+/gi.test(AX)){alert(lang["DlgWordErrBL"]);return;}bu+="bl:"+AX;}bB.Show("btn_ok");if(gd=="tab_pdf"){dU.yR(bU,{"act":"ppt2pdf","opt":bu},true,"s",function(cC){if(cC["state"]=="err"){bB.Hide(cC["errflag"]);return;}var vn=cC["filekey"];var Gh=cC["filesize"];if(Gh>(parseInt(config.AllowFileSize)*1024)){bB.Hide();alert(ld.Dx(config.AllowFileSize));return;}dU.PY(vn,"s",function(zl){if(zl["state"]=="err"){bB.Hide();alert(ld.Dx(config.AllowFileSize));return;}dU.eS({"act":"cache","acttype":"ppt2pdf","actkey":cC["actkey"]},false,"s");var bU=zl["file"];eG.oR(bU,{"filetype":"file","sy":""},function(iw){if(iw["state"]=="err"){bB.Hide(iw["errflag"]);return;}var aG=iw["url"];var NY='<iframe src="'+aG+'" style="display:block;margin:5px auto;border:1px solid #eeeeee;';var w=$("d_pdf_width").value;if(w){NY+='width:'+w+';';}var h=$("d_pdf_height").value;if(h){NY+='height:'+h+';';}NY+='"></iframe>';pk(NY);});});});}else if(gd=="tab_image"){dU.yR(bU,{"act":"ppt2image","opt":bu},true,"s",function(cC){if(cC["state"]=="err"){bB.Hide(cC["errflag"]);return;}var yQ=cC["html"];var fX=tF();eG.xO(yQ,{"cs":"s","sy":fX},function(eC){dU.eS({"act":"cache","acttype":"ppt2image","actkey":cC["actkey"]},false,"s");var NY=eC["html"];NY=NY.replace(/<br>/gi,"");var jZ='display:block;margin:15px auto;';if($("d_img_borderef").checked){jZ+='border-width:1px 2px 2px 1px;border-color:#00000;border-style:solid;';}if($("d_img_maxwidth").checked){jZ+='max-width:100%;';}jZ=' style="'+jZ+'"';NY=NY.replace(/(<img)(\s[^>]*?>)/gi,'$1'+jZ+'$2');if($('d_img_efflag').checked){var ll='overflow:auto;background-color:#A0A0A3;border:1px solid #D4D0C8;text-align:center;';var ys=$('d_img_efwidth').value;if(ys!=''){ll+='width:'+ys+';';}var vO=$('d_img_efheight').value;if(vO!=''){ll+='height:'+vO+';';}ll+=' style="'+ll+'"';NY='<div class="ewebeditor_doc"'+ll+'>'+NY+'</div>';}pk(NY);});});}};function tF(){if(FE){if(gd!="tab_pdf"){if($("d_syflag").checked){return "1";}}}return "";};function pk(NY){if($("d_pos").checked){EWIN.setHTML(NY,true);}else{EWIN.insertHTML(NY);}parent.bV({flag:"AfterImportPPT",action:""});};function pf(bd,gK){pz(bd,gK,"INPUT");pz(bd,gK,"SPAN");};function pz(bd,gK,aH){var K=bd.getElementsByTagName(aH);for(var j=0;j<K.length;j++){K[j].disabled=gK;}};function aq(){lang.ag(document);if(wr){$("d_api"+config.WIAPI).checked=true;}pK();parent.ar(bm);};function DO(){$("d_file").click();};function Hz(){if($("d_file").files.length>0){$("d_filename").value=$("d_file").files[0].name;}else{$("d_filename").value="";}};function Lo(){if(bB.NT()){dU.Im("s");eG.wb();}parent.Cancel(true);};function jS(dO,iq,bZ){gd=bZ;if(FE){var yZ=$("g_syflag");if(bZ=="tab_pdf"){yZ.style.display="none";}else{yZ.style.display="";}}if(ck.iy[dO]){parent.pM(ck.iy[dO].Width,ck.iy[dO].Height);}else{parent.pM();}};function Gc(){var xk=$("d_img_bldrop").options[$("d_img_bldrop").selectedIndex].value;$("d_img_bl").value=xk;};function Gb(){var bv=fk($("d_img_bl").value);var LB=$("d_img_bldrop");var qP=LB.options.length;for(var i=0;i<qP;i++){if(LB.options[i].value==bv){LB.selectedIndex=i;break;}}};function pK(){var b=$("d_img_efflag").checked;pf($("group_imgef"),!b);} </script> </head> <body onload="aq()"> <table border=0 cellpadding=0 cellspacing=5 id=tabDialogSize><tr><td> <table border=0 cellpadding=0 cellspacing=0 align=center> <tr> <td> <fieldset> <table border=0 cellpadding=2 cellspacing=0 width='100%'><tr><td> <table border=0 cellpadding=0 cellspacing=5 width='100%'> <tr> <td noWrap><span lang=DlgPPTFile></span>:</td> <td noWrap width='100%'><input type=file id='d_file' style='opacity:0;position:absolute;top:-1000px;' accept=".ppt,.pptx,.dps" onchange="Hz()"><input type=text readonly='true' id='d_filename' size=30 style='width:270px;color:#808080' lang=DlgPPTFileValue> <input type=button class='dlgBtnCommon dlgBtn' lang=DlgBtnBrowse onclick='DO()'></td> </tr> <script type="text/javascript"> if(wr){document.write("		<tr>");document.write("			<td noWrap><span lang=DlgPPTAPI></span>:</td>");document.write("			<td noWrap><input type=radio name=d_api id=d_api0 value='0'><label for=d_api0>"+lang["DlgPPTAPI0"]+"</label>&nbsp;<input type=radio name=d_api id=d_api1 value='1'><label for=d_api1>"+lang["DlgPPTAPI1"]+"</label>&nbsp;<input type=radio name=d_api id=d_api2 value='2'><label for=d_api2>"+lang["DlgPPTAPI2"]+"</label></td>");document.write("		</tr>");} </script> </table> </td></tr></table> </fieldset> </td> </tr> <tr><td height=5></td></tr> <script type="text/javascript"> document.write("<tr><td>");ck.lQ([[lang["DlgPPTTabPdf"],"tab_pdf"],[lang["DlgPPTTabImage"],"tab_image"]]);document.write("</td></tr>"); </script> <tr> <td> <fieldset> <table border=0 cellpadding=5 cellspacing=0 width="100%"> <tr><td valign=top id="tab_contain"> <style> #tab_contain td{white-space:nowrap} </style> <div id="tab_pdf"> <div><span style="color:#228b22" lang=DlgWordPdfDesc></span></div> <table border=0 cellpadding=0 cellspacing=5> <tr> <td><input type=checkbox id="d_pdf_docprop"><label for="d_pdf_docprop"><span lang=DlgWordPdfDocProp></span></label></td> <td></td> <td><input type=checkbox id="d_pdf_hide"><label for="d_pdf_hide"><span lang=DlgPPTPdfHide></span></label></td> </tr> <tr> <td noWrap><span lang=DlgWordPdfTitle></span>: <input type=text id="d_pdf_title" size=20 style="width:110px"></td> <td></td> <td noWrap></td> </tr> <tr> <td noWrap width="49%"><span lang=DlgWordPdfW></span>: <input style="width:110px;" id="d_pdf_width" size=10 value="100%"></td> <td width="2%">&nbsp;</td> <td noWrap width="49%"><span lang=DlgWordPdfH></span>: <input style="width:110px;" id="d_pdf_height" size=10 value="900px""></td> </tr> </table> </div> <div id="tab_image" style="display:none"> <div id="div_img_import"> <div><span style='color:#228b22' lang=DlgWordImgAlt></span></div> <table border=0 cellpadding=0 cellspacing=6> <tr> <td width="49%"><input type=checkbox id=d_img_maxwidth checked><label for=d_img_maxwidth><span lang=DlgWordImageMaxWidth></span></label></td> <td width="2%"></td> <td width="49%"><span lang=DlgPDFBL></span>:<div style="position:relative;display:inline-block;"> <span style="margin-left:62px;width:18px;overflow:hidden;"> <select id=d_img_bldrop style="width:80px;margin-left:-62px;height:20px;" onchange="Gc()"> <option value="50%">50%</option> <option value="60%">60%</option> <option value="70%">70%</option> <option value="80%">80%</option> <option value="90%">90%</option> <option value="100%" selected>100%</option> <option value="125%">125%</option> <option value="150%">150%</option> <option value="200%">200%</option> <option value="300%">300%</option> </select> </span> <input style="width:62px;position:absolute;left:0px;" id=d_img_bl size=10 value="100%" onchange="Gb()"> </div></td> </tr> <tr> <td colspan=3><input type=checkbox id=d_img_borderef value='1' checked><label for=d_img_borderef><span lang=DlgWordImgBorderEf></span></label>&nbsp;<input type=checkbox id=d_img_efflag value='1' onclick='pK()'><label for=d_img_efflag><span lang=DlgWordImgEfFlag></span>:</label> <span id=group_imgef><span lang=DlgWordImgEfWidth></span><input type=text size=5 id=d_img_efwidth style='width:50px' value='100%'>&nbsp;<span lang=DlgWordImgEfHeight></span><input type=text size=5 id=d_img_efheight style='width:50px' value=''></span></td> </tr> </table> </div> </div> </td></tr> </table> </fieldset> </td> </tr> <tr><td height=5></td></tr> <tr> <td> <table border=0 cellpadding=0 cellspacing=0 width="100%"> <tr> <td noWrap><input type=checkbox id=d_pos checked><label for=d_pos><span lang=DlgComInsertReplace></span></label> <script type="text/javascript"> if(FE){document.write("<span id=g_syflag style='display:none'>&nbsp;<input type=checkbox id=d_syflag value='1'><label for=d_syflag><span lang=DlgImgSYFlag></span></label></span>");} </script> </td> <td noWrap align=right><input type=submit class="dlgBtnCommon dlgBtn" value="" id="btn_ok" onclick="ok()" lang=DlgBtnOK>&nbsp;<input type=button class="dlgBtnCommon dlgBtn" value="" id="btn_cancel" onclick="Lo()" lang=DlgBtnCancel></td> </tr> </table> </td> </tr> </table> </td></tr></table> <script type="text/javascript"> bB.OutHtml(lang["DlgPPTImporting"]); </script> </body> </html> 